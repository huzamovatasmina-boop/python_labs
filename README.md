# python_labs
# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ1
# –í–≤–æ–¥/–≤—ã–≤–æ–¥ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Python

# –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã:
–û—Å–≤–æ–∏—Ç—å –±–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö, —Ä–∞–±–æ—Ç—É —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–≤–æ–¥–∞ –≤ Python.

# –ó–∞–¥–∞–Ω–∏–µ 1: –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –≤–æ–∑—Ä–∞—Å—Ç

**–§–∞–π–ª:** `src/lab01/ex.01.py`  

**–¶–µ–ª—å:** –†–∞–±–æ—Ç–∞ —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏ –∏ —Ü–µ–ª—ã–º–∏ —á–∏—Å–ª–∞–º–∏, –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è —Å—Ç—Ä–æ–∫.

**–í–≤–æ–¥:**
- –ò–º—è (—Å—Ç—Ä–æ–∫–∞)
- –í–æ–∑—Ä–∞—Å—Ç (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ)

**–í—ã–≤–æ–¥:**
![alt text](images/lab01/ex.01.png)

**–ü—Ä–∏–º–µ—Ä:**
–ò–º—è: –ê–ª–∏—Å–∞
–í–æ–∑—Ä–∞—Å—Ç: 19
–ü—Ä–∏–≤–µ—Ç, –ê–ª–∏—Å–∞! –ß–µ—Ä–µ–∑ –≥–æ–¥ —Ç–µ–±–µ –±—É–¥–µ—Ç 20.# –ó–∞–¥–∞–Ω–∏–µ 2: –°—É–º–º–∞ –∏ —Å—Ä–µ–¥–Ω–µ–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ

# –ó–∞–¥–∞–Ω–∏–µ 2: –°—É–º–º–∞ –∏ —Å—Ä–µ–¥–Ω–µ–µ

**–§–∞–π–ª:** `src/lab01/ex.02.py`  

**–¶–µ–ª—å:** –†–∞–±–æ—Ç–∞ —Å –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–≤–æ–¥–∞.

**–í–≤–æ–¥:**
- –î–≤–∞ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —á–∏—Å–ª–∞ (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ç–æ—á–∫–∞ –∏ –∑–∞–ø—è—Ç–∞—è)

**–í—ã–≤–æ–¥:**
![alt text](images/lab01/ex.02.png)

**–ü—Ä–∏–º–µ—Ä:**
a: 3,5
b: 4.25
sum=7.75; avg=3.88#   –ó–∞–¥–∞–Ω–∏–µ 3: –†–∞—Å—á–µ—Ç —á–µ–∫–∞ —Å–æ —Å–∫–∏–¥–∫–æ–π –∏ –ù–î–°

# –ó–∞–¥–∞–Ω–∏–µ 3 ‚Äî –ß–µ–∫: —Å–∫–∏–¥–∫–∞ –∏ –ù–î–°

**–§–∞–π–ª:** `src/lab01/ex.03.py`  

**–¶–µ–ª—å:** –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–æ—Ä–º—É–ª, —Å–ª–æ–∂–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–≤–æ–¥–∞.

**–§–æ—Ä–º—É–ª—ã:**
- `base = price * (1 - discount/100)`
- `vat_amount = base * (vat/100)`
- `total = base + vat_amount`

**–í–≤–æ–¥:**
- –¶–µ–Ω–∞ (–≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ)
- –°–∫–∏–¥–∫–∞ (%) (–≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ)
- –ù–î–° (%) (–≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ)

**–í—ã–≤–æ–¥:**
![alt text](images/lab01/ex.03.png)

**–ü—Ä–∏–º–µ—Ä:**
price (‚ÇΩ): 1000
discount (%): 10
vat (%): 20#   –ó–∞–¥–∞–Ω–∏–µ 4: –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –º–∏–Ω—É—Ç –≤ —á–∞—Å—ã –∏ –º–∏–Ω—É—Ç—ã

# –ó–∞–¥–∞–Ω–∏–µ 4 ‚Äî –ú–∏–Ω—É—Ç—ã ‚Üí –ß–ß:–ú–ú

**–§–∞–π–ª:** `src/lab01/ex.04.py`  

**–¶–µ–ª—å:** –†–∞–±–æ—Ç–∞ —Å —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–º –¥–µ–ª–µ–Ω–∏–µ–º, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏.

**–í–≤–æ–¥:**
- –ú–∏–Ω—É—Ç—ã (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ)

**–í—ã–≤–æ–¥:**
![alt text](images/lab01/ex.04.png)

**–ü—Ä–∏–º–µ—Ä:**
–ú–∏–Ω—É—Ç—ã: 135
2:15

#   –ó–∞–¥–∞–Ω–∏–µ 5: –ò–Ω–∏—Ü–∏–∞–ª—ã –∏ –¥–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫–∏


**–§–∞–π–ª:** `src/lab01/ex.05.py`
 
**–¶–µ–ª—å:** –†–∞–±–æ—Ç–∞ —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏, –º–µ—Ç–æ–¥–∞–º–∏ —Å—Ç—Ä–æ–∫, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.

**–í–≤–æ–¥:**

 –§–ò–û –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–æ–π (–º–æ–≥—É—Ç –±—ã—Ç—å –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã)

**–í—ã–≤–æ–¥:**

![alt text](images/lab01/ex.05.png)


**–ü—Ä–∏–º–µ—Ä:**

–§–ò–û: –•—É–∂–∞–º–æ–≤–∞ –¢–∞—Å–º–∏–Ω–∞ –ú—É–∑–∞—Ñ—Ñ–∞—Ä–æ–≤–Ω–∞
–ò–Ω–∏—Ü–∏–∞–ª—ã: –•–¢–ú.
–î–ª–∏–Ω–∞ (—Å–∏–º–≤–æ–ª–æ–≤): 29

## –ó–∞–¥–∞–Ω–∏—è —Å–æ –∑–≤–µ–∑–¥–æ—á–∫–æ–π

### –ó–∞–¥–∞–Ω–∏–µ 6*

**–§–∞–π–ª:** `src/lab01/ex.06.py`

**–¶–µ–ª—å:** –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö, —Ä–∞–±–æ—Ç–∞ —Å –±—É–ª–µ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏, –ø–æ–¥—Å—á–µ—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤.

**–í–≤–æ–¥:**
–°–Ω–∞—á–∞–ª–∞ —á–∏—Å–ª–æ N, –∑–∞—Ç–µ–º N —Å—Ç—Ä–æ–∫, –∫–∞–∂–¥–∞—è —Ñ–æ—Ä–º–∞—Ç–∞:
–§–∞–º–∏–ª–∏—è –ò–º—è –í–æ–∑—Ä–∞—Å—Ç –§–æ—Ä–º–∞—Ç_—É—á–∞—Å—Ç–∏—è

**–í—ã–≤–æ–¥:**
–î–≤–∞ —á–∏—Å–ª–∞ —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –æ—á–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∑–∞–æ—á–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞.

**–ü—Ä–∏–º–µ—Ä:**

**–í–≤–æ–¥:**
3

–ú–∞–∫—Å–∏–º–æ–≤ –ú–∞–∫—Å–∏–º 18 True

–ì–µ–Ω–Ω–∞–¥—å–µ–≤ –ì–µ–Ω–Ω–∞–¥–∏–π 17 False

–ê–ª–µ–∫—Å–µ–µ–≤ –ê–ª–µ–∫—Å–µ–π 17 True

**–í—ã–≤–æ–¥:**

![alt text](<images/lab01/ex.06.png>)

**–°—Ç—É–¥–µ–Ω—Ç:** –•—É–∂–∞–º–æ–≤–∞ –¢–∞—Å–º–∏–Ω–∞ –ú—É–∑–∞—Ñ—Ñ–∞—Ä–æ–≤–Ω–∞ 
**–ì—Ä—É–ø–ø–∞:** [–ë–ò–í–¢-25-4]  
**–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å:** []


# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ2
# –ö–æ–ª–ª–µ–∫—Ü–∏–∏ –∏ –º–∞—Ç—Ä–∏—Ü—ã (list/tuple/set/dict)
# –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã:
–û—Å–≤–æ–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ —Å–ø–∏—Å–∫–∞–º–∏, –∫–æ—Ä—Ç–µ–∂–∞–º–∏, –º–Ω–æ–∂–µ—Å—Ç–≤–∞–º–∏ –∏ —Å–ª–æ–≤–∞—Ä—è–º–∏. –ù–∞—É—á–∏—Ç—å—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å —Å 2D-—Å–ø–∏—Å–∫–∞–º–∏ (–º–∞—Ç—Ä–∏—Ü–∞–º–∏) ‚Äî —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, —Å—É–º–º—ã –ø–æ —Å—Ç—Ä–æ–∫–∞–º/—Å—Ç–æ–ª–±—Ü–∞–º. –ê–∫–∫—É—Ä–∞—Ç–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–µ–π (–Ω–∞ –ø—Ä–∏–º–µ—Ä–µ —Å—Ç—É–¥–µ–Ω—Ç–∞).

# –ó–∞–¥–∞–Ω–∏–µ 1: –û–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ —Å–ø–∏—Å–∫–∞–º–∏
**–§–∞–π–ª:** `src/lab02/ex.01.py`

``` python
def min_max(nums: list[float | int]) -> tuple[float | int, float | int]:
    """
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ç–µ–∂ (–º–∏–Ω–∏–º—É–º, –º–∞–∫—Å–∏–º—É–º) –∏–∑ —Å–ø–∏—Å–∫–∞ —á–∏—Å–µ–ª.

    Args:
        nums: –°–ø–∏—Å–æ–∫ —á–∏—Å–µ–ª (int –∏–ª–∏ float)

    Returns:
        –ö–æ—Ä—Ç–µ–∂ (min, max)

    Raises:
        ValueError: –ï—Å–ª–∏ —Å–ø–∏—Å–æ–∫ –ø—É—Å—Ç
    """
    if not nums:
        raise ValueError("–°–ø–∏—Å–æ–∫ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º")

    return min(nums), max(nums)


def unique_sorted(nums: list[float | int]) -> list[float | int]:
    """
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.

    Args:
        nums: –°–ø–∏—Å–æ–∫ —á–∏—Å–µ–ª (int –∏–ª–∏ float)

    Returns:
        –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
    """
    return sorted(set(nums))


def flatten(mat: list[list | tuple]) -> list:
    """
    "–†–∞—Å–ø–ª—é—â–∏–≤–∞–µ—Ç" —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤/–∫–æ—Ä—Ç–µ–∂–µ–π –≤ –æ–¥–∏–Ω —Å–ø–∏—Å–æ–∫.

    Args:
        mat: –°–ø–∏—Å–æ–∫, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Å–ø–∏—Å–∫–∏ –∏–ª–∏ –∫–æ—Ä—Ç–µ–∂–∏

    Returns:
        –û–¥–∏–Ω —Å–ø–∏—Å–æ–∫ —Å–æ –≤—Å–µ–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏

    Raises:
        TypeError: –ï—Å–ª–∏ –≤—Å—Ç—Ä–µ—Ç–∏–ª—Å—è —ç–ª–µ–º–µ–Ω—Ç, –Ω–µ —è–≤–ª—è—é—â–∏–π—Å—è —Å–ø–∏—Å–∫–æ–º –∏–ª–∏ –∫–æ—Ä—Ç–µ–∂–µ–º

    extend:
    —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã —Å–ø–∏—Å–∫–∞ –∏–ª–∏ –∫–æ—Ä—Ç–µ–∂–∞, 
    –¥–æ–±–∞–≤–ª—è—è –≤ —Å–ø–∏—Å–æ–∫ result –æ—Ç–¥–µ–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∫–∞–∂–¥–æ–≥–æ —Å–ø–∏—Å–∫–∞
    –º–æ–∂–Ω–æ –±—ã–ª–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å sublist –≤–æ—Ç —Ç–∞–∫:
    result = [item for sublist in mat for item in sublist], 
    –≥–¥–µ —á–∞—Å—Ç—å   for sublist in mat  –ø–µ—Ä–µ–±–∏—Ä–∞–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏/–∫–æ—Ä—Ç–µ–∂–∏, 
    –∞    for item in sublist   –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç

    isinstance:
    –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ item - —Å–ø–∏—Å–ª–∫ –∏–ª–∏ –∫–æ—Ä—Ç–µ–∂, –µ—Å–ª–∏ –Ω–µ—Ç, –≤—ã–≤–æ–¥–∏—Ç TypError

    """
    result = []
    for item in mat:
        if not isinstance(item, (list, tuple)):
            raise TypeError("–í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–ø–∏—Å–∫–∞–º–∏ –∏–ª–∏ –∫–æ—Ä—Ç–µ–∂–∞–º–∏")
        result.extend(item) 
    return result

# –¢–µ—Å—Ç 1: –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π —Å–ª—É—á–∞–π
print("min_max([3, -1, 5, 5, 0]):", min_max([3, -1, 5, 5, 0]))

# –¢–µ—Å—Ç 2:ValueError
try:
    print("min_max([]):", min_max([]))
except ValueError as e:
    print(f"min_max([]): ValueError - {e}")

# –¢–µ—Å—Ç 3: —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
print("unique_sorted([3, 1, 2, 1, 3]):", unique_sorted([3, 1, 2, 1, 3]))

# –¢–µ—Å—Ç 4: –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø–ª—é—â–∏–≤–∞–Ω–∏–µ
print("flatten([[1, 2], [3, 4]]):", flatten([[1, 2], [3, 4]]))

# –¢–µ—Å—Ç 5: TypeError
try:
    print("flatten([1, [3, 4]]):", flatten([1, [3, 4]]))
except TypeError as e:
    print(f"flatten([1, [3, 4]]): TypeError - {e}")
```

**–í—ã–≤–æ–¥**

![alt text](<images/lab02/ex.01.png>)


# –ó–∞–¥–∞–Ω–∏–µ 2: –û–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ —Å–ø–∏—Å–∫–∞–º–∏

**–¶–µ–ª—å:** –ü–æ–º–µ–Ω—è—Ç—å —Å—Ç—Ä–æ–∫–∏ –∏ —Å—Ç–æ–ª–±—Ü—ã –º–µ—Å—Ç–∞–º–∏. –ü—É—Å—Ç–∞—è –º–∞—Ç—Ä–∏—Ü–∞ [] ‚Üí [].
–ï—Å–ª–∏ –º–∞—Ç—Ä–∏—Ü–∞ ¬´—Ä–≤–∞–Ω–∞—è¬ª (—Å—Ç—Ä–æ–∫–∏ —Ä–∞–∑–Ω–æ–π –¥–ª–∏–Ω—ã) ‚Äî ValueError.

**–§–∞–π–ª:** `src/lab02/–∑–∞–¥–∞–Ω–∏–µ B.2.py`

``` python
def _validate_rectangular(mat: list[list[float | int]]) -> None:
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –º–∞—Ç—Ä–∏—Ü–∞ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∞—è (–≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –¥–ª–∏–Ω—ã).

    Args:
        mat: –ú–∞—Ç—Ä–∏—Ü–∞ (—Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤)

    Raises:
        ValueError: –ï—Å–ª–∏ –º–∞—Ç—Ä–∏—Ü–∞ —Ä–≤–∞–Ω–∞—è (—Å—Ç—Ä–æ–∫–∏ —Ä–∞–∑–Ω–æ–π –¥–ª–∏–Ω—ã)
    """
    if not mat:
        return []

    first_len = len(mat[0])
    for i, row in enumerate(mat):
        if len(row) != first_len:
            raise ValueError(f"–ú–∞—Ç—Ä–∏—Ü–∞ —Ä–≤–∞–Ω–∞—è: —Å—Ç—Ä–æ–∫–∞ {i} –∏–º–µ–µ—Ç –¥–ª–∏–Ω—É {len(row)}, –æ–∂–∏–¥–∞–ª–∞—Å—å {first_len}")


def transpose(mat: list[list[float | int]]) -> list[list[float | int]]:
    """
    –¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä—É–µ—Ç –º–∞—Ç—Ä–∏—Ü—É (–º–µ–Ω—è–µ—Ç —Å—Ç—Ä–æ–∫–∏ –∏ —Å—Ç–æ–ª–±—Ü—ã –º–µ—Å—Ç–∞–º–∏).

    Args:
        mat: –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞

    Returns:
        –¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞

    Raises:
        ValueError: –ï—Å–ª–∏ –º–∞—Ç—Ä–∏—Ü–∞ —Ä–≤–∞–Ω–∞—è
    """
    _validate_rectangular(mat)

    if not mat:
        return []

    return [[mat[i][j] for i in range(len(mat))] for j in range(len(mat[0]))]


def row_sums(mat: list[list[float | int]]) -> list[float]:
    """
    –í—ã—á–∏—Å–ª—è–µ—Ç —Å—É–º–º—ã –ø–æ —Å—Ç—Ä–æ–∫–∞–º –º–∞—Ç—Ä–∏—Ü—ã.

    Args:
        mat: –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞

    Returns:
        –°–ø–∏—Å–æ–∫ —Å—É–º–º –ø–æ —Å—Ç—Ä–æ–∫–∞–º

    Raises:
        ValueError: –ï—Å–ª–∏ –º–∞—Ç—Ä–∏—Ü–∞ —Ä–≤–∞–Ω–∞—è
    """
    _validate_rectangular(mat)

    return [sum(row) for row in mat]


def col_sums(mat: list[list[float | int]]) -> list[float]:
    """
    –í—ã—á–∏—Å–ª—è–µ—Ç —Å—É–º–º—ã –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º –º–∞—Ç—Ä–∏—Ü—ã.

    Args:
        mat: –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞

    Returns:
        –°–ø–∏—Å–æ–∫ —Å—É–º–º –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º

    Raises:
        ValueError: –ï—Å–ª–∏ –º–∞—Ç—Ä–∏—Ü–∞ —Ä–≤–∞–Ω–∞—è
    """
    _validate_rectangular(mat)

    if not mat:
        return []

    return [sum(mat[i][j] for i in range(len(mat))) for j in range(len(mat[0]))]

print("\n=== Matrix Tests ===")

# –¢–µ—Å—Ç 1: –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
print("transpose([[1, 2, 3]]):", transpose([[1, 2, 3]]))  # [[1], [2], [3]]

# –¢–µ—Å—Ç 2: —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–≤–∞–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã
try:
    print("transpose([[1, 2], [3]]):", transpose([[1, 2], [3]]))
except ValueError as e:
    print(f"transpose([[1, 2], [3]]): ValueError - {e}")

# –¢–µ—Å—Ç 3: —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É—Å—Ç–æ–π –º–∞—Ç—Ä–∏—Ü—ã
print("transpose([]):", transpose([]))  # []

# –¢–µ—Å—Ç 4: —Å—É–º–º—ã –ø–æ —Å—Ç—Ä–æ–∫–∞–º
print("row_sums([[1, 2, 3], [4, 5, 6]]):", row_sums([[1, 2, 3], [4, 5, 6]]))  # [6, 15]

# –¢–µ—Å—Ç 5: —Å—É–º–º—ã –ø–æ —Å—Ç—Ä–æ–∫–∞–º —Ä–≤–∞–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã
try:
    print("row_sums([[1, 2], [3]]):", row_sums([[1, 2], [3]]))
except ValueError as e:
    print(f"row_sums([[1, 2], [3]]): ValueError - {e}")

# –¢–µ—Å—Ç 6: —Å—É–º–º—ã –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º
print("col_sums([[1, 2, 3], [4, 5, 6]]):", col_sums([[1, 2, 3], [4, 5, 6]]))  # [5, 7, 9]

# –¢–µ—Å—Ç 7: —Å—É–º–º—ã –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º —Ä–≤–∞–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã
try:
    print("col_sums([[1, 2], [3]]):", col_sums([[1, 2], [3]]))
except ValueError as e:
    print(f"col_sums([[1, 2], [3]]): ValueError - {e}")

# –¢–µ—Å—Ç 8: –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã
print("transpose([[1, 2], [3, 4]]):", transpose([[1, 2], [3, 4]]))  # [[1, 3], [2, 4]]
print("row_sums([[-1, 1], [10, -10]]):", row_sums([[-1, 1], [10, -10]]))  # [0, 0]
print("col_sums([[-1, 1], [10, -10]]):", col_sums([[-1, 1], [10, -10]]))  # [9, -9]
```
**–í—ã–≤–æ–¥:**

![alt text](<images/lab02/ex.02.png>)
#   –ó–∞–¥–∞–Ω–∏–µ C: tuples.py

**–§–∞–π–ª:** `src/lab02/ex.03.py`

``` python
def format_record(rec: tuple[str, str, float]) -> str:
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –∑–∞–ø–∏—Å—å —Å—Ç—É–¥–µ–Ω—Ç–∞ –≤ —Å—Ç—Ä–æ–∫—É.

    Args:
        rec: –ö–æ—Ä—Ç–µ–∂ (–§–ò–û, –≥—Ä—É–ø–ø–∞, GPA)

    Returns:
        –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –≤–∏–¥–∞ "–§–∞–º–∏–ª–∏—è –ò.–û., –≥—Ä. –ì–†–£–ü–ü–ê, GPA X.XX"

    Raises:
        ValueError: –ï—Å–ª–∏ –§–ò–û –∏–ª–∏ –≥—Ä—É–ø–ø–∞ –ø—É—Å—Ç—ã–µ, –∏–ª–∏ GPA –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π
        TypeError: –ï—Å–ª–∏ –Ω–µ–≤–µ—Ä–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö
    """
    if not isinstance(rec, tuple) or len(rec) != 3:
        raise TypeError("–ó–∞–ø–∏—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∫–æ—Ä—Ç–µ–∂–µ–º –∏–∑ 3 —ç–ª–µ–º–µ–Ω—Ç–æ–≤")

    fio, group, gpa = rec

    if not isinstance(fio, str) or not isinstance(group, str) or not isinstance(gpa, (int, float)):
        raise TypeError("–ù–µ–≤–µ—Ä–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö: –æ–∂–∏–¥–∞–ª–∏—Å—å (str, str, float)")

    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –§–ò–û
    fio_clean = ' '.join(fio.split()).title()  # –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã –∏ –¥–µ–ª–∞–µ–º –∑–∞–≥–ª–∞–≤–Ω—ã–µ –±—É–∫–≤—ã
    fio_parts = fio_clean.split()

    if len(fio_parts) < 2:
        raise ValueError("–§–ò–û –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º —Ñ–∞–º–∏–ª–∏—é –∏ –∏–º—è")

    if not fio_clean or not group:
        raise ValueError("–§–ò–û –∏ –≥—Ä—É–ø–ø–∞ –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º–∏")

    if gpa < 0:
        raise ValueError("GPA –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º")

    # –§–æ—Ä–º–∏—Ä—É–µ–º –∏–Ω–∏—Ü–∏–∞–ª—ã
    surname = fio_parts[0]
    initials = '.'.join(name[0].upper() for name in fio_parts[1:]) + '.'

    # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º GPA —Å 2 –∑–Ω–∞–∫–∞–º–∏ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
    gpa_formatted = f"{gpa:.2f}"

    return f"{surname} {initials}, –≥—Ä. {group}, GPA {gpa_formatted}"
'''
print("\n=== Tuples Tests ===")
print(format_record(("–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á", "BIVT-25", 4.6)))  # "–ò–≤–∞–Ω–æ–≤ –ò.–ò., –≥—Ä. BIVT-25, GPA 4.60"
print(format_record(("–ü–µ—Ç—Ä–æ–≤ –ü—ë—Ç—Ä", "IKBO-12", 5.0)))  # "–ü–µ—Ç—Ä–æ–≤ –ü., –≥—Ä. IKBO-12, GPA 5.00"
'''
print("\n=== Tuples Tests ===")

# –¢–µ—Å—Ç 1: –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π —Å–ª—É—á–∞–π —Å –æ—Ç—á–µ—Å—Ç–≤–æ–º
try:
    result = format_record(("–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á", "BIVT-25", 4.6))
    print(f"format_record(('–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á', 'BIVT-25', 4.6)): {result}")
except Exception as e:
    print(f"format_record(('–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á', 'BIVT-25', 4.6)): {type(e).__name__} - {e}")

# –¢–µ—Å—Ç 2: –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π —Å–ª—É—á–∞–π –±–µ–∑ –æ—Ç—á–µ—Å—Ç–≤–∞
try:
    result = format_record(("–ü–µ—Ç—Ä–æ–≤ –ü—ë—Ç—Ä", "IKBO-12", 5.0))
    print(f"format_record(('–ü–µ—Ç—Ä–æ–≤ –ü—ë—Ç—Ä', 'IKBO-12', 5.0)): {result}")
except Exception as e:
    print(f"format_record(('–ü–µ—Ç—Ä–æ–≤ –ü—ë—Ç—Ä', 'IKBO-12', 5.0)): {type(e).__name__} - {e}")

# –¢–µ—Å—Ç 3: –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π —Å–ª—É—á–∞–π —Å –ª–∏—à–Ω–∏–º–∏ –ø—Ä–æ–±–µ–ª–∞–º–∏
try:
    result = format_record(("    —Ö—É–∂–∞–º–æ–≤–∞   —Ç–∞—Å–º–∏–Ω–∞   –º—É–∑–∞—Ñ—Ñ–∞—Ä–æ–≤–Ω–∞ ", "ABB-01", 3.999))
    print(f"format_record(('  —Ö—É–∂–∞–º–æ–≤–∞  —Ç–∞—Å–º–∏–Ω–∞  –º—É–∑–∞—Ñ—Ñ–∞—Ä–æ–≤–Ω–∞ ', 'ABB-01', 3.999)): {result}")
except Exception as e:
    print(f"format_record(('  —Ö—É–∂–∞–º–æ–≤–∞   —Ç–∞—Å–º–∏–Ω–∞   –º—É–∑–∞—Ñ—Ñ–∞—Ä–æ–≤–Ω–∞ ', 'ABB-01', 3.999)): {type(e).__name__} - {e}")

# –¢–µ—Å—Ç 4: –æ—à–∏–±–∫–∞ - –ø—É—Å—Ç–æ–µ –§–ò–û
try:
    result = format_record(("", "BIVT-25", 4.6))
    print(f"format_record(('', 'BIVT-25', 4.6)): {result}")
except Exception as e:
    print(f"format_record(('', 'BIVT-25', 4.6)): {type(e).__name__} - {e}")

# –¢–µ—Å—Ç 5: –æ—à–∏–±–∫–∞ - –ø—É—Å—Ç–∞—è –≥—Ä—É–ø–ø–∞
try:
    result = format_record(("–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω", "", 4.6))
    print(f"format_record(('–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω', '', 4.6)): {result}")
except Exception as e:
    print(f"format_record(('–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω', '', 4.6)): {type(e).__name__} - {e}")

# –¢–µ—Å—Ç 6: –æ—à–∏–±–∫–∞ - –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π GPA
try:
    result = format_record(("–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω", "BIVT-25", -1.0))
    print(f"format_record(('–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω', 'BIVT-25', -1.0)): {result}")
except Exception as e:
    print(f"format_record(('–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω', 'BIVT-25', -1.0)): {type(e).__name__} - {e}")

# –¢–µ—Å—Ç 7: –æ—à–∏–±–∫–∞ - —Ç–æ–ª—å–∫–æ —Ñ–∞–º–∏–ª–∏—è
try:
    result = format_record(("–ò–≤–∞–Ω–æ–≤", "BIVT-25", 4.6))
    print(f"format_record(('–ò–≤–∞–Ω–æ–≤', 'BIVT-25', 4.6)): {result}")
except Exception as e:
    print(f"format_record(('–ò–≤–∞–Ω–æ–≤', 'BIVT-25', 4.6)): {type(e).__name__} - {e}")


# –¢–µ—Å—Ç 8: –æ—à–∏–±–∫–∞ - –Ω–µ–≤–µ—Ä–Ω—ã–π —Ç–∏–ø GPA
try:
    result = format_record(("–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω", "BIVT-25", "4.6"))
    print(f"format_record(('–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω', 'BIVT-25', '4.6')): {result}")
except Exception as e:
    print(f"format_record(('–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω', 'BIVT-25', '4.6')): {type(e).__name__} - {e}")

# –¢–µ—Å—Ç 9: –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π —Å–ª—É—á–∞–π —Å –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ–º GPA
try:
    result = format_record(("–•—É–∂–∞–º–æ–≤–∞ –¢–∞—Å–º–∏–Ω–∞", "IKBO-10", 3.456))
    print(f"format_record(('–•—É–∂–∞–º–æ–≤–∞ –¢–∞—Å–º–∏–Ω–∞', 'IKBO-10', 3.456)): {result}")
except Exception as e:
    print(f"format_record(('–•—É–∂–∞–º–æ–≤–∞ –¢–∞—Å–º–∏–Ω–∞', 'IKBO-10', 3.456)): {type(e).__name__} - {e}")
```

**–í—ã–≤–æ–¥:**

![alt text](<images/lab02/ex.03.png>)
**–°—Ç—É–¥–µ–Ω—Ç:** –•—É–∂–∞–º–æ–≤–∞ –¢–∞—Å–º–∏–Ω–∞ –ú—É–∑–∞—Ñ—Ñ–∞—Ä–æ–≤–Ω–∞
**–ì—Ä—É–ø–ø–∞:** [–ë–ò–í–¢-25-4]  
**–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å:** [–ó–∞–º—É—Ä–∞–≥–∏–Ω –ò.–ú.]


# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ3
# –¢–µ–∫—Å—Ç—ã –∏ —á–∞—Å—Ç–æ—Ç—ã —Å–ª–æ–≤ (—Å–ª–æ–≤–∞—Ä—å/–º–Ω–æ–∂–µ—Å—Ç–≤–æ)
# –¶–µ–ª—å: 
–ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç, –∞–∫–∫—É—Ä–∞—Ç–Ω–æ —Ç–æ–∫–µ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å, –ø–æ—Å—á–∏—Ç–∞—Ç—å —á–∞—Å—Ç–æ—Ç—ã —Å–ª–æ–≤ –∏ –≤—ã–≤–µ—Å—Ç–∏ —Ç–æ–ø-N.

# –ó–∞–¥–∞–Ω–∏–µ A (1.normalaize, 2.tokenize, 3.count_freq, 4.top_n):

**–§–∞–π–ª:** `src/lab03/normalaize.py`

```python
def normalize(text: str, *, casefold: bool = True, yo2e: bool = True) -> str:
    """
    –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç —Ç–µ–∫—Å—Ç: –ø—Ä–∏–≤–æ–¥–∏—Ç —Ä–µ–≥–∏—Å—Ç—Ä, –∑–∞–º–µ–Ω—è–µ—Ç —ë –Ω–∞ –µ, —É–±–∏—Ä–∞–µ—Ç –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã.
    
    Args:
        text: –ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç
        casefold: –ü—Ä–∏–≤–æ–¥–∏—Ç—å –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é True)
        yo2e: –ó–∞–º–µ–Ω—è—Ç—å —ë/–Å –Ω–∞ –µ/–ï (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é True)
        
    Returns:
        –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
    """
    if casefold==True:
        text=text.casefold()

    if yo2e==True:
        text=text.replace("—ë","–µ").replace("–Å","–ï")

    for char in ['\t', '\r', '\n']:
        text = text.replace(char, ' ')
        
    text=text.split()
    text=" ".join(text)
    return text

print("=== –¢–µ—Å—Ç—ã —Ç–µ–∫—Å—Ç–∞ ===")
texts = [
    "Hello\r\nWorld",
    "–ü—Ä–ò–≤–ï—Ç\n–ú–ò—Ä\t", 
    "—ë–∂–∏–∫, –Å–ª–∫–∞",
    "  –¥–≤–æ–π–Ω—ã–µ   –ø—Ä–æ–±–µ–ª—ã  ",
    "–ø—Ä–∏–≤–µ—Ç, –º–∏—Ä! –∫–∞–∫ –¥–µ–ª–∞?"
]

for text in texts:
    result = normalize(text)
    print(result)
```

**–í—ã–≤–æ–¥:** 

![alt text](<images/lab03/1_normalaize.png>)


**–§–∞–π–ª:** `src/lab03/tokenize.py`

``` python
import re


def tokenize(text: str) -> list[str]:
    """
    –†–∞–∑–±–∏–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç –Ω–∞ —Å–ª–æ–≤–∞ (—Ç–æ–∫–µ–Ω—ã).

    –ù–∞—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±—É–∫–≤, —Ü–∏—Ñ—Ä, –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–π,
    –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –¥–µ—Ñ–∏—Å—ã –≤–Ω—É—Ç—Ä–∏ —Å–ª–æ–≤.

    Args:
        text: –¢–µ–∫—Å—Ç –¥–ª—è —Ä–∞–∑–±–∏–µ–Ω–∏—è –Ω–∞ —Å–ª–æ–≤–∞

    Returns:
        –°–ø–∏—Å–æ–∫ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤
    """
    # –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–ª–æ–≤
    # [\w]+    - –æ–¥–Ω–∞ –∏–ª–∏ –±–æ–ª—å—à–µ –±—É–∫–≤/—Ü–∏—Ñ—Ä/–ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–π
    # (?:-[\w]+)* - –Ω–æ–ª—å –∏–ª–∏ –±–æ–ª—å—à–µ –ø–æ–≤—Ç–æ—Ä–æ–≤: –¥–µ—Ñ–∏—Å + –±—É–∫–≤—ã/—Ü–∏—Ñ—Ä—ã
    pattern = r"[\w]+(?:-[\w]+)*"

    # –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Å —à–∞–±–ª–æ–Ω–æ–º
    tokens = re.findall(pattern, text)

    return tokens

print("=== –¢–µ—Å—Ç—ã —Ç–µ–∫—Å—Ç–∞ ===")
texts = [
    "–ø—Ä–∏–≤–µ—Ç –º–∏—Ä",
    "hello,world!!!", 
    "–ø–æ-–Ω–∞—Å—Ç–æ—è—â–µ–º—É –∫—Ä—É—Ç–æ",
    "2025 –≥–æ–¥",
    "emoji üêà‚Äç‚¨õ –Ω–µ —Å–ª–æ–≤–æ"
]

for text in texts:
    result = tokenize(text)
    print(result)
```

**–í—ã–≤–æ–¥:** 

![alt text](<images/lab03/2_tokenize.png>)

**–§–∞–π–ª:** `src/lab02/–∑–∞–¥–∞–Ω–∏–µ B.3.py`

``` python


def count_freq(tokens: list[str]) -> dict[str, int]:
    """
    –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –∫–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ.

    Args:
        tokens: –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤ –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞

    Returns:
        –°–ª–æ–≤–∞—Ä—å, –≥–¥–µ –∫–ª—é—á - —Å–ª–æ–≤–æ, –∑–Ω–∞—á–µ–Ω–∏–µ - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ö–æ–∂–¥–µ–Ω–∏–π

    Examples:
        >>> count_freq(["—è–±–ª–æ–∫–æ", "–±–∞–Ω–∞–Ω", "—è–±–ª–æ–∫–æ"])
        {'—è–±–ª–æ–∫–æ': 2, '–±–∞–Ω–∞–Ω': 1}

        >>> count_freq(["–¥–∞", "–Ω–µ—Ç", "–¥–∞", "–º–æ–∂–µ—Ç –±—ã—Ç—å"])
        {'–¥–∞': 2, '–Ω–µ—Ç': 1, '–º–æ–∂–µ—Ç –±—ã—Ç—å': 1}
    """
    # –°–æ–∑–¥–∞–µ–º –ø—É—Å—Ç–æ–π —Å–ª–æ–≤–∞—Ä—å –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    frequency_dict = {}

    # –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –∫–∞–∂–¥–æ–º—É —Å–ª–æ–≤—É –≤ —Å–ø–∏—Å–∫–µ
    for word in tokens:
        if word not in frequency_dict:
            # –ï—Å–ª–∏ —Å–ª–æ–≤–∞ –µ—â–µ –Ω–µ—Ç - –¥–æ–±–∞–≤–ª—è–µ–º —Å–æ —Å—á–µ—Ç—á–∏–∫–æ–º 1
            frequency_dict[word] = 1
        else:
            # –ï—Å–ª–∏ —Å–ª–æ–≤–æ —É–∂–µ –µ—Å—Ç—å - —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –Ω–∞ 1
            frequency_dict[word] += 1

    return frequency_dict

def top_n(freq: dict[str, int], n: int = 5) -> list[tuple[str, int]]: 
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç n –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–∏—Ö—Å—è 
    —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–∑ —Å–ª–æ–≤–∞—Ä—è —á–∞—Å—Ç–æ—Ç.

    Args:
        freq: –°–ª–æ–≤–∞—Ä—å, –≥–¥–µ –∫–ª—é—á–∏ - —ç—Ç–æ —ç–ª–µ–º–µ–Ω—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–æ–≤–∞), 
        –∞ –∑–Ω–∞—á–µ–Ω–∏—è - –∏—Ö —á–∞—Å—Ç–æ—Ç–∞ –≤—Å—Ç—Ä–µ—á–∞–µ–º–æ—Å—Ç–∏

        n: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∞–º—ã—Ö —á–∞—Å—Ç–æ–≤—Å—Ç—Ä–µ—á–∞—é—â–∏—Ö—Å—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å.
        –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞–≤–Ω–æ 5.

    Returns:
        list[tuple[str, int]]: –°–ø–∏—Å–æ–∫ –∏–∑ `n` –∫–æ—Ä—Ç–µ–∂–µ–π, 
        –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–¥–µ—Ä–∂–∏—Ç —ç–ª–µ–º–µ–Ω—Ç
        (—Å—Ç—Ä–æ–∫—É) –∏ –µ–≥–æ —á–∞—Å—Ç–æ—Ç—É (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ), 
        –æ—Ç—Å—Ä–æ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤ –ø–æ—Ä—è–¥–∫–µ —É–±—ã–≤–∞–Ω–∏—è —á–∞—Å—Ç–æ—Ç—ã.
    
    """
    # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Å–ª–æ–≤–∞—Ä—å –≤ —Å–ø–∏—Å–æ–∫ –∫–æ—Ä—Ç–µ–∂–µ–π
    items = list(freq.items())

    # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é —á–∞—Å—Ç–æ—Ç—ã, –ø—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ - –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É.lambda - –∫–ª—é—á –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ —á–∞—Å—Ç–æ—Ç–µ–± 
    sorted_items = sorted(items,  key=lambda x: (-x[1], x[0]))

    # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–µ—Ä–≤—ã–µ n —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    return sorted_items[:n]

print("=== –¢–µ—Å—Ç—ã —Å–ø–∏—Å–∫–∞/—Å–ª–æ–≤–∞—Ä—è ‚Ññ1===")
tokens = ["a","b","a","c","b","a"]
result_for_count=count_freq(tokens)
result_for_top=top_n(result_for_count, n=2)
print("–°–ª–æ–≤–∞—Ä—å —á–∞—Å—Ç–æ—Ç:", result_for_count)
print("–¢–æ–ø-2 —Å–ª–æ–≤:", result_for_top)


print("=== –¢–µ—Å—Ç—ã —Å–ø–∏—Å–∫–∞/—Å–ª–æ–≤–∞—Ä—è ‚Ññ2===")
tokens = ["bb","aa","bb","aa","cc"]
result_for_count=count_freq(tokens)
result_for_top=top_n(result_for_count, n=2)
print("–°–ª–æ–≤–∞—Ä—å —á–∞—Å—Ç–æ—Ç:", result_for_count)
print("–¢–æ–ø-2 —Å–ª–æ–≤:", result_for_top)

```

**–í—ã–≤–æ–¥:**

![alt text](<images/lab03/3_count_freq.png>)

# –ó–∞–¥–∞–Ω–∏–µ test_stats

# –í–≤–æ–¥:

``` python
#!/usr/bin/env python3
"""
text_stats.py - —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
–õ–†3 ‚Äî –¢–µ–∫—Å—Ç—ã –∏ —á–∞—Å—Ç–æ—Ç—ã —Å–ª–æ–≤
–°—Ç—É–¥–µ–Ω—Ç: –•—É–∂–∞–º–æ–≤–∞ –¢–∞—Å–º–∏–Ω–∞ –ú—É–∑–∞—Ñ—Ñ–∞—Ä–æ–≤–Ω–∞
–ì—Ä—É–ø–ø–∞: –ë–ò–í–¢-25-4
"""

import sys
import os

# –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Ç—å –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ –Ω–∞—à–∏—Ö –º–æ–¥—É–ª–µ–π
sys.path.append(os.path.join(os.path.dirname(__file__), '..', 'lib'))

# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –Ω–∞—à–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
from text import normalize, tokenize, count_freq, top_n


def text_stats(text: str, table_mode: bool = False) -> None:
    """
    –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç –∏ –≤—ã–≤–æ–¥–∏—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Å–ª–æ–≤–∞–º.
    
    Args:
        text: –ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
        table_mode: –ï—Å–ª–∏ True, –≤—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –≤–∏–¥–µ —Ç–∞–±–ª–∏—Ü—ã
    """
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ç–µ–∫—Å—Ç –Ω–µ –ø—É—Å—Ç–æ–π
    if not text or not text.strip():
        print("–û—à–∏–±–∫–∞: —Ç–µ–∫—Å—Ç –ø—É—Å—Ç–æ–π –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–æ–±–µ–ª—ã")
        return
    
    # 1. –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º —Ç–µ–∫—Å—Ç (–ø—Ä–∏–≤–æ–¥–∏–º –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É, —É–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã)
    norm_text = normalize(text)
    
    # 2. –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞ (—Ç–æ–∫–µ–Ω—ã)
    tokens = tokenize(norm_text)
    
    # 3. –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —á–∞—Å—Ç–æ—Ç—É –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞
    freq = count_freq(tokens)
    
    # 4. –ü–æ–ª—É—á–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    total_words = len(tokens)
    unique_words = len(freq)
    top_words = top_n(freq, n=5)
    
    # 5. –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    print(f'–í—Å–µ–≥–æ —Å–ª–æ–≤: {total_words}')
    print(f'–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤: {unique_words}')
    print('–¢–æ–ø-5:')
    
    if table_mode:
        print_table_output(top_words)
    else:
        print_simple_output(top_words)


def print_simple_output(top_words):
    """
    –ü—Ä–æ—Å—Ç–æ–π –≤—ã–≤–æ–¥ —Ç–æ–ø-—Å–ª–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ '—Å–ª–æ–≤–æ:—á–∞—Å—Ç–æ—Ç–∞'
    
    Args:
        top_words: –°–ø–∏—Å–æ–∫ –∫–æ—Ä—Ç–µ–∂–µ–π (—Å–ª–æ–≤–æ, —á–∞—Å—Ç–æ—Ç–∞)
    """
    for word, count in top_words:
        print(f'{word}:{count}')


def print_table_output(top_words):
    """
    –ö—Ä–∞—Å–∏–≤–æ –≤—ã—Ä–æ–≤–Ω–µ–Ω–Ω—ã–π —Ç–∞–±–ª–∏—á–Ω—ã–π –≤—ã–≤–æ–¥
    
    Args:
        top_words: –°–ø–∏—Å–æ–∫ –∫–æ—Ä—Ç–µ–∂–µ–π (—Å–ª–æ–≤–æ, —á–∞—Å—Ç–æ—Ç–∞)
    """
    if not top_words:
        print("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è")
        return
    
    # –ù–∞—Ö–æ–¥–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É —Å–ª–æ–≤–∞ –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è
    max_word_len = max(len(word) for word, _ in top_words)
    
    # –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã
    header = "—Å–ª–æ–≤–æ".ljust(max_word_len) + " | —á–∞—Å—Ç–æ—Ç–∞"
    separator = "-" * len(header)
    
    print(header)
    print(separator)
    
    # –í—ã–≤–æ–¥–∏–º –¥–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
    for word, count in top_words:
        print(f"{word.ljust(max_word_len)} | {count}")


def get_input_text():
    """
    –ü–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—Å—Ç –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ä–∞–∑–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏
    
    Returns:
        –í–≤–µ–¥–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
    """
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –≤ stdin (pipe –∏–ª–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)
    if not sys.stdin.isatty():  # –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ pipe –∏–ª–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
        return sys.stdin.read().strip()
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
    if len(sys.argv) > 1 and not sys.argv[1].startswith('--'):
        # –ß–∏—Ç–∞–µ–º –∏–∑ —Ñ–∞–π–ª–∞: python text_stats.py filename.txt
        try:
            with open(sys.argv[1], 'r', encoding='utf-8') as f:
                return f.read()
        except FileNotFoundError:
            print(f"–û—à–∏–±–∫–∞: —Ñ–∞–π–ª {sys.argv[1]} –Ω–µ –Ω–∞–π–¥–µ–Ω")
            return None
    else:
        # –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤–≤–æ–¥
        print("–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫):")
        print("–î–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤–≤–æ–¥–∞ –Ω–∞–∂–º–∏—Ç–µ Ctrl+D (Linux/Mac) –∏–ª–∏ Ctrl+Z (Windows):")
        
        try:
            return sys.stdin.read().strip()
        except EOFError:
            print("\n–í–≤–æ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω.")
            return None


def main():
    """
    –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è - –ø–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—Å—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –∞–Ω–∞–ª–∏–∑
    """
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤–∫–ª—é—á–µ–Ω –ª–∏ —Ç–∞–±–ª–∏—á–Ω—ã–π —Ä–µ–∂–∏–º
    table_mode = '--table' in sys.argv or os.getenv('TEXT_STATS_TABLE', '0') == '1'
    
    # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç
    text = get_input_text()
    
    if not text:
        print("–û—à–∏–±–∫–∞: —Ç–µ–∫—Å—Ç –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º")
        return
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∞–ª–∏–∑
    text_stats(text, table_mode)


if __name__ == '__main__':
    main()
```

# –í—ã–≤–æ–¥

![alt text](<images/lab03/test_stats.png>)


# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ4
# –∑–∞–¥–∞–Ω–∏–µ –ê

**–§–∞–π–ª text_report:**
``` python
#!/usr/bin/env python3
"""
text_report.py - —Å–∫—Ä–∏–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–æ–≤ –ø–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ
–õ–†4 ‚Äî –§–∞–π–ª—ã: TXT/CSV –∏ –æ—Ç—á—ë—Ç—ã

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã: –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –∫–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è,
–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ CSV —Ñ–∞–π–ª. –¢–∞–∫–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ –∫–æ–Ω—Å–æ–ª–∏.

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
    python src/lab04/text_report.py                    # –ë–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è
    python src/lab04/text_report.py --table            # –° –∫—Ä–∞—Å–∏–≤–æ–π —Ç–∞–±–ª–∏—Ü–µ–π
    python src/lab04/text_report.py --input my.txt     # –°–≤–æ–∏ —Ñ–∞–π–ª—ã
"""

# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–æ–¥—É–ª–∏ Python
import sys        # –î–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ (–≤—ã—Ö–æ–¥ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã)
import argparse   # –î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ (--input, --output –∏ —Ç.–¥.)
from pathlib import Path  # –î–ª—è —É–¥–æ–±–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –ø—É—Ç—è–º–∏ —Ñ–∞–π–ª–æ–≤ –∏ –ø–∞–ø–æ–∫

"""
–í–ù–ò–ú–ê–ù–ò–ï: —Å–ª–µ–¥—É—é—â–∏–π –±–ª–æ–∫ –∫–æ–¥–∞ –Ω—É–∂–µ–Ω —á—Ç–æ–±—ã Python –º–æ–≥ –Ω–∞–π—Ç–∏ –Ω–∞—à–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏
–≤ –ø–∞–ø–∫–µ src/lib/ –∏ src/lab04/
"""
# –ü–æ–ª—É—á–∞–µ–º –ø—É—Ç—å –∫ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –ø–∞–ø–∫–µ (src/) –∏ –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –≤ sys.path
# –≠—Ç–æ –Ω—É–∂–Ω–æ —á—Ç–æ–±—ã –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—à–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏
sys.path.append(str(Path(__file__).parent.parent))

# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –Ω–∞—à–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–æ–≤
from lib.text import normalize, tokenize, count_freq, top_n        # –§—É–Ω–∫—Ü–∏–∏ –∏–∑ –õ–†3 –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–µ–∫—Å—Ç–æ–º
from lab04.io_txt_csv import read_text, write_csv                 # –§—É–Ω–∫—Ü–∏–∏ –∏–∑ —ç—Ç–æ–π –õ–† –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏


def print_table_output(top_words: list[tuple[str, int]]) -> None:
    """
    –í—ã–≤–æ–¥–∏—Ç –∫—Ä–∞—Å–∏–≤—É—é —Ç–∞–±–ª–∏—Ü—É —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –≤ –∫–æ–Ω—Å–æ–ª—å.
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –±–µ—Ä–µ—Ç —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤ —Å —á–∞—Å—Ç–æ—Ç–∞–º–∏ –∏ –≤—ã–≤–æ–¥–∏—Ç –∏—Ö –≤ –≤–∏–¥–µ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
    —Å –≤—ã—Ä–æ–≤–Ω–µ–Ω–Ω—ã–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏.
    
    Args:
        top_words (list[tuple[str, int]]): –°–ø–∏—Å–æ–∫ –∫–æ—Ä—Ç–µ–∂–µ–π –≤ —Ñ–æ—Ä–º–∞—Ç–µ (—Å–ª–æ–≤–æ, —á–∞—Å—Ç–æ—Ç–∞)
            –ü—Ä–∏–º–µ—Ä: [('–ø—Ä–∏–≤–µ—Ç', 2), ('–º–∏—Ä', 1), ('—Ç–µ–∫—Å—Ç', 1)]
    
    Returns:
        None: –§—É–Ω–∫—Ü–∏—è —Ç–æ–ª—å–∫–æ –ø–µ—á–∞—Ç–∞–µ—Ç –≤ –∫–æ–Ω—Å–æ–ª—å, –Ω–∏—á–µ–≥–æ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç
    
    –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
        —Å–ª–æ–≤–æ      | —á–∞—Å—Ç–æ—Ç–∞
        -------------------
        –ø—Ä–∏–≤–µ—Ç     | 2
        –º–∏—Ä        | 1
        —Ç–µ–∫—Å—Ç      | 1
    """
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—ã–≤–æ–¥–∞
    if not top_words:
        print("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è")
        return
    
    """
    –®–∞–≥ 1: –ù–∞—Ö–æ–¥–∏–º —Å–∞–º—É—é –¥–ª–∏–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö —Å–ª–æ–≤
    –≠—Ç–æ –Ω—É–∂–Ω–æ —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –∫—Ä–∞—Å–∏–≤—É—é —Ç–∞–±–ª–∏—Ü—É —Å —Ä–æ–≤–Ω—ã–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏
    """
    # –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –≤—Å–µ–º —Å–ª–æ–≤–∞–º –∏ –Ω–∞—Ö–æ–¥–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É
    max_word_len = max(len(word) for word, _ in top_words)
    
    """
    –®–∞–≥ 2: –°–æ–∑–¥–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã
    ljust() –¥–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–æ–±–µ–ª—ã —Å–ø—Ä–∞–≤–∞ –¥–æ –Ω—É–∂–Ω–æ–π –¥–ª–∏–Ω—ã, —á—Ç–æ–±—ã –≤—ã—Ä–æ–≤–Ω—è—Ç—å —Ç–µ–∫—Å—Ç
    """
    header = "—Å–ª–æ–≤–æ".ljust(max_word_len) + " | —á–∞—Å—Ç–æ—Ç–∞"
    
    # –°–æ–∑–¥–∞–µ–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å–Ω—É—é –ª–∏–Ω–∏—é –ø–æ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º
    separator = "-" * len(header)  # –°—Ç—Ä–æ–∫–∞ –∏–∑ —Å–∏–º–≤–æ–ª–æ–≤ '-' —Ç–æ–π –∂–µ –¥–ª–∏–Ω—ã —á—Ç–æ –∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫
    
    """
    –®–∞–≥ 3: –í—ã–≤–æ–¥–∏–º —Ç–∞–±–ª–∏—Ü—É
    """
    print(header)      # –ó–∞–≥–æ–ª–æ–≤–æ–∫: "—Å–ª–æ–≤–æ      | —á–∞—Å—Ç–æ—Ç–∞"
    print(separator)   # –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å: "-------------------"
    
    # –í—ã–≤–æ–¥–∏–º –∫–∞–∂–¥—É—é —Å—Ç—Ä–æ–∫—É –¥–∞–Ω–Ω—ã—Ö
    for word, count in top_words:
        # ljust() –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Å–ª–æ–≤–æ –ø–æ –ª–µ–≤–æ–º—É –∫—Ä–∞—é, –¥–æ–±–∞–≤–ª—è—è –ø—Ä–æ–±–µ–ª—ã —Å–ø—Ä–∞–≤–∞
        print(f"{word.ljust(max_word_len)} | {count}")


def analyze_text(text: str) -> tuple[int, int, list[tuple[str, int]]]:
    """
    –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Å–ª–æ–≤–∞–º.
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —è–≤–ª—è–µ—Ç—Å—è "—Å–µ—Ä–¥—Ü–µ–º" –ø—Ä–æ–≥—Ä–∞–º–º—ã - –æ–Ω–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ–∫—Å—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç
    –≤—Å—é –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É: –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤,
    –∏ —Å–ø–∏—Å–æ–∫ —Å–∞–º—ã—Ö —á–∞—Å—Ç—ã—Ö —Å–ª–æ–≤.
    
    Args:
        text (str): –ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
        
    Returns:
        tuple: –ö–æ—Ä—Ç–µ–∂ –∏–∑ —Ç—Ä–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤:
            - total_words (int): –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤ –≤ —Ç–µ–∫—Å—Ç–µ
            - unique_words (int): –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤ (–±–µ–∑ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π)
            - top_words (list): –°–ø–∏—Å–æ–∫ –∫–æ—Ä—Ç–µ–∂–µ–π (—Å–ª–æ–≤–æ, —á–∞—Å—Ç–æ—Ç–∞) –¥–ª—è —Ç–æ–ø-5 —Å–ª–æ–≤
    
    –ü—Ä–æ—Ü–µ—Å—Å –∞–Ω–∞–ª–∏–∑–∞:
        1. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è: –ø—Ä–∏–≤–æ–¥–∏–º —Ç–µ–∫—Å—Ç –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É, —É–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
        2. –¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è: —Ä–∞–∑–±–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞
        3. –ü–æ–¥—Å—á–µ—Ç —á–∞—Å—Ç–æ—Ç: —Å—á–∏—Ç–∞–µ–º —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –∫–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è
        4. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: –Ω–∞—Ö–æ–¥–∏–º 5 —Å–∞–º—ã—Ö —á–∞—Å—Ç—ã—Ö —Å–ª–æ–≤
    """
    # –®–∞–≥ 1: –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º —Ç–µ–∫—Å—Ç (–ø—Ä–∏–≤–æ–¥–∏–º –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É, —É–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã)
    normalized_text = normalize(text)
    
    # –®–∞–≥ 2: –†–∞–∑–±–∏–≤–∞–µ–º –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞ (—Ç–æ–∫–µ–Ω—ã)
    tokens = tokenize(normalized_text)
    
    # –®–∞–≥ 3: –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —á–∞—Å—Ç–æ—Ç—É –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞ (—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è)
    frequency_dict = count_freq(tokens)
    
    # –®–∞–≥ 4: –ù–∞—Ö–æ–¥–∏–º 5 —Å–∞–º—ã—Ö —á–∞—Å—Ç—ã—Ö —Å–ª–æ–≤
    top_5_words = top_n(frequency_dict, 5)
    
    # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    total_word_count = len(tokens)           # –í—Å–µ–≥–æ —Å–ª–æ–≤ (—Å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è–º–∏)
    unique_word_count = len(frequency_dict)  # –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤ (–±–µ–∑ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π)
    
    return total_word_count, unique_word_count, top_5_words


def generate_report(input_file: str, output_file: str, encoding: str = "utf-8", table_output: bool = False) -> None:
    """
    –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞ - –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç –≤—Å—é —Ä–∞–±–æ—Ç—É.
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è:
      1. –ß–∏—Ç–∞–µ—Ç —Ç–µ–∫—Å—Ç –∏–∑ —Ñ–∞–π–ª–∞
      2. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –µ–≥–æ
      3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ–ª–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ CSV
      4. –í—ã–≤–æ–¥–∏—Ç –∫—Ä–∞—Ç–∫—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ –∫–æ–Ω—Å–æ–ª—å
    
    Args:
        input_file (str): –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å —Ç–µ–∫—Å—Ç–æ–º –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
        output_file (str): –ü—É—Ç—å –∫—É–¥–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å CSV –æ—Ç—á–µ—Ç
        encoding (str): –ö–æ–¥–∏—Ä–æ–≤–∫–∞ –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (utf-8, cp1251 –∏ —Ç.–¥.)
        table_output (bool): –ï—Å–ª–∏ True - –≤—ã–≤–æ–¥–∏—Ç –∫—Ä–∞—Å–∏–≤—É—é —Ç–∞–±–ª–∏—Ü—É, –∏–Ω–∞—á–µ –ø—Ä–æ—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫
    
    Raises:
        FileNotFoundError: –ï—Å–ª–∏ –≤—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        UnicodeDecodeError: –ï—Å–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —É–∫–∞–∑–∞–Ω–∞ –∫–æ–¥–∏—Ä–æ–≤–∫–∞ —Ñ–∞–π–ª–∞
    """
    try:
        """
        –ë–õ–û–ö 1: –ß–¢–ï–ù–ò–ï –§–ê–ô–õ–ê
        """
        print(f"–ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª: {input_file}")
        text_content = read_text(input_file, encoding)
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Ñ–∞–π–ª –Ω–µ –ø—É—Å—Ç–æ–π
        if not text_content.strip():
            print("–í–Ω–∏–º–∞–Ω–∏–µ: —Ñ–∞–π–ª –ø—É—Å—Ç–æ–π –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–æ–±–µ–ª—ã")
        
        """
        –ë–õ–û–ö 2: –ê–ù–ê–õ–ò–ó –¢–ï–ö–°–¢–ê
        """
        print("–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç...")
        total_words, unique_words, top_words = analyze_text(text_content)
        
        """
        –ë–õ–û–ö 3: –ü–û–î–ì–û–¢–û–í–ö–ê –î–ê–ù–ù–´–• –î–õ–Ø CSV
        –ó–¥–µ—Å—å –º—ã –∑–∞–Ω–æ–≤–æ –ø–æ–ª—É—á–∞–µ–º —á–∞—Å—Ç–æ—Ç—ã –≤—Å–µ—Ö —Å–ª–æ–≤ –∏ —Å–æ—Ä—Ç–∏—Ä—É–µ–º –∏—Ö
        –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ CSV —Ñ–∞–π–ª
        """
        # –ü–æ–ª—É—á–∞–µ–º —á–∞—Å—Ç–æ—Ç—ã –≤—Å–µ—Ö —Å–ª–æ–≤ (–Ω–µ —Ç–æ–ª—å–∫–æ —Ç–æ–ø-5)
        all_frequencies = count_freq(tokenize(normalize(text_content)))
        
        # –°–æ—Ä—Ç–∏—Ä—É–µ–º —Å–ª–æ–≤–∞ –ø–æ —É–±—ã–≤–∞–Ω–∏—é —á–∞—Å—Ç–æ—Ç—ã, –ø—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ - –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É
        sorted_all_words = sorted(all_frequencies.items(), key=lambda x: (-x[1], x[0]))
        
        # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —Ñ–æ—Ä–º–∞—Ç –¥–ª—è CSV: —Å–ø–∏—Å–æ–∫ –∫–æ—Ä—Ç–µ–∂–µ–π (—Å–ª–æ–≤–æ, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ)
        csv_data = [(word, count) for word, count in sorted_all_words]
        
        """
        –ë–õ–û–ö 4: –°–û–•–†–ê–ù–ï–ù–ò–ï CSV –û–¢–ß–ï–¢–ê
        """
        print(f"–°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ç—á–µ—Ç...")
        write_csv(csv_data, output_file, header=("word", "count"))
        
        """
        –ë–õ–û–ö 5: –í–´–í–û–î –°–¢–ê–¢–ò–°–¢–ò–ö–ò –í –ö–û–ù–°–û–õ–¨
        """
        print("\n–†–ï–ó–£–õ–¨–¢–ê–¢–´ –ê–ù–ê–õ–ò–ó–ê:")
        print(f"   –í—Å–µ–≥–æ —Å–ª–æ–≤: {total_words}")
        print(f"   –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤: {unique_words}")
        print("   –¢–æ–ø-5 —Å–∞–º—ã—Ö —á–∞—Å—Ç—ã—Ö —Å–ª–æ–≤:")
        
        if table_output:
            # –í–´–í–û–î –í –í–ò–î–ï –ö–†–ê–°–ò–í–û–ô –¢–ê–ë–õ–ò–¶–´
            print_table_output(top_words)
        else:
            # –ü–†–û–°–¢–û–ô –í–´–í–û–î (–∫–∞–∫ –±—ã–ª–æ —Ä–∞–Ω—å—à–µ)
            for word, count in top_words:
                print(f"   {word}: {count}")
            
        print(f"\n–ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤: {output_file}")
        
    except FileNotFoundError:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏: —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω
        print(f"–û—à–∏–±–∫–∞: —Ñ–∞–π–ª '{input_file}' –Ω–µ –Ω–∞–π–¥–µ–Ω!")
        print("   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –∏ –µ–≥–æ –Ω–∞–ª–∏—á–∏–µ")
        sys.exit(1)  # –ó–∞–≤–µ—Ä—à–∞–µ–º –ø—Ä–æ–≥—Ä–∞–º–º—É —Å –∫–æ–¥–æ–º –æ—à–∏–±–∫–∏ 1
        
    except UnicodeDecodeError:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏: –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞
        print(f"–û—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª '{input_file}' –≤ –∫–æ–¥–∏—Ä–æ–≤–∫–µ '{encoding}'")
        print("   –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:")
        print("   - –£–∫–∞–∂–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–æ–¥–∏—Ä–æ–≤–∫—É: --encoding cp1251")
        print("   - –ü—Ä–µ–æ–±—Ä–∞–∑—É–π—Ç–µ —Ñ–∞–π–ª –≤ UTF-8")
        sys.exit(1)  # –ó–∞–≤–µ—Ä—à–∞–µ–º –ø—Ä–æ–≥—Ä–∞–º–º—É —Å –∫–æ–¥–æ–º –æ—à–∏–±–∫–∏ 1


def main() -> None:
    """
    –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞.
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è:
      1. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø–∞—Ä—Å–µ—Ä –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
      2. –ß–∏—Ç–∞–µ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ—Ç–æ—Ä—ã–µ –≤–≤–µ–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      3. –ó–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞
    
    –ê—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏:
      --input, -i    : –ü—É—Ç—å –∫ –≤—Ö–æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—É
      --output, -o   : –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ç—á–µ—Ç–∞  
      --encoding, -e : –ö–æ–¥–∏—Ä–æ–≤–∫–∞ —Ñ–∞–π–ª–∞
      --table, -t    : –í–∫–ª—é—á–∏—Ç—å –∫—Ä–∞—Å–∏–≤—ã–π —Ç–∞–±–ª–∏—á–Ω—ã–π –≤—ã–≤–æ–¥
    """
    """
    –®–∞–≥ 1: –°–û–ó–î–ê–ï–ú –ü–ê–†–°–ï–† –ê–†–ì–£–ú–ï–ù–¢–û–í
    ArgumentParser - —ç—Ç–æ "—É–º–Ω—ã–π" –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ—Ç–æ—Ä—ã–π —Å–∞–º –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ø—Ä–∞–≤–∫—É
    –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
    """
    parser = argparse.ArgumentParser(
        description="–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç—á–µ—Ç –æ —á–∞—Å—Ç–æ—Ç–µ —Å–ª–æ–≤",
        epilog="–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:\n"
               "  python text_report.py                    # –ë–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è\n"
               "  python text_report.py --table            # –° –∫—Ä–∞—Å–∏–≤–æ–π —Ç–∞–±–ª–∏—Ü–µ–π\n"
               "  python text_report.py -i story.txt -t    # –ê–Ω–∞–ª–∏–∑ story.txt —Å —Ç–∞–±–ª–∏—Ü–µ–π"
    )
    
    """
    –®–∞–≥ 2: –î–û–ë–ê–í–õ–Ø–ï–ú –ê–†–ì–£–ú–ï–ù–¢–´
    –ö–∞–∂–¥—ã–π add_argument –¥–æ–±–∞–≤–ª—è–µ—Ç –æ–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ
    """
    
    # –ê—Ä–≥—É–º–µ–Ω—Ç –¥–ª—è –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
    parser.add_argument(
        '--input',                   # –î–ª–∏–Ω–Ω–æ–µ –∏–º—è: --input
        '-i',                        # –ö–æ—Ä–æ—Ç–∫–æ–µ –∏–º—è: -i
        default='data/lab04/input.txt',  # –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –µ—Å–ª–∏ –∞—Ä–≥—É–º–µ–Ω—Ç –Ω–µ —É–∫–∞–∑–∞–Ω
        help='–ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å —Ç–µ–∫—Å—Ç–æ–º –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞'  # –û–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏
    )
    
    # –ê—Ä–≥—É–º–µ–Ω—Ç –¥–ª—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
    parser.add_argument(
        '--output', 
        '-o',
        default='data/lab04/report.csv',
        help='–ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è CSV –æ—Ç—á–µ—Ç–∞ —Å –ø–æ–ª–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π'
    )
    
    # –ê—Ä–≥—É–º–µ–Ω—Ç –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∫–∏ —Ñ–∞–π–ª–∞
    parser.add_argument(
        '--encoding',
        '-e', 
        default='utf-8',
        help='–ö–æ–¥–∏—Ä–æ–≤–∫–∞ –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (utf-8, cp1251, koi8-r –∏ —Ç.–¥.)'
    )
    
    # –ê—Ä–≥—É–º–µ–Ω—Ç –¥–ª—è —Ç–∞–±–ª–∏—á–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞ (—Ñ–ª–∞–≥ - –ª–∏–±–æ –µ—Å—Ç—å, –ª–∏–±–æ –Ω–µ—Ç)
    parser.add_argument(
        '--table',
        '-t',
        action='store_true',  # –û—Å–æ–±—ã–π —Ç–∏–ø –∞—Ä–≥—É–º–µ–Ω—Ç–∞ - —Ñ–ª–∞–≥ (True –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω, False –µ—Å–ª–∏ –Ω–µ—Ç)
        help='–í—ã–≤–æ–¥–∏—Ç—å —Ç–æ–ø-5 —Å–ª–æ–≤ –≤ –≤–∏–¥–µ –∫—Ä–∞—Å–∏–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã'
    )
    
    """
    –®–∞–≥ 3: –ß–ò–¢–ê–ï–ú –ê–†–ì–£–ú–ï–ù–¢–´ –ò–ó –ö–û–ú–ê–ù–î–ù–û–ô –°–¢–†–û–ö–ò
    parse_args() –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç sys.argv (–∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–¥–∞–ª–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ)
    –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç —Å –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –≤—Å–µ—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
    """
    args = parser.parse_args()
    
    """
    –®–∞–≥ 4: –ó–ê–ü–£–°–ö–ê–ï–ú –ì–ï–ù–ï–†–ê–¶–ò–Æ –û–¢–ß–ï–¢–ê
    –ü–µ—Ä–µ–¥–∞–µ–º –≤—Å–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤ –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
    """
    print("–ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ–∫—Å—Ç–∞...")
    print(f"   –í—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª: {args.input}")
    print(f"   –í—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª: {args.output}") 
    print(f"   –ö–æ–¥–∏—Ä–æ–≤–∫–∞: {args.encoding}")
    print(f"   –¢–∞–±–ª–∏—á–Ω—ã–π –≤—ã–≤–æ–¥: {'–í–ö–õ–Æ–ß–ï–ù' if args.table else '–≤—ã–∫–ª—é—á–µ–Ω'}")
    print()
    
    generate_report(args.input, args.output, args.encoding, args.table)


"""
–≠–¢–ê –°–¢–†–û–ö–ê –û–ß–ï–ù–¨ –í–ê–ñ–ù–ê!
–û–Ω–∞ –æ–∑–Ω–∞—á–∞–µ—Ç: "–∑–∞–ø—É—Å–∫–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é main() —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —ç—Ç–æ—Ç —Ñ–∞–π–ª –∑–∞–ø—É—â–µ–Ω –Ω–∞–ø—Ä—è–º—É—é,
–∞ –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ –º–æ–¥—É–ª—å –≤ –¥—Ä—É–≥–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ"

–≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –≤ Python - –æ–Ω–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∞–π–ª –∏ –∫–∞–∫ —Å–∫—Ä–∏–ø—Ç,
–∏ –∫–∞–∫ –º–æ–¥—É–ª—å –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö
"""
if __name__ == "__main__":
    main()
```

**–§–∞–π–ª io_txt_csv:**
``` python
"""
–ú–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º–∏ –∏ CSV —Ñ–∞–π–ª–∞–º–∏.
–õ–†4 ‚Äî –§–∞–π–ª—ã: TXT/CSV –∏ –æ—Ç—á—ë—Ç—ã
"""

import csv
from pathlib import Path
from typing import Union, Iterable, Sequence


def read_text(path: Union[str, Path], encoding: str = "utf-8") -> str:
    """
    –ß–∏—Ç–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–∞–∫ —Å—Ç—Ä–æ–∫—É.
    
    Args:
        path: –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É (—Å—Ç—Ä–æ–∫–∞ –∏–ª–∏ Path –æ–±—ä–µ–∫—Ç)
        encoding: –ö–æ–¥–∏—Ä–æ–≤–∫–∞ —Ñ–∞–π–ª–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é UTF-8)
        
    Returns:
        –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ –∫–∞–∫ —Å—Ç—Ä–æ–∫–∞
        
    Raises:
        FileNotFoundError: –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        UnicodeDecodeError: –ï—Å–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞
        
    Examples:
        >>> text = read_text("data/input.txt")
        >>> text = read_text("data/file.txt", encoding="cp1251")
    """
    # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ Path –æ–±—ä–µ–∫—Ç –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
    file_path = Path(path)
    
    # –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª —Å —É–∫–∞–∑–∞–Ω–Ω–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π
    # –ï—Å–ª–∏ —Ñ–∞–π–ª–∞ –Ω–µ—Ç - –≤—ã–±—Ä–æ—Å–∏—Ç—Å—è FileNotFoundError
    # –ï—Å–ª–∏ –∫–æ–¥–∏—Ä–æ–≤–∫–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è - UnicodeDecodeError
    return file_path.read_text(encoding=encoding)


def write_csv(rows: Iterable[Sequence], path: Union[str, Path], 
              header: tuple[str, ...] = None) -> None:
    """
    –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ CSV —Ñ–∞–π–ª.
    
    Args:
        rows: –ò—Ç–µ—Ä–∏—Ä—É–µ–º—ã–π –æ–±—ä–µ–∫—Ç —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö
        path: –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è CSV —Ñ–∞–π–ª–∞
        header: –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        
    Raises:
        ValueError: –ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∏ –∏–º–µ—é—Ç —Ä–∞–∑–Ω—É—é –¥–ª–∏–Ω—É
        
    Examples:
        >>> data = [("word", "count"), ("–ø—Ä–∏–≤–µ—Ç", 2)]
        >>> write_csv(data, "report.csv", header=("word", "count"))
    """
    file_path = Path(path)
    rows_list = list(rows)  # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —Å–ø–∏—Å–æ–∫ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –¥–ª–∏–Ω—ã
    if rows_list:
        first_len = len(rows_list[0])
        for i, row in enumerate(rows_list):
            if len(row) != first_len:
                raise ValueError(f"–°—Ç—Ä–æ–∫–∞ {i} –∏–º–µ–µ—Ç –¥–ª–∏–Ω—É {len(row)}, –æ–∂–∏–¥–∞–ª–∞—Å—å {first_len}")
    
    # –°–æ–∑–¥–∞–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø–∞–ø–∫–∏ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
    file_path.parent.mkdir(parents=True, exist_ok=True)
    
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ CSV
    with file_path.open('w', encoding='utf-8', newline='') as file:
        writer = csv.writer(file)
        
        # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –µ—Å–ª–∏ –µ—Å—Ç—å
        if header is not None:
            writer.writerow(header)
        
        # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ
        for row in rows_list:
            writer.writerow(row)


def ensure_parent_dir(path: Union[str, Path]) -> None:
    """
    –°–æ–∑–¥–∞–µ—Ç —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç.
    
    Args:
        path: –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –∏–ª–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
        
    Examples:
        >>> ensure_parent_dir("data/reports/final.csv")
        # –°–æ–∑–¥–∞—Å—Ç –ø–∞–ø–∫–∏ data/ –∏ data/reports/ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
    """
    file_path = Path(path)
    file_path.parent.mkdir(parents=True, exist_ok=True)
```

# –¢–µ—Å—Ç—ã –∏ –≤—ã–≤–æ–¥—ã

**–û–±—ã—á–Ω—ã–π –≤—ã–≤–æ–¥**
![alt text](<images/lab04/ordinary.png>)

**–¢–∞–±–ª–∏—á–Ω—ã–π –≤—ã–≤–æ–¥**
![alt text](<images/lab04/table.png>)

**–í—ã–≤–æ–¥ –¥–ª—è —Ñ–∞–π–ª–∞ –∞**
![alt text](<images/lab04/test_a.png>)

**–í—ã–≤–æ–¥ –¥–ª—è —Ñ–∞–π–ª–∞ b**
![alt text](<images/lab04/test_b.png>)

**–¢–µ—Å—Ç –æ—à–∏–±–æ–∫**
![alt text](<images/lab04/test_error.png>)

**–í—ã–≤–æ–¥ —Å–ø—Ä–∞–≤–∫–∏ - help**
![alt text](<images/lab04/test_help.png>)


# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ5
# JSON –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ (JSON‚ÜîCSV, CSV‚ÜíXLSX): –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ
**–¶–µ–ª—å:**
–†–∞–∑–æ–±—Ä–∞—Ç—å—Å—è —Å —Ñ–æ—Ä–º–∞—Ç–æ–º JSON, —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π –∏ —Ç–∞–±–ª–∏—á–Ω—ã–º–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è–º–∏

**–§–∞–π–ª:** json_csv.py

``` python
"""
–ú–æ–¥—É–ª—å –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –º–µ–∂–¥—É JSON –∏ CSV —Ñ–æ—Ä–º–∞—Ç–∞–º–∏.
–õ–†5 ‚Äî JSON –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
"""

import json
import csv
from pathlib import Path


def json_to_csv(json_path: str, csv_path: str) -> None:
    """
    –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç JSON —Ñ–∞–π–ª –≤ CSV —Ñ–æ—Ä–º–∞—Ç.
    
    –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç JSON —Ñ–∞–π–ª—ã —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π.
    –ù–∞–ø—Ä–∏–º–µ—Ä: [{"name": "Alice", "age": 25}, {"name": "Bob", "age": 30}]
    
    Args:
        json_path: –ü—É—Ç—å –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É JSON —Ñ–∞–π–ª—É
        csv_path: –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è CSV —Ñ–∞–π–ª–∞
        
    Raises:
        FileNotFoundError: –ï—Å–ª–∏ JSON —Ñ–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        ValueError: –ï—Å–ª–∏ JSON –ø—É—Å—Ç–æ–π, –Ω–µ —Å–ø–∏—Å–æ–∫ –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ —Å–ª–æ–≤–∞—Ä–∏
    """
    # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –ø—É—Ç–∏ –≤ Path –æ–±—ä–µ–∫—Ç—ã
    json_file = Path(json_path)
    csv_file = Path(csv_path)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ JSON —Ñ–∞–π–ª–∞
    if not json_file.exists():
        raise FileNotFoundError(f"JSON —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: {json_path}")
    
    # –ß–∏—Ç–∞–µ–º JSON —Ñ–∞–π–ª
    with json_file.open('r', encoding='utf-8') as jf:
        try:
            data = json.load(jf)
        except json.JSONDecodeError as e:
            raise ValueError(f"–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è JSON: {e}")
    
    # –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    if not data:
        raise ValueError("–ü—É—Å—Ç–æ–π JSON —Ñ–∞–π–ª")
    
    if not isinstance(data, list):
        raise ValueError("JSON –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ø–∏—Å–æ–∫")
    
    if not all(isinstance(item, dict) for item in data):
        raise ValueError("–í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã JSON –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–ª–æ–≤–∞—Ä—è–º–∏")
    
    # –°–æ–∑–¥–∞–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø–∞–ø–∫–∏ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
    csv_file.parent.mkdir(parents=True, exist_ok=True)
    
    # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏ –∏–∑ –≤—Å–µ—Ö —Å–ª–æ–≤–∞—Ä–µ–π
    all_keys = set()
    for item in data:
        all_keys.update(item.keys())
    
    # –°–æ—Ä—Ç–∏—Ä—É–µ–º –∫–ª—é—á–∏ –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É –¥–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è
    fieldnames = sorted(all_keys)
    
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º CSV
    with csv_file.open('w', encoding='utf-8', newline='') as cf:
        writer = csv.DictWriter(cf, fieldnames=fieldnames)
        writer.writeheader()
        
        for item in data:
            # –ó–∞–ø–æ–ª–Ω—è–µ–º –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è –ø—É—Å—Ç—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏
            row = {key: item.get(key, '') for key in fieldnames}
            writer.writerow(row)


def csv_to_json(csv_path: str, json_path: str) -> None:
    """
    –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç CSV —Ñ–∞–π–ª –≤ JSON —Ñ–æ—Ä–º–∞—Ç.
    
    –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç CSV –≤ —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π, –≥–¥–µ –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ - –∑–∞–≥–æ–ª–æ–≤–∫–∏.
    
    Args:
        csv_path: –ü—É—Ç—å –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É CSV —Ñ–∞–π–ª—É
        json_path: –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è JSON —Ñ–∞–π–ª–∞
        
    Raises:
        FileNotFoundError: –ï—Å–ª–∏ CSV —Ñ–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        ValueError: –ï—Å–ª–∏ CSV —Ñ–∞–π–ª –ø—É—Å—Ç–æ–π –∏–ª–∏ –Ω–µ –∏–º–µ–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞
    """
    # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –ø—É—Ç–∏ –≤ Path –æ–±—ä–µ–∫—Ç—ã
    csv_file = Path(csv_path)
    json_file = Path(json_path)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ CSV —Ñ–∞–π–ª–∞
    if not csv_file.exists():
        raise FileNotFoundError(f"CSV —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: {csv_path}")
    
    # –ß–∏—Ç–∞–µ–º CSV —Ñ–∞–π–ª
    with csv_file.open('r', encoding='utf-8') as cf:
        reader = csv.DictReader(cf)
        
        # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —Å–ø–∏—Å–æ–∫
        data = list(reader)
    
    # –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    if not data:
        raise ValueError("CSV —Ñ–∞–π–ª –ø—É—Å—Ç–æ–π –∏–ª–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã—Ö")
    
    # –°–æ–∑–¥–∞–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø–∞–ø–∫–∏ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
    json_file.parent.mkdir(parents=True, exist_ok=True)
    
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º JSON
    with json_file.open('w', encoding='utf-8') as jf:
        json.dump(data, jf, ensure_ascii=False, indent=2)

```
**–í—ã–≤–æ–¥:**

![alt text](<images/lab05/csv-json.png>)

**–í—ã–≤–æ–¥:**

![alt text](<images/lab05/json-csv.png>)


**–§–∞–π–ª:** csv_xlsx.py

``` python
"""
–ú–æ–¥—É–ª—å –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ CSV –≤ XLSX —Ñ–æ—Ä–º–∞—Ç.
–õ–†5 ‚Äî JSON –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
"""

import csv
from pathlib import Path

# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º openpyxl (–≤–Ω–µ—à–Ω—è—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞)
try:
    from openpyxl import Workbook
    from openpyxl.utils import get_column_letter
except ImportError:
    raise ImportError("–î–ª—è —Ä–∞–±–æ—Ç—ã —ç—Ç–æ–≥–æ –º–æ–¥—É–ª—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ openpyxl: pip install openpyxl")


def csv_to_xlsx(csv_path: str, xlsx_path: str) -> None:
    """
    –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç CSV —Ñ–∞–π–ª –≤ XLSX —Ñ–æ—Ä–º–∞—Ç (Excel).
    
    –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–±–∏—Ä–∞–µ—Ç —à–∏—Ä–∏–Ω—É –∫–æ–ª–æ–Ω–æ–∫ –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É.
    
    Args:
        csv_path: –ü—É—Ç—å –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É CSV —Ñ–∞–π–ª—É
        xlsx_path: –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è XLSX —Ñ–∞–π–ª–∞
        
    Raises:
        FileNotFoundError: –ï—Å–ª–∏ CSV —Ñ–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        ValueError: –ï—Å–ª–∏ CSV —Ñ–∞–π–ª –ø—É—Å—Ç–æ–π
    """
    # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –ø—É—Ç–∏ –≤ Path –æ–±—ä–µ–∫—Ç—ã
    csv_file = Path(csv_path)
    xlsx_file = Path(xlsx_path)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ CSV —Ñ–∞–π–ª–∞
    if not csv_file.exists():
        raise FileNotFoundError(f"CSV —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: {csv_path}")
    
    # –ß–∏—Ç–∞–µ–º CSV —Ñ–∞–π–ª
    with csv_file.open('r', encoding='utf-8') as cf:
        reader = csv.reader(cf)
        rows = list(reader)
    
    # –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    if not rows:
        raise ValueError("CSV —Ñ–∞–π–ª –ø—É—Å—Ç–æ–π")
    
    # –°–æ–∑–¥–∞–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø–∞–ø–∫–∏ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
    xlsx_file.parent.mkdir(parents=True, exist_ok=True)
    
    # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –∫–Ω–∏–≥—É Excel
    workbook = Workbook()
    sheet = workbook.active
    sheet.title = "Sheet1"
    
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ CSV –≤ Excel
    for row in rows:
        sheet.append(row)
    
    # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∞–≤—Ç–æ-—à–∏—Ä–∏–Ω—É –∫–æ–ª–æ–Ω–æ–∫
    for column_cells in sheet.columns:
        # –ü–æ–ª—É—á–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É —Ç–µ–∫—Å—Ç–∞ –≤ –∫–æ–ª–æ–Ω–∫–µ
        max_length = 0
        column_letter = get_column_letter(column_cells[0].column)
        
        for cell in column_cells:
            try:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–ª–∏–Ω—É —Ç–µ–∫—Å—Ç–∞ –≤ —è—á–µ–π–∫–µ
                if len(str(cell.value)) > max_length:
                    max_length = len(str(cell.value))
            except:
                pass
        
        # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —à–∏—Ä–∏–Ω—É –∫–æ–ª–æ–Ω–∫–∏ (–º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤)
        adjusted_width = max(max_length + 2, 8)
        sheet.column_dimensions[column_letter].width = adjusted_width
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º XLSX —Ñ–∞–π–ª
    workbook.save(xlsx_file)

```
**–í—ã–≤–æ–¥:**

![alt text](<images/lab05/peoplexlsx.png>)

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏ –ø–∞–ø–æ–∫ –≤ —Å–∏—Å—Ç–µ–º–µ:**


![alt text](<images/lab05/x-.png>)


# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ6
# cli_convert:
``` python
# src/lab06/cli_convert.py
import argparse
import sys
from pathlib import Path

def main():
    parser = argparse.ArgumentParser(
        description="–ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É —Ñ–æ—Ä–º–∞—Ç–∞–º–∏ JSON, CSV, XLSX"
    )
    subparsers = parser.add_subparsers(dest="command", help="–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã")
    
    # json2csv –∫–æ–º–∞–Ω–¥–∞
    json2csv_parser = subparsers.add_parser("json2csv", help="–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å JSON –≤ CSV")
    json2csv_parser.add_argument("--in", dest="input", required=True, help="–í—Ö–æ–¥–Ω–æ–π JSON —Ñ–∞–π–ª")
    json2csv_parser.add_argument("--out", dest="output", required=True, help="–í—ã—Ö–æ–¥–Ω–æ–π CSV —Ñ–∞–π–ª")
    
    # csv2json –∫–æ–º–∞–Ω–¥–∞  
    csv2json_parser = subparsers.add_parser("csv2json", help="–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å CSV –≤ JSON")
    csv2json_parser.add_argument("--in", dest="input", required=True, help="–í—Ö–æ–¥–Ω–æ–π CSV —Ñ–∞–π–ª")
    csv2json_parser.add_argument("--out", dest="output", required=True, help="–í—ã—Ö–æ–¥–Ω–æ–π JSON —Ñ–∞–π–ª")
    
    # csv2xlsx –∫–æ–º–∞–Ω–¥–∞
    csv2xlsx_parser = subparsers.add_parser("csv2xlsx", help="–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å CSV –≤ XLSX")
    csv2xlsx_parser.add_argument("--in", dest="input", required=True, help="–í—Ö–æ–¥–Ω–æ–π CSV —Ñ–∞–π–ª")
    csv2xlsx_parser.add_argument("--out", dest="output", required=True, help="–í—ã—Ö–æ–¥–Ω–æ–π XLSX —Ñ–∞–π–ª")
    
    args = parser.parse_args()
    
    if not args.command:
        parser.print_help()
        return
    
    try:
        if args.command == "json2csv":
            from src.lab05.json_csv import json_to_csv
            json_to_csv(args.input, args.output)
            print(f"‚úÖ –£—Å–ø–µ—à–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω {args.input} ‚Üí {args.output}")
            
        elif args.command == "csv2json":
            from src.lab05.json_csv import csv_to_json
            csv_to_json(args.input, args.output)
            print(f"‚úÖ –£—Å–ø–µ—à–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω {args.input} ‚Üí {args.output}")
            
        elif args.command == "csv2xlsx":
            from src.lab05.csv_xlsx import csv_to_xlsx
            csv_to_xlsx(args.input, args.output)
            print(f"‚úÖ –£—Å–ø–µ—à–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω {args.input} ‚Üí {args.output}")
            
    except FileNotFoundError as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω - {e}")
        sys.exit(1)
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏: {e}")
        sys.exit(1)

if __name__ == "__main__":
    main()
    
```


# cli_text:
``` python
# src/lab06/cli_text.py
import argparse
import sys
from pathlib import Path

def read_and_tokenize(filepath: str):
    """
    –ß–∏—Ç–∞–µ—Ç —Ñ–∞–π–ª –∏ —Ä–∞–∑–±–∏–≤–∞–µ—Ç –Ω–∞ —Å–ª–æ–≤–∞ (—Ç–æ–∫–µ–Ω—ã).
    """
    with open(filepath, 'r', encoding='utf-8') as f:
        text = f.read()
    
    # –ü—Ä–∏–≤–æ–¥–∏–º –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É –∏ —Ä–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ —Å–ª–æ–≤–∞
    text = text.lower()
    # –£–±–∏—Ä–∞–µ–º –ø—É–Ω–∫—Ç—É–∞—Ü–∏—é –∏ —Ä–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ —Å–ª–æ–≤–∞
    import string
    for char in string.punctuation:
        text = text.replace(char, ' ')
    
    tokens = text.split()
    return tokens

def main():
    parser = argparse.ArgumentParser(
        description="–¢–µ–∫—Å—Ç–æ–≤—ã–µ —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ñ–∞–π–ª–æ–≤"
    )
    subparsers = parser.add_subparsers(dest="command", help="–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã")
    
    # cat –∫–æ–º–∞–Ω–¥–∞
    cat_parser = subparsers.add_parser("cat", help="–í—ã–≤–µ—Å—Ç–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞")
    cat_parser.add_argument("--input", required=True, help="–í—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª")
    cat_parser.add_argument("-n", action="store_true", help="–ù—É–º–µ—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫–∏")
    
    # stats –∫–æ–º–∞–Ω–¥–∞
    stats_parser = subparsers.add_parser("stats", help="–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —á–∞—Å—Ç–æ—Ç —Å–ª–æ–≤")
    stats_parser.add_argument("--input", required=True, help="–í—Ö–æ–¥–Ω–æ–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª")
    stats_parser.add_argument("--top", type=int, default=5, help="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–ø-—Å–ª–æ–≤")
    
    args = parser.parse_args()
    
    if not args.command:
        parser.print_help()
        return
    
    try:
        if args.command == "cat":
            with open(args.input, 'r', encoding='utf-8') as f:
                for i, line in enumerate(f, 1):
                    if args.n:
                        print(f"{i:4} {line}", end='')
                    else:
                        print(line, end='')
                        
        elif args.command == "stats":
            # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ lab03
            from src.lab03.text_stats import count_freq, top_n
            
            # –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª –∏ –ø–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω—ã
            tokens = read_and_tokenize(args.input)
            
            # –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —á–∞—Å—Ç–æ—Ç—É
            frequency = count_freq(tokens)
            
            # –ü–æ–ª—É—á–∞–µ–º —Ç–æ–ø-N —Å–ª–æ–≤
            top_words = top_n(frequency, args.top)
            
            print(f"–¢–æ–ø-{args.top} —Å–ª–æ–≤ –≤ —Ñ–∞–π–ª–µ {args.input}:")
            for word, count in top_words:
                print(f"  {word}: {count}")
                
    except FileNotFoundError:
        print(f"‚ùå –û—à–∏–±–∫–∞: —Ñ–∞–π–ª {args.input} –Ω–µ –Ω–∞–π–¥–µ–Ω")
        sys.exit(1)
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
        sys.exit(1)

if __name__ == "__main__":
    main()
```

# –¢–µ—Å—Ç—ã –∏ –≤—ã–≤–æ–¥—ã:

**–í—ã–≤–æ–¥ cli_csv2json:**

![alt text](<images/lab06/cli_csv2json.png>)

![alt text](<images/lab06/csv2json_pic.png>)

**–í—ã–≤–æ–¥ cli_csv2xlsx:**

![alt text](<images/lab06/cli_csv2xlsx.png>)

![alt text](<images/lab06/csv2xlsx_pic.png>)

**–í—ã–≤–æ–¥ cli_json2csv:**

![alt text](<images/lab06/cli_json2csv.png>)

![alt text](<images/lab06/json2csv_pic.png>)

**–í—ã–≤–æ–¥ cli_text_help:**

![alt text](<images/lab06/cli_text_h.png>)

**–í—ã–≤–æ–¥ cli_convert_help:**

![alt text](<images/lab06/help_convert.png>)

**–í—ã–≤–æ–¥ text_cat:**

![alt text](<images/lab06/text_cat.png>)

**–í—ã–≤–æ–¥ top_3, 5:**

![alt text](<images/lab06/top_3, 5.png>)


# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ7

# test_json_csv.py:
``` python
import pytest
import json
import csv
import sys
import os

# –î–æ–±–∞–≤–ª—è–µ–º –∫–æ—Ä–Ω–µ–≤—É—é –ø–∞–ø–∫—É –≤ –ø—É—Ç—å Python
sys.path.insert(0, os.path.abspath("."))

from src.lab05.json_csv import json_to_csv, csv_to_json


def test_json_to_csv_basic(tmp_path):
    """–¢–µ—Å—Ç –±–∞–∑–æ–≤–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ JSON ‚Üí CSV"""
    # –°–æ–∑–¥–∞—ë–º —Ç–µ—Å—Ç–æ–≤—ã–π JSON —Ñ–∞–π–ª
    json_path = tmp_path / "test.json"
    csv_path = tmp_path / "test.csv"

    test_data = [
        {"name": "–ê–Ω–Ω–∞", "age": 25, "city": "–ú–æ—Å–∫–≤–∞"},
        {"name": "–ü–µ—Ç—Ä", "age": 30, "city": "–°–ü–±"},
        {"name": "–ú–∞—Ä–∏—è", "age": 28, "city": "–ö–∞–∑–∞–Ω—å"},
    ]

    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º JSON
    json_path.write_text(
        json.dumps(test_data, ensure_ascii=False, indent=2), encoding="utf-8"
    )

    # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º
    json_to_csv(str(json_path), str(csv_path))

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    assert csv_path.exists()

    with open(csv_path, "r", encoding="utf-8") as f:
        reader = csv.DictReader(f)
        rows = list(reader)

    assert len(rows) == 3
    assert set(rows[0].keys()) == {"name", "age", "city"}
    assert rows[0]["name"] == "–ê–Ω–Ω–∞"
    assert rows[0]["age"] == "25"
    assert rows[0]["city"] == "–ú–æ—Å–∫–≤–∞"


def test_csv_to_json_basic(tmp_path):
    """–¢–µ—Å—Ç –±–∞–∑–æ–≤–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ CSV ‚Üí JSON"""
    # –°–æ–∑–¥–∞—ë–º —Ç–µ—Å—Ç–æ–≤—ã–π CSV —Ñ–∞–π–ª
    csv_path = tmp_path / "test.csv"
    json_path = tmp_path / "test.json"

    csv_content = """name,age,city
–ê–Ω–Ω–∞,25,–ú–æ—Å–∫–≤–∞
–ü–µ—Ç—Ä,30,–°–ü–±
–ú–∞—Ä–∏—è,28,–ö–∞–∑–∞–Ω—å"""

    csv_path.write_text(csv_content, encoding="utf-8")

    # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º
    csv_to_json(str(csv_path), str(json_path))

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    assert json_path.exists()

    with open(json_path, "r", encoding="utf-8") as f:
        data = json.load(f)

    assert len(data) == 3
    assert data[0] == {"name": "–ê–Ω–Ω–∞", "age": "25", "city": "–ú–æ—Å–∫–≤–∞"}
    assert data[1] == {"name": "–ü–µ—Ç—Ä", "age": "30", "city": "–°–ü–±"}


def test_json_to_csv_empty_list(tmp_path):
    """–¢–µ—Å—Ç –ø—É—Å—Ç–æ–≥–æ JSON —Å–ø–∏—Å–∫–∞"""
    json_path = tmp_path / "empty.json"
    csv_path = tmp_path / "empty.csv"

    json_path.write_text("[]", encoding="utf-8")

    # –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞
    with pytest.raises(ValueError, match=".*–ü—É—Å—Ç–æ–π.*|.*empty.*"):
        json_to_csv(str(json_path), str(csv_path))


def test_json_to_csv_invalid_json(tmp_path):
    """–¢–µ—Å—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ JSON"""
    json_path = tmp_path / "invalid.json"
    csv_path = tmp_path / "test.csv"

    json_path.write_text("{not valid json}", encoding="utf-8")

    with pytest.raises(ValueError, match=".*JSON.*"):
        json_to_csv(str(json_path), str(csv_path))


def test_csv_to_json_missing_file():
    """–¢–µ—Å—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–µ–≥–æ —Ñ–∞–π–ª–∞"""
    with pytest.raises(FileNotFoundError):
        csv_to_json("–Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π_—Ñ–∞–π–ª.csv", "output.json")


def test_json_to_csv_missing_file():
    """–¢–µ—Å—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–µ–≥–æ —Ñ–∞–π–ª–∞"""
    with pytest.raises(FileNotFoundError):
        json_to_csv("–Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π_—Ñ–∞–π–ª.json", "output.csv")


def test_json_to_csv_roundtrip(tmp_path):
    """–¢–µ—Å—Ç –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ JSON ‚Üí CSV ‚Üí JSON"""
    # –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    original_data = [{"name": "Test", "value": 123}, {"name": "Another", "value": 456}]

    # JSON ‚Üí CSV
    json_path = tmp_path / "original.json"
    csv_path = tmp_path / "converted.csv"
    json_path2 = tmp_path / "back.json"

    json_path.write_text(json.dumps(original_data), encoding="utf-8")
    json_to_csv(str(json_path), str(csv_path))

    # CSV ‚Üí JSON
    csv_to_json(str(csv_path), str(json_path2))

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –¥–∞–Ω–Ω—ã–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç
    with open(json_path2, "r", encoding="utf-8") as f:
        restored_data = json.load(f)

    # –í CSV –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç—Ä–æ–∫–æ–≤—ã–µ, –ø–æ—ç—Ç–æ–º—É —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º
    assert len(restored_data) == len(original_data)
    assert restored_data[0]["name"] == original_data[0]["name"]
    assert restored_data[0]["value"] == str(
        original_data[0]["value"]
    )  # CSV —Ö—Ä–∞–Ω–∏—Ç —Å—Ç—Ä–æ–∫–∏

```

# test_text.py:

``` python
import sys
import os

# –î–æ–±–∞–≤–ª—è–µ–º –∫–æ—Ä–Ω–µ–≤—É—é –ø–∞–ø–∫—É –≤ –ø—É—Ç—å Python
sys.path.insert(0, os.path.abspath("."))

from src.lab03.text_stats import count_freq, top_n


def test_count_freq_basic():
    """–¢–µ—Å—Ç –±–∞–∑–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–¥—Å—á—ë—Ç–∞ —á–∞—Å—Ç–æ—Ç"""
    tokens = ["apple", "banana", "apple", "cherry", "banana", "apple"]
    result = count_freq(tokens)

    assert result == {"apple": 3, "banana": 2, "cherry": 1}
    assert len(result) == 3
    assert result["apple"] == 3
    assert result["banana"] == 2
    assert result["cherry"] == 1


def test_count_freq_empty():
    """–¢–µ—Å—Ç –ø—É—Å—Ç–æ–≥–æ —Å–ø–∏—Å–∫–∞"""
    tokens = []
    result = count_freq(tokens)
    assert result == {}


def test_count_freq_single_word():
    """–¢–µ—Å—Ç –æ–¥–Ω–æ–≥–æ —Å–ª–æ–≤–∞"""
    tokens = ["hello"] * 5
    result = count_freq(tokens)
    assert result == {"hello": 5}


def test_top_n_basic():
    """–¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü–∏–∏ top_n"""
    freq = {"a": 5, "b": 3, "c": 10, "d": 1, "e": 7}
    result = top_n(freq, 3)

    assert result == [("c", 10), ("e", 7), ("a", 5)]
    assert len(result) == 3


def test_top_n_all():
    """–¢–µ—Å—Ç –∫–æ–≥–¥–∞ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã"""
    freq = {"a": 1, "b": 2, "c": 3}
    result = top_n(freq, 10)  # –±–æ–ª—å—à–µ —á–µ–º –µ—Å—Ç—å
    assert result == [("c", 3), ("b", 2), ("a", 1)]


def test_top_n_tie_breaker():
    """–¢–µ—Å—Ç –ø—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ —á–∞—Å—Ç–æ—Ç (—Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É)"""
    freq = {"z": 5, "a": 5, "m": 5, "b": 2}
    result = top_n(freq, 3)
    # –ü—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ —á–∞—Å—Ç–æ—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É
    assert result == [("a", 5), ("m", 5), ("z", 5)]


def test_top_n_zero_n():
    """–¢–µ—Å—Ç –∫–æ–≥–¥–∞ n=0"""
    freq = {"a": 1, "b": 2}
    result = top_n(freq, 0)
    assert result == []


def test_top_n_default():
    """–¢–µ—Å—Ç —Å default –∑–Ω–∞—á–µ–Ω–∏–µ–º n=5"""
    freq = {"a": 1, "b": 2, "c": 3, "d": 4, "e": 5, "f": 6}
    result = top_n(freq)  # default n=5
    assert len(result) == 5
    assert result[0] == ("f", 6)

```

# –¢–µ—Å—Ç—ã –∏ –≤—ã–≤–æ–¥—ã:

**–í—ã–≤–æ–¥—ã —Ç–µ—Å—Ç–æ–≤:**

![alt text](<images/lab07/test1.png>)

**–í—ã–≤–æ–¥ –∞–≤—Ç–æ—Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä–∞ black+black check:**

![alt text](<images/lab07/black-check.png>)

**–í—ã–≤–æ–¥—ã pyptoject.toml:**

![alt text](<images/lab07/toml.png>)