# python_labs
# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ1
# –í–≤–æ–¥/–≤—ã–≤–æ–¥ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Python

# –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã:
–û—Å–≤–æ–∏—Ç—å –±–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö, —Ä–∞–±–æ—Ç—É —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–≤–æ–¥–∞ –≤ Python.

# –ó–∞–¥–∞–Ω–∏–µ 1: –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –≤–æ–∑—Ä–∞—Å—Ç

**–§–∞–π–ª:** `src/lab01/ex.01.py`  

**–¶–µ–ª—å:** –†–∞–±–æ—Ç–∞ —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏ –∏ —Ü–µ–ª—ã–º–∏ —á–∏—Å–ª–∞–º–∏, –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è —Å—Ç—Ä–æ–∫.

**–í–≤–æ–¥:**
- –ò–º—è (—Å—Ç—Ä–æ–∫–∞)
- –í–æ–∑—Ä–∞—Å—Ç (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ)

**–í—ã–≤–æ–¥:**
![alt text](images/lab01/ex.01.png)

**–ü—Ä–∏–º–µ—Ä:**
–ò–º—è: –ê–ª–∏—Å–∞
–í–æ–∑—Ä–∞—Å—Ç: 19
–ü—Ä–∏–≤–µ—Ç, –ê–ª–∏—Å–∞! –ß–µ—Ä–µ–∑ –≥–æ–¥ —Ç–µ–±–µ –±—É–¥–µ—Ç 20.# –ó–∞–¥–∞–Ω–∏–µ 2: –°—É–º–º–∞ –∏ —Å—Ä–µ–¥–Ω–µ–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ

# –ó–∞–¥–∞–Ω–∏–µ 2: –°—É–º–º–∞ –∏ —Å—Ä–µ–¥–Ω–µ–µ

**–§–∞–π–ª:** `src/lab01/ex.02.py`  

**–¶–µ–ª—å:** –†–∞–±–æ—Ç–∞ —Å –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–≤–æ–¥–∞.

**–í–≤–æ–¥:**
- –î–≤–∞ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —á–∏—Å–ª–∞ (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ç–æ—á–∫–∞ –∏ –∑–∞–ø—è—Ç–∞—è)

**–í—ã–≤–æ–¥:**
![alt text](images/lab01/ex.02.png)

**–ü—Ä–∏–º–µ—Ä:**
a: 3,5
b: 4.25
sum=7.75; avg=3.88#   –ó–∞–¥–∞–Ω–∏–µ 3: –†–∞—Å—á–µ—Ç —á–µ–∫–∞ —Å–æ —Å–∫–∏–¥–∫–æ–π –∏ –ù–î–°

# –ó–∞–¥–∞–Ω–∏–µ 3 ‚Äî –ß–µ–∫: —Å–∫–∏–¥–∫–∞ –∏ –ù–î–°

**–§–∞–π–ª:** `src/lab01/ex.03.py`  

**–¶–µ–ª—å:** –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–æ—Ä–º—É–ª, —Å–ª–æ–∂–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–≤–æ–¥–∞.

**–§–æ—Ä–º—É–ª—ã:**
- `base = price * (1 - discount/100)`
- `vat_amount = base * (vat/100)`
- `total = base + vat_amount`

**–í–≤–æ–¥:**
- –¶–µ–Ω–∞ (–≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ)
- –°–∫–∏–¥–∫–∞ (%) (–≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ)
- –ù–î–° (%) (–≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ)

**–í—ã–≤–æ–¥:**
![alt text](images/lab01/ex.03.png)

**–ü—Ä–∏–º–µ—Ä:**
price (‚ÇΩ): 1000
discount (%): 10
vat (%): 20#   –ó–∞–¥–∞–Ω–∏–µ 4: –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –º–∏–Ω—É—Ç –≤ —á–∞—Å—ã –∏ –º–∏–Ω—É—Ç—ã

# –ó–∞–¥–∞–Ω–∏–µ 4 ‚Äî –ú–∏–Ω—É—Ç—ã ‚Üí –ß–ß:–ú–ú

**–§–∞–π–ª:** `src/lab01/ex.04.py`  

**–¶–µ–ª—å:** –†–∞–±–æ—Ç–∞ —Å —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–º –¥–µ–ª–µ–Ω–∏–µ–º, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏.

**–í–≤–æ–¥:**
- –ú–∏–Ω—É—Ç—ã (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ)

**–í—ã–≤–æ–¥:**
![alt text](images/lab01/ex.04.png)

**–ü—Ä–∏–º–µ—Ä:**
–ú–∏–Ω—É—Ç—ã: 135
2:15

#   –ó–∞–¥–∞–Ω–∏–µ 5: –ò–Ω–∏—Ü–∏–∞–ª—ã –∏ –¥–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫–∏


**–§–∞–π–ª:** `src/lab01/ex.05.py`
 
**–¶–µ–ª—å:** –†–∞–±–æ—Ç–∞ —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏, –º–µ—Ç–æ–¥–∞–º–∏ —Å—Ç—Ä–æ–∫, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.

**–í–≤–æ–¥:**

 –§–ò–û –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–æ–π (–º–æ–≥—É—Ç –±—ã—Ç—å –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã)

**–í—ã–≤–æ–¥:**

![alt text](images/lab01/ex.05.png)


**–ü—Ä–∏–º–µ—Ä:**

–§–ò–û: –•—É–∂–∞–º–æ–≤–∞ –¢–∞—Å–º–∏–Ω–∞ –ú—É–∑–∞—Ñ—Ñ–∞—Ä–æ–≤–Ω–∞
–ò–Ω–∏—Ü–∏–∞–ª—ã: –•–¢–ú.
–î–ª–∏–Ω–∞ (—Å–∏–º–≤–æ–ª–æ–≤): 29

## –ó–∞–¥–∞–Ω–∏—è —Å–æ –∑–≤–µ–∑–¥–æ—á–∫–æ–π

### –ó–∞–¥–∞–Ω–∏–µ 6*

**–§–∞–π–ª:** `src/lab01/ex.06.py`

**–¶–µ–ª—å:** –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö, —Ä–∞–±–æ—Ç–∞ —Å –±—É–ª–µ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏, –ø–æ–¥—Å—á–µ—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤.

**–í–≤–æ–¥:**
–°–Ω–∞—á–∞–ª–∞ —á–∏—Å–ª–æ N, –∑–∞—Ç–µ–º N —Å—Ç—Ä–æ–∫, –∫–∞–∂–¥–∞—è —Ñ–æ—Ä–º–∞—Ç–∞:
–§–∞–º–∏–ª–∏—è –ò–º—è –í–æ–∑—Ä–∞—Å—Ç –§–æ—Ä–º–∞—Ç_—É—á–∞—Å—Ç–∏—è

**–í—ã–≤–æ–¥:**
–î–≤–∞ —á–∏—Å–ª–∞ —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –æ—á–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∑–∞–æ—á–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞.

**–ü—Ä–∏–º–µ—Ä:**

**–í–≤–æ–¥:**
3

–ú–∞–∫—Å–∏–º–æ–≤ –ú–∞–∫—Å–∏–º 18 True

–ì–µ–Ω–Ω–∞–¥—å–µ–≤ –ì–µ–Ω–Ω–∞–¥–∏–π 17 False

–ê–ª–µ–∫—Å–µ–µ–≤ –ê–ª–µ–∫—Å–µ–π 17 True

**–í—ã–≤–æ–¥:**

![alt text](<images/lab01/ex.06.png>)

**–°—Ç—É–¥–µ–Ω—Ç:** –•—É–∂–∞–º–æ–≤–∞ –¢–∞—Å–º–∏–Ω–∞ –ú—É–∑–∞—Ñ—Ñ–∞—Ä–æ–≤–Ω–∞ 
**–ì—Ä—É–ø–ø–∞:** [–ë–ò–í–¢-25-4]  
**–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å:** []


# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ2
# –ö–æ–ª–ª–µ–∫—Ü–∏–∏ –∏ –º–∞—Ç—Ä–∏—Ü—ã (list/tuple/set/dict)
# –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã:
–û—Å–≤–æ–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ —Å–ø–∏—Å–∫–∞–º–∏, –∫–æ—Ä—Ç–µ–∂–∞–º–∏, –º–Ω–æ–∂–µ—Å—Ç–≤–∞–º–∏ –∏ —Å–ª–æ–≤–∞—Ä—è–º–∏. –ù–∞—É—á–∏—Ç—å—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å —Å 2D-—Å–ø–∏—Å–∫–∞–º–∏ (–º–∞—Ç—Ä–∏—Ü–∞–º–∏) ‚Äî —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, —Å—É–º–º—ã –ø–æ —Å—Ç—Ä–æ–∫–∞–º/—Å—Ç–æ–ª–±—Ü–∞–º. –ê–∫–∫—É—Ä–∞—Ç–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–µ–π (–Ω–∞ –ø—Ä–∏–º–µ—Ä–µ —Å—Ç—É–¥–µ–Ω—Ç–∞).

# –ó–∞–¥–∞–Ω–∏–µ 1: –û–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ —Å–ø–∏—Å–∫–∞–º–∏
**–§–∞–π–ª:** `src/lab02/ex.01.py`

``` python
def min_max(nums: list[float | int]) -> tuple[float | int, float | int]:
    """
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ç–µ–∂ (–º–∏–Ω–∏–º—É–º, –º–∞–∫—Å–∏–º—É–º) –∏–∑ —Å–ø–∏—Å–∫–∞ —á–∏—Å–µ–ª.

    Args:
        nums: –°–ø–∏—Å–æ–∫ —á–∏—Å–µ–ª (int –∏–ª–∏ float)

    Returns:
        –ö–æ—Ä—Ç–µ–∂ (min, max)

    Raises:
        ValueError: –ï—Å–ª–∏ —Å–ø–∏—Å–æ–∫ –ø—É—Å—Ç
    """
    if not nums:
        raise ValueError("–°–ø–∏—Å–æ–∫ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º")

    return min(nums), max(nums)


def unique_sorted(nums: list[float | int]) -> list[float | int]:
    """
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.

    Args:
        nums: –°–ø–∏—Å–æ–∫ —á–∏—Å–µ–ª (int –∏–ª–∏ float)

    Returns:
        –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
    """
    return sorted(set(nums))


def flatten(mat: list[list | tuple]) -> list:
    """
    "–†–∞—Å–ø–ª—é—â–∏–≤–∞–µ—Ç" —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤/–∫–æ—Ä—Ç–µ–∂–µ–π –≤ –æ–¥–∏–Ω —Å–ø–∏—Å–æ–∫.

    Args:
        mat: –°–ø–∏—Å–æ–∫, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Å–ø–∏—Å–∫–∏ –∏–ª–∏ –∫–æ—Ä—Ç–µ–∂–∏

    Returns:
        –û–¥–∏–Ω —Å–ø–∏—Å–æ–∫ —Å–æ –≤—Å–µ–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏

    Raises:
        TypeError: –ï—Å–ª–∏ –≤—Å—Ç—Ä–µ—Ç–∏–ª—Å—è —ç–ª–µ–º–µ–Ω—Ç, –Ω–µ —è–≤–ª—è—é—â–∏–π—Å—è —Å–ø–∏—Å–∫–æ–º –∏–ª–∏ –∫–æ—Ä—Ç–µ–∂–µ–º

    extend:
    —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã —Å–ø–∏—Å–∫–∞ –∏–ª–∏ –∫–æ—Ä—Ç–µ–∂–∞, 
    –¥–æ–±–∞–≤–ª—è—è –≤ —Å–ø–∏—Å–æ–∫ result –æ—Ç–¥–µ–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∫–∞–∂–¥–æ–≥–æ —Å–ø–∏—Å–∫–∞
    –º–æ–∂–Ω–æ –±—ã–ª–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å sublist –≤–æ—Ç —Ç–∞–∫:
    result = [item for sublist in mat for item in sublist], 
    –≥–¥–µ —á–∞—Å—Ç—å   for sublist in mat  –ø–µ—Ä–µ–±–∏—Ä–∞–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏/–∫–æ—Ä—Ç–µ–∂–∏, 
    –∞    for item in sublist   –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç

    isinstance:
    –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ item - —Å–ø–∏—Å–ª–∫ –∏–ª–∏ –∫–æ—Ä—Ç–µ–∂, –µ—Å–ª–∏ –Ω–µ—Ç, –≤—ã–≤–æ–¥–∏—Ç TypError

    """
    result = []
    for item in mat:
        if not isinstance(item, (list, tuple)):
            raise TypeError("–í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–ø–∏—Å–∫–∞–º–∏ –∏–ª–∏ –∫–æ—Ä—Ç–µ–∂–∞–º–∏")
        result.extend(item) 
    return result

# –¢–µ—Å—Ç 1: –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π —Å–ª—É—á–∞–π
print("min_max([3, -1, 5, 5, 0]):", min_max([3, -1, 5, 5, 0]))

# –¢–µ—Å—Ç 2:ValueError
try:
    print("min_max([]):", min_max([]))
except ValueError as e:
    print(f"min_max([]): ValueError - {e}")

# –¢–µ—Å—Ç 3: —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
print("unique_sorted([3, 1, 2, 1, 3]):", unique_sorted([3, 1, 2, 1, 3]))

# –¢–µ—Å—Ç 4: –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø–ª—é—â–∏–≤–∞–Ω–∏–µ
print("flatten([[1, 2], [3, 4]]):", flatten([[1, 2], [3, 4]]))

# –¢–µ—Å—Ç 5: TypeError
try:
    print("flatten([1, [3, 4]]):", flatten([1, [3, 4]]))
except TypeError as e:
    print(f"flatten([1, [3, 4]]): TypeError - {e}")
```

**–í—ã–≤–æ–¥**

![alt text](<images/lab02/ex.01.png>)


# –ó–∞–¥–∞–Ω–∏–µ 2: –û–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ —Å–ø–∏—Å–∫–∞–º–∏

**–¶–µ–ª—å:** –ü–æ–º–µ–Ω—è—Ç—å —Å—Ç—Ä–æ–∫–∏ –∏ —Å—Ç–æ–ª–±—Ü—ã –º–µ—Å—Ç–∞–º–∏. –ü—É—Å—Ç–∞—è –º–∞—Ç—Ä–∏—Ü–∞ [] ‚Üí [].
–ï—Å–ª–∏ –º–∞—Ç—Ä–∏—Ü–∞ ¬´—Ä–≤–∞–Ω–∞—è¬ª (—Å—Ç—Ä–æ–∫–∏ —Ä–∞–∑–Ω–æ–π –¥–ª–∏–Ω—ã) ‚Äî ValueError.

**–§–∞–π–ª:** `src/lab02/–∑–∞–¥–∞–Ω–∏–µ B.2.py`

``` python
def _validate_rectangular(mat: list[list[float | int]]) -> None:
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –º–∞—Ç—Ä–∏—Ü–∞ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∞—è (–≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –¥–ª–∏–Ω—ã).

    Args:
        mat: –ú–∞—Ç—Ä–∏—Ü–∞ (—Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤)

    Raises:
        ValueError: –ï—Å–ª–∏ –º–∞—Ç—Ä–∏—Ü–∞ —Ä–≤–∞–Ω–∞—è (—Å—Ç—Ä–æ–∫–∏ —Ä–∞–∑–Ω–æ–π –¥–ª–∏–Ω—ã)
    """
    if not mat:
        return []

    first_len = len(mat[0])
    for i, row in enumerate(mat):
        if len(row) != first_len:
            raise ValueError(f"–ú–∞—Ç—Ä–∏—Ü–∞ —Ä–≤–∞–Ω–∞—è: —Å—Ç—Ä–æ–∫–∞ {i} –∏–º–µ–µ—Ç –¥–ª–∏–Ω—É {len(row)}, –æ–∂–∏–¥–∞–ª–∞—Å—å {first_len}")


def transpose(mat: list[list[float | int]]) -> list[list[float | int]]:
    """
    –¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä—É–µ—Ç –º–∞—Ç—Ä–∏—Ü—É (–º–µ–Ω—è–µ—Ç —Å—Ç—Ä–æ–∫–∏ –∏ —Å—Ç–æ–ª–±—Ü—ã –º–µ—Å—Ç–∞–º–∏).

    Args:
        mat: –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞

    Returns:
        –¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞

    Raises:
        ValueError: –ï—Å–ª–∏ –º–∞—Ç—Ä–∏—Ü–∞ —Ä–≤–∞–Ω–∞—è
    """
    _validate_rectangular(mat)

    if not mat:
        return []

    return [[mat[i][j] for i in range(len(mat))] for j in range(len(mat[0]))]


def row_sums(mat: list[list[float | int]]) -> list[float]:
    """
    –í—ã—á–∏—Å–ª—è–µ—Ç —Å—É–º–º—ã –ø–æ —Å—Ç—Ä–æ–∫–∞–º –º–∞—Ç—Ä–∏—Ü—ã.

    Args:
        mat: –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞

    Returns:
        –°–ø–∏—Å–æ–∫ —Å—É–º–º –ø–æ —Å—Ç—Ä–æ–∫–∞–º

    Raises:
        ValueError: –ï—Å–ª–∏ –º–∞—Ç—Ä–∏—Ü–∞ —Ä–≤–∞–Ω–∞—è
    """
    _validate_rectangular(mat)

    return [sum(row) for row in mat]


def col_sums(mat: list[list[float | int]]) -> list[float]:
    """
    –í—ã—á–∏—Å–ª—è–µ—Ç —Å—É–º–º—ã –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º –º–∞—Ç—Ä–∏—Ü—ã.

    Args:
        mat: –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞

    Returns:
        –°–ø–∏—Å–æ–∫ —Å—É–º–º –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º

    Raises:
        ValueError: –ï—Å–ª–∏ –º–∞—Ç—Ä–∏—Ü–∞ —Ä–≤–∞–Ω–∞—è
    """
    _validate_rectangular(mat)

    if not mat:
        return []

    return [sum(mat[i][j] for i in range(len(mat))) for j in range(len(mat[0]))]

print("\n=== Matrix Tests ===")

# –¢–µ—Å—Ç 1: –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
print("transpose([[1, 2, 3]]):", transpose([[1, 2, 3]]))  # [[1], [2], [3]]

# –¢–µ—Å—Ç 2: —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–≤–∞–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã
try:
    print("transpose([[1, 2], [3]]):", transpose([[1, 2], [3]]))
except ValueError as e:
    print(f"transpose([[1, 2], [3]]): ValueError - {e}")

# –¢–µ—Å—Ç 3: —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É—Å—Ç–æ–π –º–∞—Ç—Ä–∏—Ü—ã
print("transpose([]):", transpose([]))  # []

# –¢–µ—Å—Ç 4: —Å—É–º–º—ã –ø–æ —Å—Ç—Ä–æ–∫–∞–º
print("row_sums([[1, 2, 3], [4, 5, 6]]):", row_sums([[1, 2, 3], [4, 5, 6]]))  # [6, 15]

# –¢–µ—Å—Ç 5: —Å—É–º–º—ã –ø–æ —Å—Ç—Ä–æ–∫–∞–º —Ä–≤–∞–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã
try:
    print("row_sums([[1, 2], [3]]):", row_sums([[1, 2], [3]]))
except ValueError as e:
    print(f"row_sums([[1, 2], [3]]): ValueError - {e}")

# –¢–µ—Å—Ç 6: —Å—É–º–º—ã –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º
print("col_sums([[1, 2, 3], [4, 5, 6]]):", col_sums([[1, 2, 3], [4, 5, 6]]))  # [5, 7, 9]

# –¢–µ—Å—Ç 7: —Å—É–º–º—ã –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º —Ä–≤–∞–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã
try:
    print("col_sums([[1, 2], [3]]):", col_sums([[1, 2], [3]]))
except ValueError as e:
    print(f"col_sums([[1, 2], [3]]): ValueError - {e}")

# –¢–µ—Å—Ç 8: –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã
print("transpose([[1, 2], [3, 4]]):", transpose([[1, 2], [3, 4]]))  # [[1, 3], [2, 4]]
print("row_sums([[-1, 1], [10, -10]]):", row_sums([[-1, 1], [10, -10]]))  # [0, 0]
print("col_sums([[-1, 1], [10, -10]]):", col_sums([[-1, 1], [10, -10]]))  # [9, -9]
```
**–í—ã–≤–æ–¥:**

![alt text](<images/lab02/ex.02.png>)
#   –ó–∞–¥–∞–Ω–∏–µ C: tuples.py

**–§–∞–π–ª:** `src/lab02/ex.03.py`

``` python
def format_record(rec: tuple[str, str, float]) -> str:
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –∑–∞–ø–∏—Å—å —Å—Ç—É–¥–µ–Ω—Ç–∞ –≤ —Å—Ç—Ä–æ–∫—É.

    Args:
        rec: –ö–æ—Ä—Ç–µ–∂ (–§–ò–û, –≥—Ä—É–ø–ø–∞, GPA)

    Returns:
        –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –≤–∏–¥–∞ "–§–∞–º–∏–ª–∏—è –ò.–û., –≥—Ä. –ì–†–£–ü–ü–ê, GPA X.XX"

    Raises:
        ValueError: –ï—Å–ª–∏ –§–ò–û –∏–ª–∏ –≥—Ä—É–ø–ø–∞ –ø—É—Å—Ç—ã–µ, –∏–ª–∏ GPA –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π
        TypeError: –ï—Å–ª–∏ –Ω–µ–≤–µ—Ä–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö
    """
    if not isinstance(rec, tuple) or len(rec) != 3:
        raise TypeError("–ó–∞–ø–∏—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∫–æ—Ä—Ç–µ–∂–µ–º –∏–∑ 3 —ç–ª–µ–º–µ–Ω—Ç–æ–≤")

    fio, group, gpa = rec

    if not isinstance(fio, str) or not isinstance(group, str) or not isinstance(gpa, (int, float)):
        raise TypeError("–ù–µ–≤–µ—Ä–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö: –æ–∂–∏–¥–∞–ª–∏—Å—å (str, str, float)")

    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –§–ò–û
    fio_clean = ' '.join(fio.split()).title()  # –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã –∏ –¥–µ–ª–∞–µ–º –∑–∞–≥–ª–∞–≤–Ω—ã–µ –±—É–∫–≤—ã
    fio_parts = fio_clean.split()

    if len(fio_parts) < 2:
        raise ValueError("–§–ò–û –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º —Ñ–∞–º–∏–ª–∏—é –∏ –∏–º—è")

    if not fio_clean or not group:
        raise ValueError("–§–ò–û –∏ –≥—Ä—É–ø–ø–∞ –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º–∏")

    if gpa < 0:
        raise ValueError("GPA –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º")

    # –§–æ—Ä–º–∏—Ä—É–µ–º –∏–Ω–∏—Ü–∏–∞–ª—ã
    surname = fio_parts[0]
    initials = '.'.join(name[0].upper() for name in fio_parts[1:]) + '.'

    # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º GPA —Å 2 –∑–Ω–∞–∫–∞–º–∏ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
    gpa_formatted = f"{gpa:.2f}"

    return f"{surname} {initials}, –≥—Ä. {group}, GPA {gpa_formatted}"
'''
print("\n=== Tuples Tests ===")
print(format_record(("–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á", "BIVT-25", 4.6)))  # "–ò–≤–∞–Ω–æ–≤ –ò.–ò., –≥—Ä. BIVT-25, GPA 4.60"
print(format_record(("–ü–µ—Ç—Ä–æ–≤ –ü—ë—Ç—Ä", "IKBO-12", 5.0)))  # "–ü–µ—Ç—Ä–æ–≤ –ü., –≥—Ä. IKBO-12, GPA 5.00"
'''
print("\n=== Tuples Tests ===")

# –¢–µ—Å—Ç 1: –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π —Å–ª—É—á–∞–π —Å –æ—Ç—á–µ—Å—Ç–≤–æ–º
try:
    result = format_record(("–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á", "BIVT-25", 4.6))
    print(f"format_record(('–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á', 'BIVT-25', 4.6)): {result}")
except Exception as e:
    print(f"format_record(('–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á', 'BIVT-25', 4.6)): {type(e).__name__} - {e}")

# –¢–µ—Å—Ç 2: –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π —Å–ª—É—á–∞–π –±–µ–∑ –æ—Ç—á–µ—Å—Ç–≤–∞
try:
    result = format_record(("–ü–µ—Ç—Ä–æ–≤ –ü—ë—Ç—Ä", "IKBO-12", 5.0))
    print(f"format_record(('–ü–µ—Ç—Ä–æ–≤ –ü—ë—Ç—Ä', 'IKBO-12', 5.0)): {result}")
except Exception as e:
    print(f"format_record(('–ü–µ—Ç—Ä–æ–≤ –ü—ë—Ç—Ä', 'IKBO-12', 5.0)): {type(e).__name__} - {e}")

# –¢–µ—Å—Ç 3: –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π —Å–ª—É—á–∞–π —Å –ª–∏—à–Ω–∏–º–∏ –ø—Ä–æ–±–µ–ª–∞–º–∏
try:
    result = format_record(("    —Ö—É–∂–∞–º–æ–≤–∞   —Ç–∞—Å–º–∏–Ω–∞   –º—É–∑–∞—Ñ—Ñ–∞—Ä–æ–≤–Ω–∞ ", "ABB-01", 3.999))
    print(f"format_record(('  —Ö—É–∂–∞–º–æ–≤–∞  —Ç–∞—Å–º–∏–Ω–∞  –º—É–∑–∞—Ñ—Ñ–∞—Ä–æ–≤–Ω–∞ ', 'ABB-01', 3.999)): {result}")
except Exception as e:
    print(f"format_record(('  —Ö—É–∂–∞–º–æ–≤–∞   —Ç–∞—Å–º–∏–Ω–∞   –º—É–∑–∞—Ñ—Ñ–∞—Ä–æ–≤–Ω–∞ ', 'ABB-01', 3.999)): {type(e).__name__} - {e}")

# –¢–µ—Å—Ç 4: –æ—à–∏–±–∫–∞ - –ø—É—Å—Ç–æ–µ –§–ò–û
try:
    result = format_record(("", "BIVT-25", 4.6))
    print(f"format_record(('', 'BIVT-25', 4.6)): {result}")
except Exception as e:
    print(f"format_record(('', 'BIVT-25', 4.6)): {type(e).__name__} - {e}")

# –¢–µ—Å—Ç 5: –æ—à–∏–±–∫–∞ - –ø—É—Å—Ç–∞—è –≥—Ä—É–ø–ø–∞
try:
    result = format_record(("–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω", "", 4.6))
    print(f"format_record(('–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω', '', 4.6)): {result}")
except Exception as e:
    print(f"format_record(('–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω', '', 4.6)): {type(e).__name__} - {e}")

# –¢–µ—Å—Ç 6: –æ—à–∏–±–∫–∞ - –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π GPA
try:
    result = format_record(("–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω", "BIVT-25", -1.0))
    print(f"format_record(('–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω', 'BIVT-25', -1.0)): {result}")
except Exception as e:
    print(f"format_record(('–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω', 'BIVT-25', -1.0)): {type(e).__name__} - {e}")

# –¢–µ—Å—Ç 7: –æ—à–∏–±–∫–∞ - —Ç–æ–ª—å–∫–æ —Ñ–∞–º–∏–ª–∏—è
try:
    result = format_record(("–ò–≤–∞–Ω–æ–≤", "BIVT-25", 4.6))
    print(f"format_record(('–ò–≤–∞–Ω–æ–≤', 'BIVT-25', 4.6)): {result}")
except Exception as e:
    print(f"format_record(('–ò–≤–∞–Ω–æ–≤', 'BIVT-25', 4.6)): {type(e).__name__} - {e}")


# –¢–µ—Å—Ç 8: –æ—à–∏–±–∫–∞ - –Ω–µ–≤–µ—Ä–Ω—ã–π —Ç–∏–ø GPA
try:
    result = format_record(("–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω", "BIVT-25", "4.6"))
    print(f"format_record(('–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω', 'BIVT-25', '4.6')): {result}")
except Exception as e:
    print(f"format_record(('–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω', 'BIVT-25', '4.6')): {type(e).__name__} - {e}")

# –¢–µ—Å—Ç 9: –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π —Å–ª—É—á–∞–π —Å –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ–º GPA
try:
    result = format_record(("–•—É–∂–∞–º–æ–≤–∞ –¢–∞—Å–º–∏–Ω–∞", "IKBO-10", 3.456))
    print(f"format_record(('–•—É–∂–∞–º–æ–≤–∞ –¢–∞—Å–º–∏–Ω–∞', 'IKBO-10', 3.456)): {result}")
except Exception as e:
    print(f"format_record(('–•—É–∂–∞–º–æ–≤–∞ –¢–∞—Å–º–∏–Ω–∞', 'IKBO-10', 3.456)): {type(e).__name__} - {e}")
```

**–í—ã–≤–æ–¥:**

![alt text](<images/lab02/ex.03.png>)
**–°—Ç—É–¥–µ–Ω—Ç:** –•—É–∂–∞–º–æ–≤–∞ –¢–∞—Å–º–∏–Ω–∞ –ú—É–∑–∞—Ñ—Ñ–∞—Ä–æ–≤–Ω–∞
**–ì—Ä—É–ø–ø–∞:** [–ë–ò–í–¢-25-4]  
**–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å:** [–ó–∞–º—É—Ä–∞–≥–∏–Ω –ò.–ú.]


# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ3
## –¢–µ–∫—Å—Ç—ã –∏ —á–∞—Å—Ç–æ—Ç—ã —Å–ª–æ–≤ (—Å–ª–æ–≤–∞—Ä—å/–º–Ω–æ–∂–µ—Å—Ç–≤–æ)
## –¶–µ–ª—å: 
–ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç, –∞–∫–∫—É—Ä–∞—Ç–Ω–æ —Ç–æ–∫–µ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å, –ø–æ—Å—á–∏—Ç–∞—Ç—å —á–∞—Å—Ç–æ—Ç—ã —Å–ª–æ–≤ –∏ –≤—ã–≤–µ—Å—Ç–∏ —Ç–æ–ø-N.

## –ó–∞–¥–∞–Ω–∏–µ A (1.normalaize, 2.tokenize, 3.count_freq, 4.top_n):

**–§–∞–π–ª:** `src/lab03/normalaize.py`

```python
def normalize(text: str, *, casefold: bool = True, yo2e: bool = True) -> str:
    """
    –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç —Ç–µ–∫—Å—Ç: –ø—Ä–∏–≤–æ–¥–∏—Ç —Ä–µ–≥–∏—Å—Ç—Ä, –∑–∞–º–µ–Ω—è–µ—Ç —ë –Ω–∞ –µ, —É–±–∏—Ä–∞–µ—Ç –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã.
    
    Args:
        text: –ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç
        casefold: –ü—Ä–∏–≤–æ–¥–∏—Ç—å –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é True)
        yo2e: –ó–∞–º–µ–Ω—è—Ç—å —ë/–Å –Ω–∞ –µ/–ï (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é True)
        
    Returns:
        –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
    """
    if casefold==True:
        text=text.casefold()

    if yo2e==True:
        text=text.replace("—ë","–µ").replace("–Å","–ï")

    for char in ['\t', '\r', '\n']:
        text = text.replace(char, ' ')
        
    text=text.split()
    text=" ".join(text)
    return text

print("=== –¢–µ—Å—Ç—ã —Ç–µ–∫—Å—Ç–∞ ===")
texts = [
    "Hello\r\nWorld",
    "–ü—Ä–ò–≤–ï—Ç\n–ú–ò—Ä\t", 
    "—ë–∂–∏–∫, –Å–ª–∫–∞",
    "  –¥–≤–æ–π–Ω—ã–µ   –ø—Ä–æ–±–µ–ª—ã  ",
    "–ø—Ä–∏–≤–µ—Ç, –º–∏—Ä! –∫–∞–∫ –¥–µ–ª–∞?"
]

for text in texts:
    result = normalize(text)
    print(result)
```

**–í—ã–≤–æ–¥:** 

![alt text](<images/lab03/1_normalaize.png>)


**–§–∞–π–ª:** `src/lab03/tokenize.py`

``` python
import re


def tokenize(text: str) -> list[str]:
    """
    –†–∞–∑–±–∏–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç –Ω–∞ —Å–ª–æ–≤–∞ (—Ç–æ–∫–µ–Ω—ã).

    –ù–∞—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±—É–∫–≤, —Ü–∏—Ñ—Ä, –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–π,
    –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –¥–µ—Ñ–∏—Å—ã –≤–Ω—É—Ç—Ä–∏ —Å–ª–æ–≤.

    Args:
        text: –¢–µ–∫—Å—Ç –¥–ª—è —Ä–∞–∑–±–∏–µ–Ω–∏—è –Ω–∞ —Å–ª–æ–≤–∞

    Returns:
        –°–ø–∏—Å–æ–∫ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤
    """
    # –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–ª–æ–≤
    # [\w]+    - –æ–¥–Ω–∞ –∏–ª–∏ –±–æ–ª—å—à–µ –±—É–∫–≤/—Ü–∏—Ñ—Ä/–ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–π
    # (?:-[\w]+)* - –Ω–æ–ª—å –∏–ª–∏ –±–æ–ª—å—à–µ –ø–æ–≤—Ç–æ—Ä–æ–≤: –¥–µ—Ñ–∏—Å + –±—É–∫–≤—ã/—Ü–∏—Ñ—Ä—ã
    pattern = r"[\w]+(?:-[\w]+)*"

    # –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Å —à–∞–±–ª–æ–Ω–æ–º
    tokens = re.findall(pattern, text)

    return tokens

print("=== –¢–µ—Å—Ç—ã —Ç–µ–∫—Å—Ç–∞ ===")
texts = [
    "–ø—Ä–∏–≤–µ—Ç –º–∏—Ä",
    "hello,world!!!", 
    "–ø–æ-–Ω–∞—Å—Ç–æ—è—â–µ–º—É –∫—Ä—É—Ç–æ",
    "2025 –≥–æ–¥",
    "emoji üêà‚Äç‚¨õ –Ω–µ —Å–ª–æ–≤–æ"
]

for text in texts:
    result = tokenize(text)
    print(result)
```

**–í—ã–≤–æ–¥:** 

![alt text](<images/lab03/2_tokenize.png>)

**–§–∞–π–ª:** `src/lab02/–∑–∞–¥–∞–Ω–∏–µ B.3.py`

``` python


def count_freq(tokens: list[str]) -> dict[str, int]:
    """
    –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –∫–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ.

    Args:
        tokens: –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤ –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞

    Returns:
        –°–ª–æ–≤–∞—Ä—å, –≥–¥–µ –∫–ª—é—á - —Å–ª–æ–≤–æ, –∑–Ω–∞—á–µ–Ω–∏–µ - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ö–æ–∂–¥–µ–Ω–∏–π

    Examples:
        >>> count_freq(["—è–±–ª–æ–∫–æ", "–±–∞–Ω–∞–Ω", "—è–±–ª–æ–∫–æ"])
        {'—è–±–ª–æ–∫–æ': 2, '–±–∞–Ω–∞–Ω': 1}

        >>> count_freq(["–¥–∞", "–Ω–µ—Ç", "–¥–∞", "–º–æ–∂–µ—Ç –±—ã—Ç—å"])
        {'–¥–∞': 2, '–Ω–µ—Ç': 1, '–º–æ–∂–µ—Ç –±—ã—Ç—å': 1}
    """
    # –°–æ–∑–¥–∞–µ–º –ø—É—Å—Ç–æ–π —Å–ª–æ–≤–∞—Ä—å –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    frequency_dict = {}

    # –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –∫–∞–∂–¥–æ–º—É —Å–ª–æ–≤—É –≤ —Å–ø–∏—Å–∫–µ
    for word in tokens:
        if word not in frequency_dict:
            # –ï—Å–ª–∏ —Å–ª–æ–≤–∞ –µ—â–µ –Ω–µ—Ç - –¥–æ–±–∞–≤–ª—è–µ–º —Å–æ —Å—á–µ—Ç—á–∏–∫–æ–º 1
            frequency_dict[word] = 1
        else:
            # –ï—Å–ª–∏ —Å–ª–æ–≤–æ —É–∂–µ –µ—Å—Ç—å - —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –Ω–∞ 1
            frequency_dict[word] += 1

    return frequency_dict

def top_n(freq: dict[str, int], n: int = 5) -> list[tuple[str, int]]: 
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç n –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–∏—Ö—Å—è 
    —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–∑ —Å–ª–æ–≤–∞—Ä—è —á–∞—Å—Ç–æ—Ç.

    Args:
        freq: –°–ª–æ–≤–∞—Ä—å, –≥–¥–µ –∫–ª—é—á–∏ - —ç—Ç–æ —ç–ª–µ–º–µ–Ω—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–æ–≤–∞), 
        –∞ –∑–Ω–∞—á–µ–Ω–∏—è - –∏—Ö —á–∞—Å—Ç–æ—Ç–∞ –≤—Å—Ç—Ä–µ—á–∞–µ–º–æ—Å—Ç–∏

        n: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∞–º—ã—Ö —á–∞—Å—Ç–æ–≤—Å—Ç—Ä–µ—á–∞—é—â–∏—Ö—Å—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å.
        –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞–≤–Ω–æ 5.

    Returns:
        list[tuple[str, int]]: –°–ø–∏—Å–æ–∫ –∏–∑ `n` –∫–æ—Ä—Ç–µ–∂–µ–π, 
        –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–¥–µ—Ä–∂–∏—Ç —ç–ª–µ–º–µ–Ω—Ç
        (—Å—Ç—Ä–æ–∫—É) –∏ –µ–≥–æ —á–∞—Å—Ç–æ—Ç—É (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ), 
        –æ—Ç—Å—Ä–æ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤ –ø–æ—Ä—è–¥–∫–µ —É–±—ã–≤–∞–Ω–∏—è —á–∞—Å—Ç–æ—Ç—ã.
    
    """
    # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Å–ª–æ–≤–∞—Ä—å –≤ —Å–ø–∏—Å–æ–∫ –∫–æ—Ä—Ç–µ–∂–µ–π
    items = list(freq.items())

    # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é —á–∞—Å—Ç–æ—Ç—ã, –ø—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ - –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É.lambda - –∫–ª—é—á –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ —á–∞—Å—Ç–æ—Ç–µ–± 
    sorted_items = sorted(items,  key=lambda x: (-x[1], x[0]))

    # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–µ—Ä–≤—ã–µ n —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    return sorted_items[:n]

print("=== –¢–µ—Å—Ç—ã —Å–ø–∏—Å–∫–∞/—Å–ª–æ–≤–∞—Ä—è ‚Ññ1===")
tokens = ["a","b","a","c","b","a"]
result_for_count=count_freq(tokens)
result_for_top=top_n(result_for_count, n=2)
print("–°–ª–æ–≤–∞—Ä—å —á–∞—Å—Ç–æ—Ç:", result_for_count)
print("–¢–æ–ø-2 —Å–ª–æ–≤:", result_for_top)


print("=== –¢–µ—Å—Ç—ã —Å–ø–∏—Å–∫–∞/—Å–ª–æ–≤–∞—Ä—è ‚Ññ2===")
tokens = ["bb","aa","bb","aa","cc"]
result_for_count=count_freq(tokens)
result_for_top=top_n(result_for_count, n=2)
print("–°–ª–æ–≤–∞—Ä—å —á–∞—Å—Ç–æ—Ç:", result_for_count)
print("–¢–æ–ø-2 —Å–ª–æ–≤:", result_for_top)

```

**–í—ã–≤–æ–¥:**

![alt text](<images/lab03/3_count_freq.png>)

# –ó–∞–¥–∞–Ω–∏–µ test_stats

# –í–≤–æ–¥:

``` python
#!/usr/bin/env python3
"""
text_stats.py - —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
–õ–†3 ‚Äî –¢–µ–∫—Å—Ç—ã –∏ —á–∞—Å—Ç–æ—Ç—ã —Å–ª–æ–≤
–°—Ç—É–¥–µ–Ω—Ç: –•—É–∂–∞–º–æ–≤–∞ –¢–∞—Å–º–∏–Ω–∞ –ú—É–∑–∞—Ñ—Ñ–∞—Ä–æ–≤–Ω–∞
–ì—Ä—É–ø–ø–∞: –ë–ò–í–¢-25-4
"""

import sys
import os

# –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Ç—å –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ –Ω–∞—à–∏—Ö –º–æ–¥—É–ª–µ–π
sys.path.append(os.path.join(os.path.dirname(__file__), '..', 'lib'))

# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –Ω–∞—à–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
from text import normalize, tokenize, count_freq, top_n


def text_stats(text: str, table_mode: bool = False) -> None:
    """
    –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç –∏ –≤—ã–≤–æ–¥–∏—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Å–ª–æ–≤–∞–º.
    
    Args:
        text: –ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
        table_mode: –ï—Å–ª–∏ True, –≤—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –≤–∏–¥–µ —Ç–∞–±–ª–∏—Ü—ã
    """
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ç–µ–∫—Å—Ç –Ω–µ –ø—É—Å—Ç–æ–π
    if not text or not text.strip():
        print("–û—à–∏–±–∫–∞: —Ç–µ–∫—Å—Ç –ø—É—Å—Ç–æ–π –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–æ–±–µ–ª—ã")
        return
    
    # 1. –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º —Ç–µ–∫—Å—Ç (–ø—Ä–∏–≤–æ–¥–∏–º –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É, —É–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã)
    norm_text = normalize(text)
    
    # 2. –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞ (—Ç–æ–∫–µ–Ω—ã)
    tokens = tokenize(norm_text)
    
    # 3. –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —á–∞—Å—Ç–æ—Ç—É –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞
    freq = count_freq(tokens)
    
    # 4. –ü–æ–ª—É—á–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    total_words = len(tokens)
    unique_words = len(freq)
    top_words = top_n(freq, n=5)
    
    # 5. –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    print(f'–í—Å–µ–≥–æ —Å–ª–æ–≤: {total_words}')
    print(f'–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤: {unique_words}')
    print('–¢–æ–ø-5:')
    
    if table_mode:
        print_table_output(top_words)
    else:
        print_simple_output(top_words)


def print_simple_output(top_words):
    """
    –ü—Ä–æ—Å—Ç–æ–π –≤—ã–≤–æ–¥ —Ç–æ–ø-—Å–ª–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ '—Å–ª–æ–≤–æ:—á–∞—Å—Ç–æ—Ç–∞'
    
    Args:
        top_words: –°–ø–∏—Å–æ–∫ –∫–æ—Ä—Ç–µ–∂–µ–π (—Å–ª–æ–≤–æ, —á–∞—Å—Ç–æ—Ç–∞)
    """
    for word, count in top_words:
        print(f'{word}:{count}')


def print_table_output(top_words):
    """
    –ö—Ä–∞—Å–∏–≤–æ –≤—ã—Ä–æ–≤–Ω–µ–Ω–Ω—ã–π —Ç–∞–±–ª–∏—á–Ω—ã–π –≤—ã–≤–æ–¥
    
    Args:
        top_words: –°–ø–∏—Å–æ–∫ –∫–æ—Ä—Ç–µ–∂–µ–π (—Å–ª–æ–≤–æ, —á–∞—Å—Ç–æ—Ç–∞)
    """
    if not top_words:
        print("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è")
        return
    
    # –ù–∞—Ö–æ–¥–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É —Å–ª–æ–≤–∞ –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è
    max_word_len = max(len(word) for word, _ in top_words)
    
    # –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã
    header = "—Å–ª–æ–≤–æ".ljust(max_word_len) + " | —á–∞—Å—Ç–æ—Ç–∞"
    separator = "-" * len(header)
    
    print(header)
    print(separator)
    
    # –í—ã–≤–æ–¥–∏–º –¥–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
    for word, count in top_words:
        print(f"{word.ljust(max_word_len)} | {count}")


def get_input_text():
    """
    –ü–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—Å—Ç –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ä–∞–∑–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏
    
    Returns:
        –í–≤–µ–¥–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
    """
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –≤ stdin (pipe –∏–ª–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)
    if not sys.stdin.isatty():  # –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ pipe –∏–ª–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
        return sys.stdin.read().strip()
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
    if len(sys.argv) > 1 and not sys.argv[1].startswith('--'):
        # –ß–∏—Ç–∞–µ–º –∏–∑ —Ñ–∞–π–ª–∞: python text_stats.py filename.txt
        try:
            with open(sys.argv[1], 'r', encoding='utf-8') as f:
                return f.read()
        except FileNotFoundError:
            print(f"–û—à–∏–±–∫–∞: —Ñ–∞–π–ª {sys.argv[1]} –Ω–µ –Ω–∞–π–¥–µ–Ω")
            return None
    else:
        # –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤–≤–æ–¥
        print("–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫):")
        print("–î–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤–≤–æ–¥–∞ –Ω–∞–∂–º–∏—Ç–µ Ctrl+D (Linux/Mac) –∏–ª–∏ Ctrl+Z (Windows):")
        
        try:
            return sys.stdin.read().strip()
        except EOFError:
            print("\n–í–≤–æ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω.")
            return None


def main():
    """
    –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è - –ø–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—Å—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –∞–Ω–∞–ª–∏–∑
    """
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤–∫–ª—é—á–µ–Ω –ª–∏ —Ç–∞–±–ª–∏—á–Ω—ã–π —Ä–µ–∂–∏–º
    table_mode = '--table' in sys.argv or os.getenv('TEXT_STATS_TABLE', '0') == '1'
    
    # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç
    text = get_input_text()
    
    if not text:
        print("–û—à–∏–±–∫–∞: —Ç–µ–∫—Å—Ç –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º")
        return
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∞–ª–∏–∑
    text_stats(text, table_mode)


if __name__ == '__main__':
    main()
```

# –í—ã–≤–æ–¥

![alt text](<images/lab03/test_stats.png>)


# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ4
## –∑–∞–¥–∞–Ω–∏–µ –ê

**–§–∞–π–ª text_report:**
``` python
#!/usr/bin/env python3
"""
text_report.py - —Å–∫—Ä–∏–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–æ–≤ –ø–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ
–õ–†4 ‚Äî –§–∞–π–ª—ã: TXT/CSV –∏ –æ—Ç—á—ë—Ç—ã

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã: –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –∫–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è,
–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ CSV —Ñ–∞–π–ª. –¢–∞–∫–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ –∫–æ–Ω—Å–æ–ª–∏.

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
    python src/lab04/text_report.py                    # –ë–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è
    python src/lab04/text_report.py --table            # –° –∫—Ä–∞—Å–∏–≤–æ–π —Ç–∞–±–ª–∏—Ü–µ–π
    python src/lab04/text_report.py --input my.txt     # –°–≤–æ–∏ —Ñ–∞–π–ª—ã
"""

# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–æ–¥—É–ª–∏ Python
import sys        # –î–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ (–≤—ã—Ö–æ–¥ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã)
import argparse   # –î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ (--input, --output –∏ —Ç.–¥.)
from pathlib import Path  # –î–ª—è —É–¥–æ–±–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –ø—É—Ç—è–º–∏ —Ñ–∞–π–ª–æ–≤ –∏ –ø–∞–ø–æ–∫

"""
–í–ù–ò–ú–ê–ù–ò–ï: —Å–ª–µ–¥—É—é—â–∏–π –±–ª–æ–∫ –∫–æ–¥–∞ –Ω—É–∂–µ–Ω —á—Ç–æ–±—ã Python –º–æ–≥ –Ω–∞–π—Ç–∏ –Ω–∞—à–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏
–≤ –ø–∞–ø–∫–µ src/lib/ –∏ src/lab04/
"""
# –ü–æ–ª—É—á–∞–µ–º –ø—É—Ç—å –∫ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –ø–∞–ø–∫–µ (src/) –∏ –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –≤ sys.path
# –≠—Ç–æ –Ω—É–∂–Ω–æ —á—Ç–æ–±—ã –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—à–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏
sys.path.append(str(Path(__file__).parent.parent))

# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –Ω–∞—à–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–æ–≤
from lib.text import normalize, tokenize, count_freq, top_n        # –§—É–Ω–∫—Ü–∏–∏ –∏–∑ –õ–†3 –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–µ–∫—Å—Ç–æ–º
from lab04.io_txt_csv import read_text, write_csv                 # –§—É–Ω–∫—Ü–∏–∏ –∏–∑ —ç—Ç–æ–π –õ–† –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏


def print_table_output(top_words: list[tuple[str, int]]) -> None:
    """
    –í—ã–≤–æ–¥–∏—Ç –∫—Ä–∞—Å–∏–≤—É—é —Ç–∞–±–ª–∏—Ü—É —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –≤ –∫–æ–Ω—Å–æ–ª—å.
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –±–µ—Ä–µ—Ç —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤ —Å —á–∞—Å—Ç–æ—Ç–∞–º–∏ –∏ –≤—ã–≤–æ–¥–∏—Ç –∏—Ö –≤ –≤–∏–¥–µ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
    —Å –≤—ã—Ä–æ–≤–Ω–µ–Ω–Ω—ã–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏.
    
    Args:
        top_words (list[tuple[str, int]]): –°–ø–∏—Å–æ–∫ –∫–æ—Ä—Ç–µ–∂–µ–π –≤ —Ñ–æ—Ä–º–∞—Ç–µ (—Å–ª–æ–≤–æ, —á–∞—Å—Ç–æ—Ç–∞)
            –ü—Ä–∏–º–µ—Ä: [('–ø—Ä–∏–≤–µ—Ç', 2), ('–º–∏—Ä', 1), ('—Ç–µ–∫—Å—Ç', 1)]
    
    Returns:
        None: –§—É–Ω–∫—Ü–∏—è —Ç–æ–ª—å–∫–æ –ø–µ—á–∞—Ç–∞–µ—Ç –≤ –∫–æ–Ω—Å–æ–ª—å, –Ω–∏—á–µ–≥–æ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç
    
    –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
        —Å–ª–æ–≤–æ      | —á–∞—Å—Ç–æ—Ç–∞
        -------------------
        –ø—Ä–∏–≤–µ—Ç     | 2
        –º–∏—Ä        | 1
        —Ç–µ–∫—Å—Ç      | 1
    """
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—ã–≤–æ–¥–∞
    if not top_words:
        print("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è")
        return
    
    """
    –®–∞–≥ 1: –ù–∞—Ö–æ–¥–∏–º —Å–∞–º—É—é –¥–ª–∏–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö —Å–ª–æ–≤
    –≠—Ç–æ –Ω—É–∂–Ω–æ —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –∫—Ä–∞—Å–∏–≤—É—é —Ç–∞–±–ª–∏—Ü—É —Å —Ä–æ–≤–Ω—ã–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏
    """
    # –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –≤—Å–µ–º —Å–ª–æ–≤–∞–º –∏ –Ω–∞—Ö–æ–¥–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É
    max_word_len = max(len(word) for word, _ in top_words)
    
    """
    –®–∞–≥ 2: –°–æ–∑–¥–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã
    ljust() –¥–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–æ–±–µ–ª—ã —Å–ø—Ä–∞–≤–∞ –¥–æ –Ω—É–∂–Ω–æ–π –¥–ª–∏–Ω—ã, —á—Ç–æ–±—ã –≤—ã—Ä–æ–≤–Ω—è—Ç—å —Ç–µ–∫—Å—Ç
    """
    header = "—Å–ª–æ–≤–æ".ljust(max_word_len) + " | —á–∞—Å—Ç–æ—Ç–∞"
    
    # –°–æ–∑–¥–∞–µ–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å–Ω—É—é –ª–∏–Ω–∏—é –ø–æ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º
    separator = "-" * len(header)  # –°—Ç—Ä–æ–∫–∞ –∏–∑ —Å–∏–º–≤–æ–ª–æ–≤ '-' —Ç–æ–π –∂–µ –¥–ª–∏–Ω—ã —á—Ç–æ –∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫
    
    """
    –®–∞–≥ 3: –í—ã–≤–æ–¥–∏–º —Ç–∞–±–ª–∏—Ü—É
    """
    print(header)      # –ó–∞–≥–æ–ª–æ–≤–æ–∫: "—Å–ª–æ–≤–æ      | —á–∞—Å—Ç–æ—Ç–∞"
    print(separator)   # –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å: "-------------------"
    
    # –í—ã–≤–æ–¥–∏–º –∫–∞–∂–¥—É—é —Å—Ç—Ä–æ–∫—É –¥–∞–Ω–Ω—ã—Ö
    for word, count in top_words:
        # ljust() –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Å–ª–æ–≤–æ –ø–æ –ª–µ–≤–æ–º—É –∫—Ä–∞—é, –¥–æ–±–∞–≤–ª—è—è –ø—Ä–æ–±–µ–ª—ã —Å–ø—Ä–∞–≤–∞
        print(f"{word.ljust(max_word_len)} | {count}")


def analyze_text(text: str) -> tuple[int, int, list[tuple[str, int]]]:
    """
    –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Å–ª–æ–≤–∞–º.
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —è–≤–ª—è–µ—Ç—Å—è "—Å–µ—Ä–¥—Ü–µ–º" –ø—Ä–æ–≥—Ä–∞–º–º—ã - –æ–Ω–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ–∫—Å—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç
    –≤—Å—é –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É: –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤,
    –∏ —Å–ø–∏—Å–æ–∫ —Å–∞–º—ã—Ö —á–∞—Å—Ç—ã—Ö —Å–ª–æ–≤.
    
    Args:
        text (str): –ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
        
    Returns:
        tuple: –ö–æ—Ä—Ç–µ–∂ –∏–∑ —Ç—Ä–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤:
            - total_words (int): –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤ –≤ —Ç–µ–∫—Å—Ç–µ
            - unique_words (int): –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤ (–±–µ–∑ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π)
            - top_words (list): –°–ø–∏—Å–æ–∫ –∫–æ—Ä—Ç–µ–∂–µ–π (—Å–ª–æ–≤–æ, —á–∞—Å—Ç–æ—Ç–∞) –¥–ª—è —Ç–æ–ø-5 —Å–ª–æ–≤
    
    –ü—Ä–æ—Ü–µ—Å—Å –∞–Ω–∞–ª–∏–∑–∞:
        1. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è: –ø—Ä–∏–≤–æ–¥–∏–º —Ç–µ–∫—Å—Ç –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É, —É–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
        2. –¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è: —Ä–∞–∑–±–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞
        3. –ü–æ–¥—Å—á–µ—Ç —á–∞—Å—Ç–æ—Ç: —Å—á–∏—Ç–∞–µ–º —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –∫–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è
        4. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: –Ω–∞—Ö–æ–¥–∏–º 5 —Å–∞–º—ã—Ö —á–∞—Å—Ç—ã—Ö —Å–ª–æ–≤
    """
    # –®–∞–≥ 1: –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º —Ç–µ–∫—Å—Ç (–ø—Ä–∏–≤–æ–¥–∏–º –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É, —É–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã)
    normalized_text = normalize(text)
    
    # –®–∞–≥ 2: –†–∞–∑–±–∏–≤–∞–µ–º –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞ (—Ç–æ–∫–µ–Ω—ã)
    tokens = tokenize(normalized_text)
    
    # –®–∞–≥ 3: –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —á–∞—Å—Ç–æ—Ç—É –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞ (—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è)
    frequency_dict = count_freq(tokens)
    
    # –®–∞–≥ 4: –ù–∞—Ö–æ–¥–∏–º 5 —Å–∞–º—ã—Ö —á–∞—Å—Ç—ã—Ö —Å–ª–æ–≤
    top_5_words = top_n(frequency_dict, 5)
    
    # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    total_word_count = len(tokens)           # –í—Å–µ–≥–æ —Å–ª–æ–≤ (—Å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è–º–∏)
    unique_word_count = len(frequency_dict)  # –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤ (–±–µ–∑ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π)
    
    return total_word_count, unique_word_count, top_5_words


def generate_report(input_file: str, output_file: str, encoding: str = "utf-8", table_output: bool = False) -> None:
    """
    –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞ - –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç –≤—Å—é —Ä–∞–±–æ—Ç—É.
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è:
      1. –ß–∏—Ç–∞–µ—Ç —Ç–µ–∫—Å—Ç –∏–∑ —Ñ–∞–π–ª–∞
      2. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –µ–≥–æ
      3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ–ª–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ CSV
      4. –í—ã–≤–æ–¥–∏—Ç –∫—Ä–∞—Ç–∫—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ –∫–æ–Ω—Å–æ–ª—å
    
    Args:
        input_file (str): –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å —Ç–µ–∫—Å—Ç–æ–º –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
        output_file (str): –ü—É—Ç—å –∫—É–¥–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å CSV –æ—Ç—á–µ—Ç
        encoding (str): –ö–æ–¥–∏—Ä–æ–≤–∫–∞ –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (utf-8, cp1251 –∏ —Ç.–¥.)
        table_output (bool): –ï—Å–ª–∏ True - –≤—ã–≤–æ–¥–∏—Ç –∫—Ä–∞—Å–∏–≤—É—é —Ç–∞–±–ª–∏—Ü—É, –∏–Ω–∞—á–µ –ø—Ä–æ—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫
    
    Raises:
        FileNotFoundError: –ï—Å–ª–∏ –≤—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        UnicodeDecodeError: –ï—Å–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —É–∫–∞–∑–∞–Ω–∞ –∫–æ–¥–∏—Ä–æ–≤–∫–∞ —Ñ–∞–π–ª–∞
    """
    try:
        """
        –ë–õ–û–ö 1: –ß–¢–ï–ù–ò–ï –§–ê–ô–õ–ê
        """
        print(f"–ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª: {input_file}")
        text_content = read_text(input_file, encoding)
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Ñ–∞–π–ª –Ω–µ –ø—É—Å—Ç–æ–π
        if not text_content.strip():
            print("–í–Ω–∏–º–∞–Ω–∏–µ: —Ñ–∞–π–ª –ø—É—Å—Ç–æ–π –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–æ–±–µ–ª—ã")
        
        """
        –ë–õ–û–ö 2: –ê–ù–ê–õ–ò–ó –¢–ï–ö–°–¢–ê
        """
        print("–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç...")
        total_words, unique_words, top_words = analyze_text(text_content)
        
        """
        –ë–õ–û–ö 3: –ü–û–î–ì–û–¢–û–í–ö–ê –î–ê–ù–ù–´–• –î–õ–Ø CSV
        –ó–¥–µ—Å—å –º—ã –∑–∞–Ω–æ–≤–æ –ø–æ–ª—É—á–∞–µ–º —á–∞—Å—Ç–æ—Ç—ã –≤—Å–µ—Ö —Å–ª–æ–≤ –∏ —Å–æ—Ä—Ç–∏—Ä—É–µ–º –∏—Ö
        –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ CSV —Ñ–∞–π–ª
        """
        # –ü–æ–ª—É—á–∞–µ–º —á–∞—Å—Ç–æ—Ç—ã –≤—Å–µ—Ö —Å–ª–æ–≤ (–Ω–µ —Ç–æ–ª—å–∫–æ —Ç–æ–ø-5)
        all_frequencies = count_freq(tokenize(normalize(text_content)))
        
        # –°–æ—Ä—Ç–∏—Ä—É–µ–º —Å–ª–æ–≤–∞ –ø–æ —É–±—ã–≤–∞–Ω–∏—é —á–∞—Å—Ç–æ—Ç—ã, –ø—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ - –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É
        sorted_all_words = sorted(all_frequencies.items(), key=lambda x: (-x[1], x[0]))
        
        # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —Ñ–æ—Ä–º–∞—Ç –¥–ª—è CSV: —Å–ø–∏—Å–æ–∫ –∫–æ—Ä—Ç–µ–∂–µ–π (—Å–ª–æ–≤–æ, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ)
        csv_data = [(word, count) for word, count in sorted_all_words]
        
        """
        –ë–õ–û–ö 4: –°–û–•–†–ê–ù–ï–ù–ò–ï CSV –û–¢–ß–ï–¢–ê
        """
        print(f"–°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ç—á–µ—Ç...")
        write_csv(csv_data, output_file, header=("word", "count"))
        
        """
        –ë–õ–û–ö 5: –í–´–í–û–î –°–¢–ê–¢–ò–°–¢–ò–ö–ò –í –ö–û–ù–°–û–õ–¨
        """
        print("\n–†–ï–ó–£–õ–¨–¢–ê–¢–´ –ê–ù–ê–õ–ò–ó–ê:")
        print(f"   –í—Å–µ–≥–æ —Å–ª–æ–≤: {total_words}")
        print(f"   –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤: {unique_words}")
        print("   –¢–æ–ø-5 —Å–∞–º—ã—Ö —á–∞—Å—Ç—ã—Ö —Å–ª–æ–≤:")
        
        if table_output:
            # –í–´–í–û–î –í –í–ò–î–ï –ö–†–ê–°–ò–í–û–ô –¢–ê–ë–õ–ò–¶–´
            print_table_output(top_words)
        else:
            # –ü–†–û–°–¢–û–ô –í–´–í–û–î (–∫–∞–∫ –±—ã–ª–æ —Ä–∞–Ω—å—à–µ)
            for word, count in top_words:
                print(f"   {word}: {count}")
            
        print(f"\n–ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤: {output_file}")
        
    except FileNotFoundError:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏: —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω
        print(f"–û—à–∏–±–∫–∞: —Ñ–∞–π–ª '{input_file}' –Ω–µ –Ω–∞–π–¥–µ–Ω!")
        print("   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –∏ –µ–≥–æ –Ω–∞–ª–∏—á–∏–µ")
        sys.exit(1)  # –ó–∞–≤–µ—Ä—à–∞–µ–º –ø—Ä–æ–≥—Ä–∞–º–º—É —Å –∫–æ–¥–æ–º –æ—à–∏–±–∫–∏ 1
        
    except UnicodeDecodeError:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏: –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞
        print(f"–û—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª '{input_file}' –≤ –∫–æ–¥–∏—Ä–æ–≤–∫–µ '{encoding}'")
        print("   –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:")
        print("   - –£–∫–∞–∂–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–æ–¥–∏—Ä–æ–≤–∫—É: --encoding cp1251")
        print("   - –ü—Ä–µ–æ–±—Ä–∞–∑—É–π—Ç–µ —Ñ–∞–π–ª –≤ UTF-8")
        sys.exit(1)  # –ó–∞–≤–µ—Ä—à–∞–µ–º –ø—Ä–æ–≥—Ä–∞–º–º—É —Å –∫–æ–¥–æ–º –æ—à–∏–±–∫–∏ 1


def main() -> None:
    """
    –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞.
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è:
      1. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø–∞—Ä—Å–µ—Ä –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
      2. –ß–∏—Ç–∞–µ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ—Ç–æ—Ä—ã–µ –≤–≤–µ–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      3. –ó–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞
    
    –ê—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏:
      --input, -i    : –ü—É—Ç—å –∫ –≤—Ö–æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—É
      --output, -o   : –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ç—á–µ—Ç–∞  
      --encoding, -e : –ö–æ–¥–∏—Ä–æ–≤–∫–∞ —Ñ–∞–π–ª–∞
      --table, -t    : –í–∫–ª—é—á–∏—Ç—å –∫—Ä–∞—Å–∏–≤—ã–π —Ç–∞–±–ª–∏—á–Ω—ã–π –≤—ã–≤–æ–¥
    """
    """
    –®–∞–≥ 1: –°–û–ó–î–ê–ï–ú –ü–ê–†–°–ï–† –ê–†–ì–£–ú–ï–ù–¢–û–í
    ArgumentParser - —ç—Ç–æ "—É–º–Ω—ã–π" –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ—Ç–æ—Ä—ã–π —Å–∞–º –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ø—Ä–∞–≤–∫—É
    –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
    """
    parser = argparse.ArgumentParser(
        description="–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç—á–µ—Ç –æ —á–∞—Å—Ç–æ—Ç–µ —Å–ª–æ–≤",
        epilog="–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:\n"
               "  python text_report.py                    # –ë–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è\n"
               "  python text_report.py --table            # –° –∫—Ä–∞—Å–∏–≤–æ–π —Ç–∞–±–ª–∏—Ü–µ–π\n"
               "  python text_report.py -i story.txt -t    # –ê–Ω–∞–ª–∏–∑ story.txt —Å —Ç–∞–±–ª–∏—Ü–µ–π"
    )
    
    """
    –®–∞–≥ 2: –î–û–ë–ê–í–õ–Ø–ï–ú –ê–†–ì–£–ú–ï–ù–¢–´
    –ö–∞–∂–¥—ã–π add_argument –¥–æ–±–∞–≤–ª—è–µ—Ç –æ–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ
    """
    
    # –ê—Ä–≥—É–º–µ–Ω—Ç –¥–ª—è –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
    parser.add_argument(
        '--input',                   # –î–ª–∏–Ω–Ω–æ–µ –∏–º—è: --input
        '-i',                        # –ö–æ—Ä–æ—Ç–∫–æ–µ –∏–º—è: -i
        default='data/lab04/input.txt',  # –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –µ—Å–ª–∏ –∞—Ä–≥—É–º–µ–Ω—Ç –Ω–µ —É–∫–∞–∑–∞–Ω
        help='–ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å —Ç–µ–∫—Å—Ç–æ–º –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞'  # –û–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏
    )
    
    # –ê—Ä–≥—É–º–µ–Ω—Ç –¥–ª—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
    parser.add_argument(
        '--output', 
        '-o',
        default='data/lab04/report.csv',
        help='–ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è CSV –æ—Ç—á–µ—Ç–∞ —Å –ø–æ–ª–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π'
    )
    
    # –ê—Ä–≥—É–º–µ–Ω—Ç –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∫–∏ —Ñ–∞–π–ª–∞
    parser.add_argument(
        '--encoding',
        '-e', 
        default='utf-8',
        help='–ö–æ–¥–∏—Ä–æ–≤–∫–∞ –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (utf-8, cp1251, koi8-r –∏ —Ç.–¥.)'
    )
    
    # –ê—Ä–≥—É–º–µ–Ω—Ç –¥–ª—è —Ç–∞–±–ª–∏—á–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞ (—Ñ–ª–∞–≥ - –ª–∏–±–æ –µ—Å—Ç—å, –ª–∏–±–æ –Ω–µ—Ç)
    parser.add_argument(
        '--table',
        '-t',
        action='store_true',  # –û—Å–æ–±—ã–π —Ç–∏–ø –∞—Ä–≥—É–º–µ–Ω—Ç–∞ - —Ñ–ª–∞–≥ (True –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω, False –µ—Å–ª–∏ –Ω–µ—Ç)
        help='–í—ã–≤–æ–¥–∏—Ç—å —Ç–æ–ø-5 —Å–ª–æ–≤ –≤ –≤–∏–¥–µ –∫—Ä–∞—Å–∏–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã'
    )
    
    """
    –®–∞–≥ 3: –ß–ò–¢–ê–ï–ú –ê–†–ì–£–ú–ï–ù–¢–´ –ò–ó –ö–û–ú–ê–ù–î–ù–û–ô –°–¢–†–û–ö–ò
    parse_args() –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç sys.argv (–∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–¥–∞–ª–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ)
    –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç —Å –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –≤—Å–µ—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
    """
    args = parser.parse_args()
    
    """
    –®–∞–≥ 4: –ó–ê–ü–£–°–ö–ê–ï–ú –ì–ï–ù–ï–†–ê–¶–ò–Æ –û–¢–ß–ï–¢–ê
    –ü–µ—Ä–µ–¥–∞–µ–º –≤—Å–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤ –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
    """
    print("–ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ–∫—Å—Ç–∞...")
    print(f"   –í—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª: {args.input}")
    print(f"   –í—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª: {args.output}") 
    print(f"   –ö–æ–¥–∏—Ä–æ–≤–∫–∞: {args.encoding}")
    print(f"   –¢–∞–±–ª–∏—á–Ω—ã–π –≤—ã–≤–æ–¥: {'–í–ö–õ–Æ–ß–ï–ù' if args.table else '–≤—ã–∫–ª—é—á–µ–Ω'}")
    print()
    
    generate_report(args.input, args.output, args.encoding, args.table)


"""
–≠–¢–ê –°–¢–†–û–ö–ê –û–ß–ï–ù–¨ –í–ê–ñ–ù–ê!
–û–Ω–∞ –æ–∑–Ω–∞—á–∞–µ—Ç: "–∑–∞–ø—É—Å–∫–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é main() —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —ç—Ç–æ—Ç —Ñ–∞–π–ª –∑–∞–ø—É—â–µ–Ω –Ω–∞–ø—Ä—è–º—É—é,
–∞ –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ –º–æ–¥—É–ª—å –≤ –¥—Ä—É–≥–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ"

–≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –≤ Python - –æ–Ω–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∞–π–ª –∏ –∫–∞–∫ —Å–∫—Ä–∏–ø—Ç,
–∏ –∫–∞–∫ –º–æ–¥—É–ª—å –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö
"""
if __name__ == "__main__":
    main()
```

**–§–∞–π–ª io_txt_csv:**
``` python
"""
–ú–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º–∏ –∏ CSV —Ñ–∞–π–ª–∞–º–∏.
–õ–†4 ‚Äî –§–∞–π–ª—ã: TXT/CSV –∏ –æ—Ç—á—ë—Ç—ã
"""

import csv
from pathlib import Path
from typing import Union, Iterable, Sequence


def read_text(path: Union[str, Path], encoding: str = "utf-8") -> str:
    """
    –ß–∏—Ç–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–∞–∫ —Å—Ç—Ä–æ–∫—É.
    
    Args:
        path: –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É (—Å—Ç—Ä–æ–∫–∞ –∏–ª–∏ Path –æ–±—ä–µ–∫—Ç)
        encoding: –ö–æ–¥–∏—Ä–æ–≤–∫–∞ —Ñ–∞–π–ª–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é UTF-8)
        
    Returns:
        –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ –∫–∞–∫ —Å—Ç—Ä–æ–∫–∞
        
    Raises:
        FileNotFoundError: –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        UnicodeDecodeError: –ï—Å–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞
        
    Examples:
        >>> text = read_text("data/input.txt")
        >>> text = read_text("data/file.txt", encoding="cp1251")
    """
    # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ Path –æ–±—ä–µ–∫—Ç –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
    file_path = Path(path)
    
    # –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª —Å —É–∫–∞–∑–∞–Ω–Ω–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π
    # –ï—Å–ª–∏ —Ñ–∞–π–ª–∞ –Ω–µ—Ç - –≤—ã–±—Ä–æ—Å–∏—Ç—Å—è FileNotFoundError
    # –ï—Å–ª–∏ –∫–æ–¥–∏—Ä–æ–≤–∫–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è - UnicodeDecodeError
    return file_path.read_text(encoding=encoding)


def write_csv(rows: Iterable[Sequence], path: Union[str, Path], 
              header: tuple[str, ...] = None) -> None:
    """
    –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ CSV —Ñ–∞–π–ª.
    
    Args:
        rows: –ò—Ç–µ—Ä–∏—Ä—É–µ–º—ã–π –æ–±—ä–µ–∫—Ç —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö
        path: –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è CSV —Ñ–∞–π–ª–∞
        header: –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        
    Raises:
        ValueError: –ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∏ –∏–º–µ—é—Ç —Ä–∞–∑–Ω—É—é –¥–ª–∏–Ω—É
        
    Examples:
        >>> data = [("word", "count"), ("–ø—Ä–∏–≤–µ—Ç", 2)]
        >>> write_csv(data, "report.csv", header=("word", "count"))
    """
    file_path = Path(path)
    rows_list = list(rows)  # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —Å–ø–∏—Å–æ–∫ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –¥–ª–∏–Ω—ã
    if rows_list:
        first_len = len(rows_list[0])
        for i, row in enumerate(rows_list):
            if len(row) != first_len:
                raise ValueError(f"–°—Ç—Ä–æ–∫–∞ {i} –∏–º–µ–µ—Ç –¥–ª–∏–Ω—É {len(row)}, –æ–∂–∏–¥–∞–ª–∞—Å—å {first_len}")
    
    # –°–æ–∑–¥–∞–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø–∞–ø–∫–∏ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
    file_path.parent.mkdir(parents=True, exist_ok=True)
    
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ CSV
    with file_path.open('w', encoding='utf-8', newline='') as file:
        writer = csv.writer(file)
        
        # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –µ—Å–ª–∏ –µ—Å—Ç—å
        if header is not None:
            writer.writerow(header)
        
        # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ
        for row in rows_list:
            writer.writerow(row)


def ensure_parent_dir(path: Union[str, Path]) -> None:
    """
    –°–æ–∑–¥–∞–µ—Ç —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç.
    
    Args:
        path: –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –∏–ª–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
        
    Examples:
        >>> ensure_parent_dir("data/reports/final.csv")
        # –°–æ–∑–¥–∞—Å—Ç –ø–∞–ø–∫–∏ data/ –∏ data/reports/ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
    """
    file_path = Path(path)
    file_path.parent.mkdir(parents=True, exist_ok=True)
```

# –¢–µ—Å—Ç—ã –∏ –≤—ã–≤–æ–¥—ã

**–û–±—ã—á–Ω—ã–π –≤—ã–≤–æ–¥**
![alt text](<images/lab04/ordinary.png>)

**–¢–∞–±–ª–∏—á–Ω—ã–π –≤—ã–≤–æ–¥**
![alt text](<images/lab04/table.png>)

**–í—ã–≤–æ–¥ –¥–ª—è —Ñ–∞–π–ª–∞ –∞**
![alt text](<images/lab04/test_a.png>)

**–í—ã–≤–æ–¥ –¥–ª—è —Ñ–∞–π–ª–∞ b**
![alt text](<images/lab04/test_b.png>)

**–¢–µ—Å—Ç –æ—à–∏–±–æ–∫**
![alt text](<images/lab04/test_error.png>)

**–í—ã–≤–æ–¥ —Å–ø—Ä–∞–≤–∫–∏ - help**
![alt text](<images/lab04/test_help.png>)


# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ5
## JSON –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ (JSON‚ÜîCSV, CSV‚ÜíXLSX): –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ
**–¶–µ–ª—å:**
–†–∞–∑–æ–±—Ä–∞—Ç—å—Å—è —Å —Ñ–æ—Ä–º–∞—Ç–æ–º JSON, —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π –∏ —Ç–∞–±–ª–∏—á–Ω—ã–º–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è–º–∏

**–§–∞–π–ª:** json_csv.py

``` python
"""
–ú–æ–¥—É–ª—å –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –º–µ–∂–¥—É JSON –∏ CSV —Ñ–æ—Ä–º–∞—Ç–∞–º–∏.
–õ–†5 ‚Äî JSON –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
"""

import json
import csv
from pathlib import Path


def json_to_csv(json_path: str, csv_path: str) -> None:
    """
    –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç JSON —Ñ–∞–π–ª –≤ CSV —Ñ–æ—Ä–º–∞—Ç.
    
    –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç JSON —Ñ–∞–π–ª—ã —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π.
    –ù–∞–ø—Ä–∏–º–µ—Ä: [{"name": "Alice", "age": 25}, {"name": "Bob", "age": 30}]
    
    Args:
        json_path: –ü—É—Ç—å –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É JSON —Ñ–∞–π–ª—É
        csv_path: –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è CSV —Ñ–∞–π–ª–∞
        
    Raises:
        FileNotFoundError: –ï—Å–ª–∏ JSON —Ñ–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        ValueError: –ï—Å–ª–∏ JSON –ø—É—Å—Ç–æ–π, –Ω–µ —Å–ø–∏—Å–æ–∫ –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ —Å–ª–æ–≤–∞—Ä–∏
    """
    # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –ø—É—Ç–∏ –≤ Path –æ–±—ä–µ–∫—Ç—ã
    json_file = Path(json_path)
    csv_file = Path(csv_path)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ JSON —Ñ–∞–π–ª–∞
    if not json_file.exists():
        raise FileNotFoundError(f"JSON —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: {json_path}")
    
    # –ß–∏—Ç–∞–µ–º JSON —Ñ–∞–π–ª
    with json_file.open('r', encoding='utf-8') as jf:
        try:
            data = json.load(jf)
        except json.JSONDecodeError as e:
            raise ValueError(f"–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è JSON: {e}")
    
    # –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    if not data:
        raise ValueError("–ü—É—Å—Ç–æ–π JSON —Ñ–∞–π–ª")
    
    if not isinstance(data, list):
        raise ValueError("JSON –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ø–∏—Å–æ–∫")
    
    if not all(isinstance(item, dict) for item in data):
        raise ValueError("–í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã JSON –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–ª–æ–≤–∞—Ä—è–º–∏")
    
    # –°–æ–∑–¥–∞–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø–∞–ø–∫–∏ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
    csv_file.parent.mkdir(parents=True, exist_ok=True)
    
    # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏ –∏–∑ –≤—Å–µ—Ö —Å–ª–æ–≤–∞—Ä–µ–π
    all_keys = set()
    for item in data:
        all_keys.update(item.keys())
    
    # –°–æ—Ä—Ç–∏—Ä—É–µ–º –∫–ª—é—á–∏ –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É –¥–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è
    fieldnames = sorted(all_keys)
    
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º CSV
    with csv_file.open('w', encoding='utf-8', newline='') as cf:
        writer = csv.DictWriter(cf, fieldnames=fieldnames)
        writer.writeheader()
        
        for item in data:
            # –ó–∞–ø–æ–ª–Ω—è–µ–º –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è –ø—É—Å—Ç—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏
            row = {key: item.get(key, '') for key in fieldnames}
            writer.writerow(row)


def csv_to_json(csv_path: str, json_path: str) -> None:
    """
    –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç CSV —Ñ–∞–π–ª –≤ JSON —Ñ–æ—Ä–º–∞—Ç.
    
    –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç CSV –≤ —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π, –≥–¥–µ –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ - –∑–∞–≥–æ–ª–æ–≤–∫–∏.
    
    Args:
        csv_path: –ü—É—Ç—å –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É CSV —Ñ–∞–π–ª—É
        json_path: –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è JSON —Ñ–∞–π–ª–∞
        
    Raises:
        FileNotFoundError: –ï—Å–ª–∏ CSV —Ñ–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        ValueError: –ï—Å–ª–∏ CSV —Ñ–∞–π–ª –ø—É—Å—Ç–æ–π –∏–ª–∏ –Ω–µ –∏–º–µ–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞
    """
    # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –ø—É—Ç–∏ –≤ Path –æ–±—ä–µ–∫—Ç—ã
    csv_file = Path(csv_path)
    json_file = Path(json_path)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ CSV —Ñ–∞–π–ª–∞
    if not csv_file.exists():
        raise FileNotFoundError(f"CSV —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: {csv_path}")
    
    # –ß–∏—Ç–∞–µ–º CSV —Ñ–∞–π–ª
    with csv_file.open('r', encoding='utf-8') as cf:
        reader = csv.DictReader(cf)
        
        # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —Å–ø–∏—Å–æ–∫
        data = list(reader)
    
    # –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    if not data:
        raise ValueError("CSV —Ñ–∞–π–ª –ø—É—Å—Ç–æ–π –∏–ª–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã—Ö")
    
    # –°–æ–∑–¥–∞–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø–∞–ø–∫–∏ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
    json_file.parent.mkdir(parents=True, exist_ok=True)
    
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º JSON
    with json_file.open('w', encoding='utf-8') as jf:
        json.dump(data, jf, ensure_ascii=False, indent=2)

```
**–í—ã–≤–æ–¥:**

![alt text](<images/lab05/csv-json.png>)

**–í—ã–≤–æ–¥:**

![alt text](<images/lab05/json-csv.png>)


**–§–∞–π–ª:** csv_xlsx.py

``` python
"""
–ú–æ–¥—É–ª—å –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ CSV –≤ XLSX —Ñ–æ—Ä–º–∞—Ç.
–õ–†5 ‚Äî JSON –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
"""

import csv
from pathlib import Path

# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º openpyxl (–≤–Ω–µ—à–Ω—è—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞)
try:
    from openpyxl import Workbook
    from openpyxl.utils import get_column_letter
except ImportError:
    raise ImportError("–î–ª—è —Ä–∞–±–æ—Ç—ã —ç—Ç–æ–≥–æ –º–æ–¥—É–ª—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ openpyxl: pip install openpyxl")


def csv_to_xlsx(csv_path: str, xlsx_path: str) -> None:
    """
    –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç CSV —Ñ–∞–π–ª –≤ XLSX —Ñ–æ—Ä–º–∞—Ç (Excel).
    
    –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–±–∏—Ä–∞–µ—Ç —à–∏—Ä–∏–Ω—É –∫–æ–ª–æ–Ω–æ–∫ –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É.
    
    Args:
        csv_path: –ü—É—Ç—å –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É CSV —Ñ–∞–π–ª—É
        xlsx_path: –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è XLSX —Ñ–∞–π–ª–∞
        
    Raises:
        FileNotFoundError: –ï—Å–ª–∏ CSV —Ñ–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        ValueError: –ï—Å–ª–∏ CSV —Ñ–∞–π–ª –ø—É—Å—Ç–æ–π
    """
    # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –ø—É—Ç–∏ –≤ Path –æ–±—ä–µ–∫—Ç—ã
    csv_file = Path(csv_path)
    xlsx_file = Path(xlsx_path)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ CSV —Ñ–∞–π–ª–∞
    if not csv_file.exists():
        raise FileNotFoundError(f"CSV —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: {csv_path}")
    
    # –ß–∏—Ç–∞–µ–º CSV —Ñ–∞–π–ª
    with csv_file.open('r', encoding='utf-8') as cf:
        reader = csv.reader(cf)
        rows = list(reader)
    
    # –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    if not rows:
        raise ValueError("CSV —Ñ–∞–π–ª –ø—É—Å—Ç–æ–π")
    
    # –°–æ–∑–¥–∞–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø–∞–ø–∫–∏ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
    xlsx_file.parent.mkdir(parents=True, exist_ok=True)
    
    # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –∫–Ω–∏–≥—É Excel
    workbook = Workbook()
    sheet = workbook.active
    sheet.title = "Sheet1"
    
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ CSV –≤ Excel
    for row in rows:
        sheet.append(row)
    
    # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∞–≤—Ç–æ-—à–∏—Ä–∏–Ω—É –∫–æ–ª–æ–Ω–æ–∫
    for column_cells in sheet.columns:
        # –ü–æ–ª—É—á–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É —Ç–µ–∫—Å—Ç–∞ –≤ –∫–æ–ª–æ–Ω–∫–µ
        max_length = 0
        column_letter = get_column_letter(column_cells[0].column)
        
        for cell in column_cells:
            try:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–ª–∏–Ω—É —Ç–µ–∫—Å—Ç–∞ –≤ —è—á–µ–π–∫–µ
                if len(str(cell.value)) > max_length:
                    max_length = len(str(cell.value))
            except:
                pass
        
        # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —à–∏—Ä–∏–Ω—É –∫–æ–ª–æ–Ω–∫–∏ (–º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤)
        adjusted_width = max(max_length + 2, 8)
        sheet.column_dimensions[column_letter].width = adjusted_width
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º XLSX —Ñ–∞–π–ª
    workbook.save(xlsx_file)

```
**–í—ã–≤–æ–¥:**

![alt text](<images/lab05/peoplexlsx.png>)

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏ –ø–∞–ø–æ–∫ –≤ —Å–∏—Å—Ç–µ–º–µ:**


![alt text](<images/lab05/x-.png>)


# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ6
## cli_convert:
``` python
"""
–ö–æ–º–∞–Ω–¥–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É —Ñ–æ—Ä–º–∞—Ç–∞–º–∏.

–ú–æ–¥—É–ª—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç CLI-–∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏:
- json2csv: JSON ‚Üí CSV
- csv2json: CSV ‚Üí JSON  
- csv2xlsx: CSV ‚Üí XLSX

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
    python -m src.lab06.cli_convert <–∫–æ–º–∞–Ω–¥–∞> --in <–≤—Ö–æ–¥–Ω–æ–π_—Ñ–∞–π–ª> --out <–≤—ã—Ö–æ–¥–Ω–æ–π_—Ñ–∞–π–ª>

–ü—Ä–∏–º–µ—Ä—ã:
    python -m src.lab06.cli_convert json2csv --in data/samples/people.json --out data/out/people.csv
    python -m src.lab06.cli_convert csv2json --in data/samples/people.csv --out data/out/people.json
    python -m src.lab06.cli_convert csv2xlsx --in data/samples/people.csv --out data/out/people.xlsx
"""

import argparse
import sys
from pathlib import Path


def main():
    """
    –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è CLI-–∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä–∞.
    
    –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –∏ –≤—ã–∑—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ
    —Ñ—É–Ω–∫—Ü–∏–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –∏–∑ –º–æ–¥—É–ª—è lab05.
    """
    # –°–æ–∑–¥–∞–µ–º –ø–∞—Ä—Å–µ—Ä –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–æ–≥—Ä–∞–º–º—ã
    parser = argparse.ArgumentParser(
        description="–ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É —Ñ–æ—Ä–º–∞—Ç–∞–º–∏ JSON, CSV, XLSX",
        epilog="–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:\n"
               "  python -m src.lab06.cli_convert json2csv --in input.json --out output.csv\n"
               "  python -m src.lab06.cli_convert csv2json --in input.csv --out output.json\n"
               "  python -m src.lab06.cli_convert csv2xlsx --in input.csv --out output.xlsx"
    )
    
    # –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–ø–∞—Ä—Å–µ—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
    subparsers = parser.add_subparsers(
        dest="command", 
        help="–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏"
    )
    
    # –ö–æ–º–∞–Ω–¥–∞ json2csv
    json2csv_parser = subparsers.add_parser(
        "json2csv", 
        help="–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å JSON —Ñ–∞–π–ª –≤ CSV —Ñ–æ—Ä–º–∞—Ç"
    )
    json2csv_parser.add_argument(
        "--in", 
        dest="input", 
        required=True,
        help="–ü—É—Ç—å –∫ –≤—Ö–æ–¥–Ω–æ–º—É JSON —Ñ–∞–π–ª—É (–Ω–∞–ø—Ä–∏–º–µ—Ä: data/samples/people.json)"
    )
    json2csv_parser.add_argument(
        "--out", 
        dest="output", 
        required=True,
        help="–ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è CSV —Ñ–∞–π–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: data/out/people.csv)"
    )
    
    # –ö–æ–º–∞–Ω–¥–∞ csv2json
    csv2json_parser = subparsers.add_parser(
        "csv2json", 
        help="–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å CSV —Ñ–∞–π–ª –≤ JSON —Ñ–æ—Ä–º–∞—Ç"
    )
    csv2json_parser.add_argument(
        "--in", 
        dest="input", 
        required=True,
        help="–ü—É—Ç—å –∫ –≤—Ö–æ–¥–Ω–æ–º—É CSV —Ñ–∞–π–ª—É (–Ω–∞–ø—Ä–∏–º–µ—Ä: data/samples/people.csv)"
    )
    csv2json_parser.add_argument(
        "--out", 
        dest="output", 
        required=True,
        help="–ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è JSON —Ñ–∞–π–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: data/out/people.json)"
    )
    
    # –ö–æ–º–∞–Ω–¥–∞ csv2xlsx
    csv2xlsx_parser = subparsers.add_parser(
        "csv2xlsx", 
        help="–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å CSV —Ñ–∞–π–ª –≤ Excel (XLSX) —Ñ–æ—Ä–º–∞—Ç"
    )
    csv2xlsx_parser.add_argument(
        "--in", 
        dest="input", 
        required=True,
        help="–ü—É—Ç—å –∫ –≤—Ö–æ–¥–Ω–æ–º—É CSV —Ñ–∞–π–ª—É (–Ω–∞–ø—Ä–∏–º–µ—Ä: data/samples/people.csv)"
    )
    csv2xlsx_parser.add_argument(
        "--out", 
        dest="output", 
        required=True,
        help="–ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è XLSX —Ñ–∞–π–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: data/out/people.xlsx)"
    )
    
    # –ü–∞—Ä—Å–∏–º –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
    args = parser.parse_args()
    
    # –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞, –≤—ã–≤–æ–¥–∏–º —Å–ø—Ä–∞–≤–∫—É
    if not args.command:
        parser.print_help()
        return
    
    try:
        # –í—ã–ø–æ–ª–Ω—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É
        if args.command == "json2csv":
            from src.lab05.json_csv import json_to_csv
            json_to_csv(args.input, args.output)
            print(f"‚úÖ –£—Å–ø–µ—à–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω {args.input} ‚Üí {args.output}")
            
        elif args.command == "csv2json":
            from src.lab05.json_csv import csv_to_json
            csv_to_json(args.input, args.output)
            print(f"‚úÖ –£—Å–ø–µ—à–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω {args.input} ‚Üí {args.output}")
            
        elif args.command == "csv2xlsx":
            from src.lab05.csv_xlsx import csv_to_xlsx
            csv_to_xlsx(args.input, args.output)
            print(f"‚úÖ –£—Å–ø–µ—à–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω {args.input} ‚Üí {args.output}")
            
    except FileNotFoundError as e:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —Ñ–∞–π–ª–∞
        print(f"‚ùå –û—à–∏–±–∫–∞: —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω - {e}")
        sys.exit(1)
    except ValueError as e:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
        print(f"‚ùå –û—à–∏–±–∫–∞: –Ω–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ - {e}")
        sys.exit(1)
    except Exception as e:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –æ—à–∏–±–æ–∫
        print(f"‚ùå –ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞: {e}")
        sys.exit(1)


if __name__ == "__main__":
    main()
    
```


# cli_text:
``` python
"""
–ö–æ–º–∞–Ω–¥–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏.

–ú–æ–¥—É–ª—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç CLI-–∫–æ–º–∞–Ω–¥—ã –¥–ª—è:
- –í—ã–≤–æ–¥–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ñ–∞–π–ª–æ–≤ (cat)
- –ê–Ω–∞–ª–∏–∑–∞ —á–∞—Å—Ç–æ—Ç—ã —Å–ª–æ–≤ –≤ —Ç–µ–∫—Å—Ç–µ (stats)

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
    python -m src.lab06.cli_text <–∫–æ–º–∞–Ω–¥–∞> --input <—Ñ–∞–π–ª> [–æ–ø—Ü–∏–∏]

–ü—Ä–∏–º–µ—Ä—ã:
    python -m src.lab06.cli_text cat --input data/samples/sample.txt
    python -m src.lab06.cli_text cat --input data/samples/sample.txt -n
    python -m src.lab06.cli_text stats --input data/samples/sample.txt
    python -m src.lab06.cli_text stats --input data/samples/sample.txt --top 10
"""

import argparse
import sys
import os
from typing import List


def read_and_tokenize(filepath: str) -> List[str]:
    """
    –ß–∏—Ç–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –∏ —Ä–∞–∑–±–∏–≤–∞–µ—Ç –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –Ω–∞ —Å–ª–æ–≤–∞ (—Ç–æ–∫–µ–Ω—ã).
    
    –ü—Ä–æ—Ü–µ—Å—Å —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏–∏:
    1. –ß—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤ –∫–æ–¥–∏—Ä–æ–≤–∫–µ UTF-8
    2. –ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É
    3. –£–¥–∞–ª–µ–Ω–∏–µ –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏
    4. –†–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ —Å–ª–æ–≤–∞ –ø–æ –ø—Ä–æ–±–µ–ª—å–Ω—ã–º —Å–∏–º–≤–æ–ª–∞–º
    
    –ü—Ä–∏–º–µ—Ä:
        –§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç: "–ü—Ä–∏–≤–µ—Ç, –º–∏—Ä! Hello World."
        –†–µ–∑—É–ª—å—Ç–∞—Ç: ["–ø—Ä–∏–≤–µ—Ç", "–º–∏—Ä", "hello", "world"]
    
    Args:
        filepath (str): –ü—É—Ç—å –∫ —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É —Ñ–∞–π–ª—É
    
    Returns:
        List[str]: –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤ (—Ç–æ–∫–µ–Ω–æ–≤) –∏–∑ —Ñ–∞–π–ª–∞
    
    Raises:
        FileNotFoundError: –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        UnicodeDecodeError: –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –≤ UTF-8 –∫–æ–¥–∏—Ä–æ–≤–∫–µ
    """
    # –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∫–æ–¥–∏—Ä–æ–≤–∫–∏ UTF-8
    with open(filepath, 'r', encoding='utf-8') as f:
        text = f.read()
    
    # –ü—Ä–∏–≤–æ–¥–∏–º –≤–µ—Å—å —Ç–µ–∫—Å—Ç –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É –¥–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è
    text = text.lower()
    
    # –£–¥–∞–ª—è–µ–º –ø—É–Ω–∫—Ç—É–∞—Ü–∏—é –∏–∑ —Ç–µ–∫—Å—Ç–∞
    import string
    # –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –ø–µ—Ä–µ–≤–æ–¥–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∑–Ω–∞–∫–æ–≤ –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏
    translator = str.maketrans('', '', string.punctuation)
    text = text.translate(translator)
    
    # –†–∞–∑–±–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç –Ω–∞ —Å–ª–æ–≤–∞ –ø–æ –ø—Ä–æ–±–µ–ª—å–Ω—ã–º —Å–∏–º–≤–æ–ª–∞–º
    tokens = text.split()
    
    return tokens


def main():
    """
    –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ CLI.
    
    –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç
    —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏.
    """
    # –°–æ–∑–¥–∞–µ–º –ø–∞—Ä—Å–µ—Ä –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º
    parser = argparse.ArgumentParser(
        description="–¢–µ–∫—Å—Ç–æ–≤—ã–µ —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏",
        epilog="–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:\n"
               "  python -m src.lab06.cli_text cat --input file.txt\n"
               "  python -m src.lab06.cli_text cat --input file.txt -n\n"
               "  python -m src.lab06.cli_text stats --input file.txt\n"
               "  python -m src.lab06.cli_text stats --input file.txt --top 10"
    )
    
    # –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–ø–∞—Ä—Å–µ—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
    subparsers = parser.add_subparsers(
        dest="command",
        help="–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã"
    )
    
    # –ö–æ–º–∞–Ω–¥–∞ cat (–≤—ã–≤–æ–¥ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ñ–∞–π–ª–∞)
    cat_parser = subparsers.add_parser(
        "cat",
        help="–í—ã–≤–µ—Å—Ç–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞"
    )
    cat_parser.add_argument(
        "--input",
        required=True,
        help="–ü—É—Ç—å –∫ –≤—Ö–æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—É (–Ω–∞–ø—Ä–∏–º–µ—Ä: data/samples/sample.txt)"
    )
    cat_parser.add_argument(
        "-n",
        action="store_true",  # –§–ª–∞–≥, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è
        help="–ù—É–º–µ—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ –≤—ã–≤–æ–¥–∞ (–ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤)"
    )
    
    # –ö–æ–º–∞–Ω–¥–∞ stats (—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–ª–æ–≤)
    stats_parser = subparsers.add_parser(
        "stats",
        help="–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —á–∞—Å—Ç–æ—Ç—É —Å–ª–æ–≤ –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ñ–∞–π–ª–µ"
    )
    stats_parser.add_argument(
        "--input",
        required=True,
        help="–ü—É—Ç—å –∫ —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É —Ñ–∞–π–ª—É –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"
    )
    stats_parser.add_argument(
        "--top",
        type=int,
        default=5,
        help="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç—ã—Ö —Å–ª–æ–≤ –¥–ª—è –≤—ã–≤–æ–¥–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 5)"
    )
    
    # –ü–∞—Ä—Å–∏–º –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
    args = parser.parse_args()
    
    # –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞, –≤—ã–≤–æ–¥–∏–º —Å–ø—Ä–∞–≤–∫—É
    if not args.command:
        parser.print_help()
        return
    
    try:
        # –í—ã–ø–æ–ª–Ω—è–µ–º –∫–æ–º–∞–Ω–¥—É cat
        if args.command == "cat":
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
            if not os.path.exists(args.input):
                raise FileNotFoundError(f"–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: {args.input}")
            
            # –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ñ–∞–π–ª –∏ –≤—ã–≤–æ–¥–∏–º –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
            with open(args.input, 'r', encoding='utf-8') as f:
                # –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª –ø–æ—Å—Ç—Ä–æ—á–Ω–æ —Å –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π
                for line_number, line in enumerate(f, start=1):
                    if args.n:
                        # –° –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π: –≤—ã–≤–æ–¥–∏–º –Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
                        # :4 - –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ –Ω–∞ 4 —Å–∏–º–≤–æ–ª–∞
                        print(f"{line_number:4} {line}", end='')
                    else:
                        # –ë–µ–∑ –Ω—É–º–µ—Ä–∞—Ü–∏–∏: –≤—ã–≤–æ–¥–∏–º —Ç–æ–ª—å–∫–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
                        print(line, end='')
        
        # –í—ã–ø–æ–ª–Ω—è–µ–º –∫–æ–º–∞–Ω–¥—É stats
        elif args.command == "stats":
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
            if not os.path.exists(args.input):
                raise FileNotFoundError(f"–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: {args.input}")
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä top –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π
            if args.top <= 0:
                raise ValueError("–ü–∞—Ä–∞–º–µ—Ç—Ä --top –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º —á–∏—Å–ª–æ–º")
            
            # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ–∫—Å—Ç–∞ –∏–∑ lab03
            from src.lab03.text_stats import count_freq, top_n
            
            # 1. –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª –∏ —Ä–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ —Å–ª–æ–≤–∞
            tokens = read_and_tokenize(args.input)
            
            # 2. –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —á–∞—Å—Ç–æ—Ç—É —Å–ª–æ–≤
            frequency = count_freq(tokens)
            
            # 3. –ü–æ–ª—É—á–∞–µ–º N —Å–∞–º—ã—Ö —á–∞—Å—Ç—ã—Ö —Å–ª–æ–≤
            top_words = top_n(frequency, args.top)
            
            # 4. –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            print(f"–¢–æ–ø-{args.top} —Å–ª–æ–≤ –≤ —Ñ–∞–π–ª–µ {args.input}:")
            if not top_words:
                print("  (—Ñ–∞–π–ª –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞)")
            else:
                for word, count in top_words:
                    # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–≤–æ–¥: —Å–ª–æ–≤–æ –∏ –µ–≥–æ —á–∞—Å—Ç–æ—Ç–∞
                    print(f"  {word}: {count}")
            
            # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            print(f"\n–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
            print(f"  –í—Å–µ–≥–æ —Å–ª–æ–≤: {len(tokens)}")
            print(f"  –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤: {len(frequency)}")
            if tokens:
                print(f"  –°–∞–º—ã–µ —Ä–µ–¥–∫–∏–µ —Å–ª–æ–≤–∞ (—á–∞—Å—Ç–æ—Ç–∞ 1): {len([w for w, c in frequency.items() if c == 1])}")
    
    except FileNotFoundError as e:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —Ñ–∞–π–ª–∞
        print(f"‚ùå –û—à–∏–±–∫–∞: —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω - {e}")
        print("   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª—É")
        sys.exit(1)
    
    except ValueError as e:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
        print(f"‚ùå –û—à–∏–±–∫–∞: –Ω–µ–≤–µ—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã - {e}")
        sys.exit(1)
    
    except PermissionError as e:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª—É
        print(f"‚ùå –û—à–∏–±–∫–∞: –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª—É - {e}")
        print("   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª—É")
        sys.exit(1)
    
    except Exception as e:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –æ—à–∏–±–æ–∫
        print(f"‚ùå –ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞: {e}")
        print("   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ –∏ –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ")
        sys.exit(1)


if __name__ == "__main__":
    main()
```

# –¢–µ—Å—Ç—ã –∏ –≤—ã–≤–æ–¥—ã:

**–í—ã–≤–æ–¥ cli_csv2json:**

![alt text](<images/lab06/cli_csv2json.png>)

![alt text](<images/lab06/csv2json_pic.png>)

**–í—ã–≤–æ–¥ cli_csv2xlsx:**

![alt text](<images/lab06/cli_csv2xlsx.png>)

![alt text](<images/lab06/csv2xlsx_pic.png>)

**–í—ã–≤–æ–¥ cli_json2csv:**

![alt text](<images/lab06/cli_json2csv.png>)

![alt text](<images/lab06/json2csv_pic.png>)

**–í—ã–≤–æ–¥ cli_text_help:**

![alt text](<images/lab06/cli_text_h.png>)

**–í—ã–≤–æ–¥ cli_convert_help:**

![alt text](<images/lab06/help_convert.png>)

**–í—ã–≤–æ–¥ text_cat:**

![alt text](<images/lab06/text_cat.png>)

**–í—ã–≤–æ–¥ top_3, 5:**

![alt text](<images/lab06/top_3, 5.png>)


# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ7

## test_json_csv.py:
``` python
"""
–ú–æ–¥—É–ª—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ JSON/CSV –∏–∑ lab05.

–¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏:
- json_to_csv() - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è JSON –≤ CSV
- csv_to_json() - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è CSV –≤ JSON

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–∏–∫—Å—Ç—É—Ä—É pytest tmp_path –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.
–¢–µ—Å—Ç—ã –≤–∫–ª—é—á–∞—é—Ç –∫–∞–∫ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏, —Ç–∞–∫ –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫.
"""

import pytest
import json
import csv
import sys
import os

# –î–æ–±–∞–≤–ª—è–µ–º –∫–æ—Ä–Ω–µ–≤—É—é –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞ –≤ –ø—É—Ç—å Python
sys.path.insert(0, os.path.abspath('.'))

# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ç–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
from src.lab05.json_csv import json_to_csv, csv_to_json


def test_json_to_csv_basic(tmp_path):
    """
    –¢–µ—Å—Ç –±–∞–∑–æ–≤–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ JSON ‚Üí CSV.
    
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç JSON-–º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤
    –≤ CSV —Ñ–∞–π–ª —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ –∏ –¥–∞–Ω–Ω—ã–º–∏.
    
    –®–∞–≥–∏ —Ç–µ—Å—Ç–∞:
        1. –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π JSON —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ –æ –ª—é–¥—è—Ö
        2. –í—ã–∑—ã–≤–∞–µ–º json_to_csv()
        3. –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ CSV —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω
        4. –ß–∏—Ç–∞–µ–º CSV –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –¥–∞–Ω–Ω—ã–µ
    
    –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:
        - CSV —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ = 3
        - –ó–∞–≥–æ–ª–æ–≤–∫–∏: name, age, city
        - –î–∞–Ω–Ω—ã–µ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
    """
    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞: —Å–æ–∑–¥–∞–µ–º –ø—É—Ç–∏ –∫ –≤—Ä–µ–º–µ–Ω–Ω—ã–º —Ñ–∞–π–ª–∞–º
    json_path = tmp_path / "test.json"
    csv_path = tmp_path / "test.csv"
    
    # –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ - —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π
    test_data = [
        {"name": "–ê–Ω–Ω–∞", "age": 25, "city": "–ú–æ—Å–∫–≤–∞"},
        {"name": "–ü–µ—Ç—Ä", "age": 30, "city": "–°–ü–±"},
        {"name": "–ú–∞—Ä–∏—è", "age": 28, "city": "–ö–∞–∑–∞–Ω—å"}
    ]
    
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º JSON –≤ —Ñ–∞–π–ª
    json_path.write_text(
        json.dumps(test_data, ensure_ascii=False, indent=2), 
        encoding='utf-8'
    )
    
    # –î–µ–π—Å—Ç–≤–∏–µ: –≤—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
    json_to_csv(str(json_path), str(csv_path))
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: CSV —Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω
    assert csv_path.exists()
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: —á–∏—Ç–∞–µ–º CSV –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
    with open(csv_path, 'r', encoding='utf-8') as f:
        reader = csv.DictReader(f)
        rows = list(reader)  # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —Å–ø–∏—Å–æ–∫ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
        
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 3, –∫–∞–∫ –≤ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)
    assert len(rows) == 3
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–∫–ª—é—á–∏ –∏–∑ —Å–ª–æ–≤–∞—Ä–µ–π)
    assert set(rows[0].keys()) == {"name", "age", "city"}
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏
    assert rows[0]["name"] == "–ê–Ω–Ω–∞"
    assert rows[0]["age"] == "25"  # –í CSV –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç—Ä–æ–∫–æ–≤—ã–µ
    assert rows[0]["city"] == "–ú–æ—Å–∫–≤–∞"


def test_csv_to_json_basic(tmp_path):
    """
    –¢–µ—Å—Ç –±–∞–∑–æ–≤–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ CSV ‚Üí JSON.
    
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç CSV —Ñ–∞–π–ª —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º
    –≤ JSON-–º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤.
    
    –®–∞–≥–∏ —Ç–µ—Å—Ç–∞:
        1. –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π CSV —Ñ–∞–π–ª
        2. –í—ã–∑—ã–≤–∞–µ–º csv_to_json()
        3. –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ JSON —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω
        4. –ß–∏—Ç–∞–µ–º JSON –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É
    
    –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:
        - JSON —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ = 3
        - –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–µ—Ä–≤–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞
    """
    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞: —Å–æ–∑–¥–∞–µ–º –ø—É—Ç–∏ –∫ –≤—Ä–µ–º–µ–Ω–Ω—ã–º —Ñ–∞–π–ª–∞–º
    csv_path = tmp_path / "test.csv"
    json_path = tmp_path / "test.json"
    
    # –°–æ–∑–¥–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ CSV —Ñ–∞–π–ª–∞
    csv_content = """name,age,city
–ê–Ω–Ω–∞,25,–ú–æ—Å–∫–≤–∞
–ü–µ—Ç—Ä,30,–°–ü–±
–ú–∞—Ä–∏—è,28,–ö–∞–∑–∞–Ω—å"""
    
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º CSV –≤ —Ñ–∞–π–ª
    csv_path.write_text(csv_content, encoding='utf-8')
    
    # –î–µ–π—Å—Ç–≤–∏–µ: –≤—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
    csv_to_json(str(csv_path), str(json_path))
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: JSON —Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω
    assert json_path.exists()
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: —á–∏—Ç–∞–µ–º JSON –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
    with open(json_path, 'r', encoding='utf-8') as f:
        data = json.load(f)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤
    assert len(data) == 3
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–µ—Ä–≤–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞
    assert data[0] == {"name": "–ê–Ω–Ω–∞", "age": "25", "city": "–ú–æ—Å–∫–≤–∞"}
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤—Ç–æ—Ä–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞
    assert data[1] == {"name": "–ü–µ—Ç—Ä", "age": "30", "city": "–°–ü–±"}


def test_json_to_csv_empty_list(tmp_path):
    """
    –¢–µ—Å—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—É—Å—Ç–æ–≥–æ JSON –º–∞—Å—Å–∏–≤–∞.
    
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç ValueError
    –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—É—Å—Ç–æ–π JSON –º–∞—Å—Å–∏–≤.
    
    –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:
        - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏—Å–∫–ª—é—á–µ–Ω–∏–µ ValueError
        - –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–æ–≤–æ "–ü—É—Å—Ç–æ–π"
    """
    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞: —Å–æ–∑–¥–∞–µ–º JSON —Ñ–∞–π–ª —Å –ø—É—Å—Ç—ã–º –º–∞—Å—Å–∏–≤–æ–º
    json_path = tmp_path / "empty.json"
    csv_path = tmp_path / "empty.csv"
    
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ –≤ JSON
    json_path.write_text('[]', encoding='utf-8')
    
    # –î–µ–π—Å—Ç–≤–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞: –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞ ValueError
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º pytest.raises –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
    with pytest.raises(ValueError, match=".*–ü—É—Å—Ç–æ–π.*"):
        json_to_csv(str(json_path), str(csv_path))


def test_json_to_csv_invalid_json(tmp_path):
    """
    –¢–µ—Å—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ JSON.
    
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç ValueError
    –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π JSON.
    
    –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:
        - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏—Å–∫–ª—é—á–µ–Ω–∏–µ ValueError
        - –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ —Å–æ–¥–µ—Ä–∂–∏—Ç "JSON"
    """
    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞: —Å–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª —Å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º JSON
    json_path = tmp_path / "invalid.json"
    csv_path = tmp_path / "test.csv"
    
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π JSON
    json_path.write_text('{not valid json}', encoding='utf-8')
    
    # –î–µ–π—Å—Ç–≤–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞: –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞ ValueError
    with pytest.raises(ValueError, match=".*JSON.*"):
        json_to_csv(str(json_path), str(csv_path))


def test_csv_to_json_missing_file():
    """
    –¢–µ—Å—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–µ–≥–æ CSV —Ñ–∞–π–ª–∞.
    
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç FileNotFoundError
    –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª.
    
    –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:
        - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏—Å–∫–ª—é—á–µ–Ω–∏–µ FileNotFoundError
    """
    # –î–µ–π—Å—Ç–≤–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞: –ø—ã—Ç–∞–µ–º—Å—è –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª
    with pytest.raises(FileNotFoundError):
        csv_to_json("–Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π_—Ñ–∞–π–ª.csv", "output.json")


def test_json_to_csv_missing_file():
    """
    –¢–µ—Å—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–µ–≥–æ JSON —Ñ–∞–π–ª–∞.
    
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç FileNotFoundError
    –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª.
    
    –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:
        - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏—Å–∫–ª—é—á–µ–Ω–∏–µ FileNotFoundError
    """
    # –î–µ–π—Å—Ç–≤–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞: –ø—ã—Ç–∞–µ–º—Å—è –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª
    with pytest.raises(FileNotFoundError):
        json_to_csv("–Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π_—Ñ–∞–π–ª.json", "output.csv")


def test_json_to_csv_roundtrip(tmp_path):
    """
    –¢–µ—Å—Ç –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ JSON ‚Üí CSV ‚Üí JSON.
    
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ –¥–≤–æ–π–Ω–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏:
    JSON ‚Üí CSV ‚Üí JSON.
    
    –®–∞–≥–∏ —Ç–µ—Å—Ç–∞:
        1. –°–æ–∑–¥–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π JSON
        2. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ CSV
        3. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º CSV –æ–±—Ä–∞—Ç–Ω–æ –≤ JSON
        4. –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å –∏—Å—Ö–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
    
    –í–∞–∂–Ω–æ: –ü—Ä–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤ CSV –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —Å—Ç—Ä–æ–∫–∞–º–∏,
    –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ –Ω—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å —ç—Ç–æ—Ç —Ñ–∞–∫—Ç.
    
    –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:
        - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
        - –ò–º–µ–Ω–∞ –ø–æ–ª–µ–π —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
        - –ß–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ —Å—Ç—Ä–æ–∫–∏
    """
    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞: –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    original_data = [
        {"name": "Test", "value": 123},
        {"name": "Another", "value": 456}
    ]
    
    # –°–æ–∑–¥–∞–µ–º –ø—É—Ç–∏ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
    json_path = tmp_path / "original.json"
    csv_path = tmp_path / "converted.csv"
    json_path2 = tmp_path / "back.json"
    
    # –®–∞–≥ 1: –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ JSON
    json_path.write_text(json.dumps(original_data), encoding='utf-8')
    
    # –®–∞–≥ 2: –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º JSON ‚Üí CSV
    json_to_csv(str(json_path), str(csv_path))
    
    # –®–∞–≥ 3: –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º CSV ‚Üí JSON
    csv_to_json(str(csv_path), str(json_path2))
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞: —á–∏—Ç–∞–µ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    with open(json_path2, 'r', encoding='utf-8') as f:
        restored_data = json.load(f)
    
    # –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ 1: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –¥–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å
    assert len(restored_data) == len(original_data)
    
    # –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ 2: —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–ª—è –¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å
    assert restored_data[0]["name"] == original_data[0]["name"]
    
    # –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ 3: —á–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ —Å—Ç—Ä–æ–∫–∏
    # –í CSV –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç—Ä–æ–∫–æ–≤—ã–µ, –ø–æ—ç—Ç–æ–º—É –≤ JSON –æ–Ω–∏ —Ç–æ–∂–µ –±—É–¥—É—Ç —Å—Ç—Ä–æ–∫–∞–º–∏
    assert restored_data[0]["value"] == str(original_data[0]["value"])

```

# test_text.py:

``` python
"""
–ú–æ–¥—É–ª—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–∞ –∏–∑ lab03.

–¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏:
- count_freq() - –ø–æ–¥—Å—á–µ—Ç —á–∞—Å—Ç–æ—Ç—ã —Å–ª–æ–≤
- top_n() - –ø–æ–ª—É—á–µ–Ω–∏–µ N —Å–∞–º—ã—Ö —á–∞—Å—Ç—ã—Ö —Å–ª–æ–≤

–ö–∞–∂–¥—ã–π —Ç–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –∞—Å–ø–µ–∫—Ç —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–π:
- –ë–∞–∑–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (–Ω–æ—Ä–º–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞)
- –ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏ (–ø—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ, –æ–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç)
- –û—Å–æ–±—ã–µ —Å–ª—É—á–∞–∏ (—Ä–∞–≤–Ω—ã–µ —á–∞—Å—Ç–æ—Ç—ã, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞)
"""

import sys
import os

# –î–æ–±–∞–≤–ª—è–µ–º –∫–æ—Ä–Ω–µ–≤—É—é –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞ –≤ –ø—É—Ç—å Python
# –≠—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞ –º–æ–¥—É–ª–µ–π –∏–∑ src/
sys.path.insert(0, os.path.abspath('.'))

# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ç–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ lab03
from src.lab03.text_stats import count_freq, top_n


def test_count_freq_basic():
    """
    –¢–µ—Å—Ç –±–∞–∑–æ–≤–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ count_freq.
    
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç —á–∞—Å—Ç–æ—Ç—É —Å–ª–æ–≤
    –≤ –ø—Ä–æ—Å—Ç–æ–º —Å–ø–∏—Å–∫–µ —Å –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–º–∏—Å—è —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏.
    
    –ü—Ä–∏–º–µ—Ä:
        –í—Ö–æ–¥: ["apple", "banana", "apple", "cherry", "banana", "apple"]
        –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {"apple": 3, "banana": 2, "cherry": 1}
    
    –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:
        - –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤ = 3
        - –ß–∞—Å—Ç–æ—Ç–∞ "apple" = 3
        - –ß–∞—Å—Ç–æ—Ç–∞ "banana" = 2  
        - –ß–∞—Å—Ç–æ—Ç–∞ "cherry" = 1
    """
    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞: —Å–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
    tokens = ["apple", "banana", "apple", "cherry", "banana", "apple"]
    
    # –î–µ–π—Å—Ç–≤–∏–µ: –≤—ã–∑—ã–≤–∞–µ–º —Ç–µ—Å—Ç–∏—Ä—É–µ–º—É—é —Ñ—É–Ω–∫—Ü–∏—é
    result = count_freq(tokens)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞: –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–±—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    assert result == {"apple": 3, "banana": 2, "cherry": 1}
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤
    assert len(result) == 3
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á–∞—Å—Ç–æ—Ç—É –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞
    assert result["apple"] == 3
    assert result["banana"] == 2
    assert result["cherry"] == 1


def test_count_freq_empty():
    """
    –¢–µ—Å—Ç –≥—Ä–∞–Ω–∏—á–Ω–æ–≥–æ —Å–ª—É—á–∞—è: –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫.
    
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—É—Å—Ç–æ–π –≤–≤–æ–¥.
    –û–∂–∏–¥–∞–µ—Ç—Å—è —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç –ø—É—Å—Ç—ã–º —Å–ª–æ–≤–∞—Ä–µ–º.
    
    –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:
        - –†–µ–∑—É–ª—å—Ç–∞—Ç = –ø—É—Å—Ç–æ–π —Å–ª–æ–≤–∞—Ä—å {}
    """
    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞: –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫
    tokens = []
    
    # –î–µ–π—Å—Ç–≤–∏–µ: –≤—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é
    result = count_freq(tokens)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞: –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å—Å—è –ø—É—Å—Ç–æ–π —Å–ª–æ–≤–∞—Ä—å
    assert result == {}


def test_count_freq_single_word():
    """
    –¢–µ—Å—Ç —Å–ª—É—á–∞—è —Å –æ–¥–Ω–∏–º –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–º—Å—è —Å–ª–æ–≤–æ–º.
    
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å—á–∏—Ç–∞–µ—Ç —á–∞—Å—Ç–æ—Ç—É
    –∫–æ–≥–¥–∞ –≤—Å–µ —Å–ª–æ–≤–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ.
    
    –ü—Ä–∏–º–µ—Ä:
        –í—Ö–æ–¥: ["hello", "hello", "hello", "hello", "hello"]
        –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {"hello": 5}
    
    –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:
        - –¢–æ–ª—å–∫–æ –æ–¥–Ω–æ —Å–ª–æ–≤–æ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ
        - –ß–∞—Å—Ç–æ—Ç–∞ —ç—Ç–æ–≥–æ —Å–ª–æ–≤–∞ = 5
    """
    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞: —Å–ø–∏—Å–æ–∫ –∏–∑ 5 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–ª–æ–≤
    tokens = ["hello"] * 5
    
    # –î–µ–π—Å—Ç–≤–∏–µ: –≤—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é
    result = count_freq(tokens)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞: –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–¥–∏–Ω –∫–ª—é—á —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º 5
    assert result == {"hello": 5}


def test_top_n_basic():
    """
    –¢–µ—Å—Ç –±–∞–∑–æ–≤–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ top_n.
    
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç N —Å–∞–º—ã—Ö —á–∞—Å—Ç—ã—Ö —Å–ª–æ–≤.
    
    –ü—Ä–∏–º–µ—Ä:
        –í—Ö–æ–¥: {"a": 5, "b": 3, "c": 10, "d": 1, "e": 7}, n=3
        –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: [("c", 10), ("e", 7), ("a", 5)]
    
    –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:
        - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Ä–æ–≤–Ω–æ N —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        - –≠–ª–µ–º–µ–Ω—Ç—ã –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ —É–±—ã–≤–∞–Ω–∏—é —á–∞—Å—Ç–æ—Ç—ã
        - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    """
    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞: —Å–æ–∑–¥–∞–µ–º —Å–ª–æ–≤–∞—Ä—å —á–∞—Å—Ç–æ—Ç
    freq = {"a": 5, "b": 3, "c": 10, "d": 1, "e": 7}
    
    # –î–µ–π—Å—Ç–≤–∏–µ: –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Ç–æ–ø-3 —Å–ª–æ–≤–∞
    result = top_n(freq, 3)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞: –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –≤–µ—Ä–Ω—É–ª–æ—Å—å —Ä–æ–≤–Ω–æ 3 —ç–ª–µ–º–µ–Ω—Ç–∞
    assert len(result) == 3
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ (–ø–æ —É–±—ã–≤–∞–Ω–∏—é —á–∞—Å—Ç–æ—Ç—ã)
    assert result == [("c", 10), ("e", 7), ("a", 5)]


def test_top_n_all():
    """
    –¢–µ—Å—Ç –∫–æ–≥–¥–∞ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è –±–æ–ª—å—à–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —á–µ–º –µ—Å—Ç—å.
    
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–∏—Ç—É–∞—Ü–∏—é
    –∫–æ–≥–¥–∞ n –±–æ–ª—å—à–µ —á–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤.
    
    –ü—Ä–∏–º–µ—Ä:
        –í—Ö–æ–¥: {"a": 1, "b": 2, "c": 3}, n=10
        –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: [("c", 3), ("b", 2), ("a", 1)]
    
    –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:
        - –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
        - –≠–ª–µ–º–µ–Ω—Ç—ã –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ —É–±—ã–≤–∞–Ω–∏—é —á–∞—Å—Ç–æ—Ç—ã
    """
    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞: —Å–ª–æ–≤–∞—Ä—å —Å 3 —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏
    freq = {"a": 1, "b": 2, "c": 3}
    
    # –î–µ–π—Å—Ç–≤–∏–µ: –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º 10 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (–±–æ–ª—å—à–µ —á–µ–º –µ—Å—Ç—å)
    result = top_n(freq, 10)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞: –¥–æ–ª–∂–Ω—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤—Å–µ 3 —ç–ª–µ–º–µ–Ω—Ç–∞
    assert result == [("c", 3), ("b", 2), ("a", 1)]


def test_top_n_tie_breaker():
    """
    –¢–µ—Å—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø—Ä–∏ —Ä–∞–≤–Ω—ã—Ö —á–∞—Å—Ç–æ—Ç–∞—Ö.
    
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ –ø—Ä–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π —á–∞—Å—Ç–æ—Ç–µ —Å–ª–æ–≤–∞
    —Å–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É (–≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é).
    
    –ü—Ä–∏–º–µ—Ä:
        –í—Ö–æ–¥: {"z": 5, "a": 5, "m": 5, "b": 2}, n=3
        –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: [("a", 5), ("m", 5), ("z", 5)]
    
    –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:
        - –°–Ω–∞—á–∞–ª–∞ –∏–¥—É—Ç —Å–ª–æ–≤–∞ —Å —á–∞—Å—Ç–æ—Ç–æ–π 5
        - –°–ª–æ–≤–∞ —Å —Ä–∞–≤–Ω–æ–π —á–∞—Å—Ç–æ—Ç–æ–π –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É
        - –°–ª–æ–≤–æ "b" —Å —á–∞—Å—Ç–æ—Ç–æ–π 2 –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ —Ç–æ–ø-3
    """
    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞: —Å–ª–æ–≤–∞—Ä—å –≥–¥–µ 3 —Å–ª–æ–≤–∞ –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é —á–∞—Å—Ç–æ—Ç—É
    freq = {"z": 5, "a": 5, "m": 5, "b": 2}
    
    # –î–µ–π—Å—Ç–≤–∏–µ: –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Ç–æ–ø-3
    result = top_n(freq, 3)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞: —Å–ª–æ–≤–∞ —Å —Ä–∞–≤–Ω–æ–π —á–∞—Å—Ç–æ—Ç–æ–π –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É
    # –û–∂–∏–¥–∞–µ–º: ("a", 5), ("m", 5), ("z", 5)
    assert result == [("a", 5), ("m", 5), ("z", 5)]


def test_top_n_zero_n():
    """
    –¢–µ—Å—Ç –≥—Ä–∞–Ω–∏—á–Ω–æ–≥–æ —Å–ª—É—á–∞—è: n = 0.
    
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å
    0 —Å–∞–º—ã—Ö —á–∞—Å—Ç—ã—Ö —Å–ª–æ–≤.
    
    –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:
        - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫
    """
    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞: –æ–±—ã—á–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å —á–∞—Å—Ç–æ—Ç
    freq = {"a": 1, "b": 2}
    
    # –î–µ–π—Å—Ç–≤–∏–µ: –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º 0 —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    result = top_n(freq, 0)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞: –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å—Å—è –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫
    assert result == []


def test_top_n_default():
    """
    –¢–µ—Å—Ç —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
    
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è top_n —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
    –∫–æ–≥–¥–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä n –Ω–µ —É–∫–∞–∑–∞–Ω (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é = 5).
    
    –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:
        - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è 5 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
        - –°–∞–º—ã–π —á–∞—Å—Ç—ã–π —ç–ª–µ–º–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
    """
    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞: —Å–ª–æ–≤–∞—Ä—å —Å 6 —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏
    freq = {"a": 1, "b": 2, "c": 3, "d": 4, "e": 5, "f": 6}
    
    # –î–µ–π—Å—Ç–≤–∏–µ: –≤—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ n
    result = top_n(freq)  # –¥–æ–ª–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è n=5 –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞: –¥–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è 5 —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    assert len(result) == 5
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞: —Å–∞–º—ã–π —á–∞—Å—Ç—ã–π —ç–ª–µ–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å "f" —Å —á–∞—Å—Ç–æ—Ç–æ–π 6
    assert result[0] == ("f", 6)

```

# –¢–µ—Å—Ç—ã –∏ –≤—ã–≤–æ–¥—ã:

**–í—ã–≤–æ–¥—ã —Ç–µ—Å—Ç–æ–≤:**

![alt text](<images/lab07/test1.png>)

**–í—ã–≤–æ–¥ –∞–≤—Ç–æ—Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä–∞ black+black check:**

![alt text](<images/lab07/black-check.png>)

**–í—ã–≤–æ–¥—ã pyptoject.toml:**

![alt text](<images/lab07/toml.png>)


# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 8 - –û–û–ü –≤ Python: @dataclass Student

## –û–ø–∏—Å–∞–Ω–∏–µ
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∞—Å—Å–∞ Student —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞ `@dataclass`, –≤–∫–ª—é—á–∞—è –º–µ—Ç–æ–¥—ã, –≤–∞–ª–∏–¥–∞—Ü–∏—é –∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—é.

## –ö–ª–∞—Å—Å Student

### –ü–æ–ª—è
- `fio` (str): –§–ò–û —Å—Ç—É–¥–µ–Ω—Ç–∞
- `birthdate` (str): –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ YYYY-MM-DD
- `group` (str): –ù–æ–º–µ—Ä –≥—Ä—É–ø–ø—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, "SE-01")
- `gpa` (float): –°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª (–æ—Ç 0 –¥–æ 5)

### –ú–µ—Ç–æ–¥—ã
- `age()`: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–æ–∑—Ä–∞—Å—Ç —Å—Ç—É–¥–µ–Ω—Ç–∞ –≤ –ø–æ–ª–Ω—ã—Ö –≥–æ–¥–∞—Ö
- `to_dict()`: –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –æ–±—ä–µ–∫—Ç –≤ —Å–ª–æ–≤–∞—Ä—å
- `from_dict()`: –°–æ–∑–¥–∞—ë—Ç –æ–±—ä–µ–∫—Ç –∏–∑ —Å–ª–æ–≤–∞—Ä—è (classmethod)
- `__str__()`: –°—Ç—Ä–æ–∫–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—É–¥–µ–Ω—Ç–∞

### –í–∞–ª–∏–¥–∞—Ü–∏—è
- –§–æ—Ä–º–∞—Ç –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è: YYYY-MM-DD
- –î–∏–∞–ø–∞–∑–æ–Ω —Å—Ä–µ–¥–Ω–µ–≥–æ –±–∞–ª–ª–∞: 0 ‚â§ gpa ‚â§ 5
- –§–ò–û –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 2 —Å–ª–æ–≤–∞

## –ú–æ–¥—É–ª—å —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏

## –§—É–Ω–∫—Ü–∏–∏
- `students_to_json(students, path)`: –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –≤ JSON
- `students_from_json(path) -> list[Student]`: –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏–∑ JSON
- `export_students_csv(students, path)`: –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –≤ CSV
- `print_students_table(students)`: –í—ã–≤–æ–¥–∏—Ç —Ç–∞–±–ª–∏—Ü—É —Å—Ç—É–¥–µ–Ω—Ç–æ–≤

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```python
from src.lab08.models import Student
from src.lab08.serialize import students_to_json, students_from_json

# –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—É–¥–µ–Ω—Ç–∞
student = Student(
    fio="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
    birthdate="2000-05-15",
    group="SE-01",
    gpa=4.5
)

print(student)  # –ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á, SE-01, GPA: 4.50, –≤–æ–∑—Ä–∞—Å—Ç: 25 –ª–µ—Ç
print(f"–í–æ–∑—Ä–∞—Å—Ç: {student.age()} –ª–µ—Ç")  # –í–æ–∑—Ä–∞—Å—Ç: 25 –ª–µ—Ç

# –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è
students_to_json([student], "data/lab08/output.json")

# –î–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è
loaded_students = students_from_json("data/lab08/output.json")
```

**Models.py:**

``` python
from dataclasses import dataclass, asdict
from datetime import datetime, date
from typing import Self

@dataclass
class Student:
    """
    –ö–ª–∞—Å—Å, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞.
    
    Attributes:
        fio: –§–ò–û —Å—Ç—É–¥–µ–Ω—Ç–∞
        birthdate: –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ YYYY-MM-DD
        group: –ù–æ–º–µ—Ä –≥—Ä—É–ø–ø—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, 'SE-01')
        gpa: –°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª (–æ—Ç 0 –¥–æ 5)
    """
    
    fio: str
    birthdate: str
    group: str
    gpa: float
    
    def __post_init__(self):
        """
        –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–∞.
        –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ __init__.
        """
        # –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è
        try:
            datetime.strptime(self.birthdate, "%Y-%m-%d")
        except ValueError:
            raise ValueError(f"–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã: {self.birthdate}. –û–∂–∏–¥–∞–µ—Ç—Å—è YYYY-MM-DD")
        
        # –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ä–µ–¥–Ω–µ–≥–æ –±–∞–ª–ª–∞
        if not (0 <= self.gpa <= 5):
            raise ValueError(f"–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 0 –¥–æ 5, –ø–æ–ª—É—á–µ–Ω–æ: {self.gpa}")
        
        # –í–∞–ª–∏–¥–∞—Ü–∏—è –§–ò–û (–¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–±–µ–ª—ã)
        if len(self.fio.split()) < 2:
            raise ValueError(f"–§–ò–û –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º –¥–≤–∞ —Å–ª–æ–≤–∞: {self.fio}")
    
    def age(self) -> int:
        """
        –í—ã—á–∏—Å–ª—è–µ—Ç –≤–æ–∑—Ä–∞—Å—Ç —Å—Ç—É–¥–µ–Ω—Ç–∞ –≤ –ø–æ–ª–Ω—ã—Ö –≥–æ–¥–∞—Ö.
        
        Returns:
            –í–æ–∑—Ä–∞—Å—Ç —Å—Ç—É–¥–µ–Ω—Ç–∞ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª–Ω—ã—Ö –ª–µ—Ç)
        """
        birth_date = datetime.strptime(self.birthdate, "%Y-%m-%d").date()
        today = date.today()
        
        # –í—ã—á–∏—Å–ª—è–µ–º –≤–æ–∑—Ä–∞—Å—Ç
        age = today.year - birth_date.year
        
        # –£—á–∏—Ç—ã–≤–∞–µ–º, –±—ã–ª –ª–∏ —É–∂–µ –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è –≤ —ç—Ç–æ–º –≥–æ–¥—É
        if (today.month, today.day) < (birth_date.month, birth_date.day):
            age -= 1
        
        return age
    
    def to_dict(self) -> dict:
        """
        –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –æ–±—ä–µ–∫—Ç Student –≤ —Å–ª–æ–≤–∞—Ä—å.
        
        Returns:
            –°–ª–æ–≤–∞—Ä—å —Å –¥–∞–Ω–Ω—ã–º–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞
        """
        return {
            "fio": self.fio,
            "birthdate": self.birthdate,
            "group": self.group,
            "gpa": self.gpa
        }
    
    @classmethod
    def from_dict(cls, data: dict) -> Self:
        """
        –°–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç Student –∏–∑ —Å–ª–æ–≤–∞—Ä—è.
        
        Args:
            data: –°–ª–æ–≤–∞—Ä—å —Å –¥–∞–Ω–Ω—ã–º–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞
            
        Returns:
            –û–±—ä–µ–∫—Ç –∫–ª–∞—Å—Å–∞ Student
        """
        return cls(
            fio=data.get("fio", ""),
            birthdate=data.get("birthdate", ""),
            group=data.get("group", ""),
            gpa=data.get("gpa", 0.0)
        )
    
    def __str__(self) -> str:
        """
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—É–¥–µ–Ω—Ç–∞.
        
        Returns:
            –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å—Ç—É–¥–µ–Ω—Ç–µ
        """
        return f"{self.fio}, {self.group}, GPA: {self.gpa:.2f}, –≤–æ–∑—Ä–∞—Å—Ç: {self.age()} –ª–µ—Ç"


# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å–ø–∏—Å–∫–æ–º —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
@dataclass
class StudentList:
    """–ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å–ø–∏—Å–∫–æ–º —Å—Ç—É–¥–µ–Ω—Ç–æ–≤."""
    
    students: list[Student]
    
    def add_student(self, student: Student):
        """–î–æ–±–∞–≤–ª—è–µ—Ç —Å—Ç—É–¥–µ–Ω—Ç–∞ –≤ —Å–ø–∏—Å–æ–∫."""
        self.students.append(student)
    
    def get_by_group(self, group: str) -> list[Student]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –≥—Ä—É–ø–ø—ã."""
        return [s for s in self.students if s.group == group]
    
    def get_top_students(self, n: int = 5) -> list[Student]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ø-N —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø–æ —Å—Ä–µ–¥–Ω–µ–º—É –±–∞–ª–ª—É."""
        return sorted(self.students, key=lambda s: s.gpa, reverse=True)[:n]
    
    def average_gpa(self) -> float:
        """–í—ã—á–∏—Å–ª—è–µ—Ç —Å—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª –ø–æ –≤—Å–µ–º —Å—Ç—É–¥–µ–Ω—Ç–∞–º."""
        if not self.students:
            return 0.0
        return sum(s.gpa for s in self.students) / len(self.students)

```


**Models.py:**

``` python
import json
from pathlib import Path
from typing import List
from .models import Student

def students_to_json(students: List[Student], path: str) -> None:
    """
    –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –≤ JSON —Ñ–∞–π–ª.
    
    Args:
        students: –°–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤ Student
        path: –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è JSON —Ñ–∞–π–ª–∞
        
    Raises:
        ValueError: –ï—Å–ª–∏ —Å–ø–∏—Å–æ–∫ –ø—É—Å—Ç
        IOError: –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö –∑–∞–ø–∏—Å–∏ —Ñ–∞–π–ª–∞
    """
    if not students:
        raise ValueError("–°–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø—É—Å—Ç")
    
    # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –≤ —Å–ª–æ–≤–∞—Ä–∏
    data = [student.to_dict() for student in students]
    
    # –°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
    file_path = Path(path)
    file_path.parent.mkdir(parents=True, exist_ok=True)
    
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ —Ñ–∞–π–ª
    with open(file_path, 'w', encoding='utf-8') as f:
        json.dump(data, f, ensure_ascii=False, indent=2, default=str)
    
    print(f"‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ {path}")

def students_from_json(path: str) -> List[Student]:
    """
    –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏–∑ JSON —Ñ–∞–π–ª–∞.
    
    Args:
        path: –ü—É—Ç—å –∫ JSON —Ñ–∞–π–ª—É
        
    Returns:
        –°–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤ Student
        
    Raises:
        FileNotFoundError: –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω
        ValueError: –ï—Å–ª–∏ JSON –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω
    """
    file_path = Path(path)
    
    if not file_path.exists():
        raise FileNotFoundError(f"–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: {path}")
    
    try:
        with open(file_path, 'r', encoding='utf-8') as f:
            data = json.load(f)
    except json.JSONDecodeError as e:
        raise ValueError(f"–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è JSON: {e}")
    
    if not isinstance(data, list):
        raise ValueError("JSON –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ø–∏—Å–æ–∫")
    
    # –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç—ã Student –∏–∑ —Å–ª–æ–≤–∞—Ä–µ–π
    students = []
    for i, item in enumerate(data, 1):
        try:
            student = Student.from_dict(item)
            students.append(student)
        except Exception as e:
            raise ValueError(f"–û—à–∏–±–∫–∞ –≤ –∑–∞–ø–∏—Å–∏ {i}: {e}")
    
    print(f"‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ {len(students)} —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏–∑ {path}")
    return students


# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏
def export_students_csv(students: List[Student], path: str) -> None:
    """
    –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –≤ CSV —Ñ–∞–π–ª.
    
    Args:
        students: –°–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤ Student
        path: –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è CSV —Ñ–∞–π–ª–∞
    """
    import csv
    
    if not students:
        raise ValueError("–°–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø—É—Å—Ç")
    
    file_path = Path(path)
    file_path.parent.mkdir(parents=True, exist_ok=True)
    
    with open(file_path, 'w', encoding='utf-8', newline='') as f:
        writer = csv.writer(f)
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        writer.writerow(['–§–ò–û', '–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è', '–ì—Ä—É–ø–ø–∞', '–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª', '–í–æ–∑—Ä–∞—Å—Ç'])
        
        # –î–∞–Ω–Ω—ã–µ
        for student in students:
            writer.writerow([
                student.fio,
                student.birthdate,
                student.group,
                student.gpa,
                student.age()
            ])
    
    print(f"‚úÖ –î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ CSV: {path}")

def print_students_table(students: List[Student]) -> None:
    """
    –í—ã–≤–æ–¥–∏—Ç —Ç–∞–±–ª–∏—Ü—É —Å–æ —Å–ø–∏—Å–∫–æ–º —Å—Ç—É–¥–µ–Ω—Ç–æ–≤.
    
    Args:
        students: –°–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤ Student
    """
    if not students:
        print("üì≠ –°–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø—É—Å—Ç")
        return
    
    print("\n" + "="*80)
    print(f"{'‚Ññ':<3} {'–§–ò–û':<30} {'–ì—Ä—É–ø–ø–∞':<10} {'GPA':<6} {'–í–æ–∑—Ä–∞—Å—Ç':<8}")
    print("="*80)
    
    for i, student in enumerate(students, 1):
        print(f"{i:<3} {student.fio:<30} {student.group:<10} {student.gpa:<6.2f} {student.age():<8}")
    
    print("="*80)
    print(f"–í—Å–µ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤: {len(students)}")
    print(f"–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª: {sum(s.gpa for s in students)/len(students):.2f}")

```

## –¢–µ—Å—Ç—ã –∏ –≤—ã–≤–æ–¥—ã:

**–í—ã–≤–æ–¥—ã —Ç–µ—Å—Ç–æ–≤:**

![alt text](<images/lab08/test1.png>)

**–í–≤–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤:**

![alt text](<images/lab08/input.png>)

**–í—ã–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –≤ json:**

![alt text](<images/lab08/output.png>)

**–í—ã–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –≤ csv(–≤ —Ç–∞–±–ª–∏—Ü–µ Exel):**

![alt text](<images/lab08/exel.png>)


# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 9 - ¬´–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö¬ª –Ω–∞ CSV

## –û–ø–∏—Å–∞–Ω–∏–µ
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∞—Å—Å–∞ `Group` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ CSV. 
–ö–ª–∞—Å—Å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä CRUD-–æ–ø–µ—Ä–∞—Ü–∏–π (Create, Read, Update, Delete).

## group.py
``` python
import csv
from pathlib import Path
from typing import List, Optional
from dataclasses import asdict

# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º Student –∏–∑ –õ–†8
try:
    from src.lab08.models import Student
except ImportError:
    # –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    from dataclasses import dataclass
    from datetime import datetime, date
    
    @dataclass
    class Student:
        fio: str
        birthdate: str
        group: str
        gpa: float
        
        def age(self) -> int:
            birth_date = datetime.strptime(self.birthdate, "%Y-%m-%d").date()
            today = date.today()
            age = today.year - birth_date.year
            if (today.month, today.day) < (birth_date.month, birth_date.day):
                age -= 1
            return age
        
        def to_dict(self) -> dict:
            return {
                "fio": self.fio,
                "birthdate": self.birthdate,
                "group": self.group,
                "gpa": self.gpa
            }
        
        @classmethod
        def from_dict(cls, data: dict):
            return cls(**data)


class Group:
    """
    –ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥—Ä—É–ø–ø–æ–π —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, —Ö—Ä–∞–Ω—è—â–µ–π—Å—è –≤ CSV-—Ñ–∞–π–ª–µ.
    –†–µ–∞–ª–∏–∑—É–µ—Ç CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏ (Create, Read, Update, Delete).
    """
    
    def __init__(self, storage_path: str):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä—É–ø–ø—ã —Å—Ç—É–¥–µ–Ω—Ç–æ–≤.
        
        Args:
            storage_path: –ü—É—Ç—å –∫ CSV-—Ñ–∞–π–ª—É –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
        """
        self.path = Path(storage_path)
        self._ensure_storage_exists()
    
    def _ensure_storage_exists(self) -> None:
        """
        –°–æ–∑–¥–∞—ë—Ç —Ñ–∞–π–ª —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏, –µ—Å–ª–∏ –æ–Ω –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.
        """
        if not self.path.exists():
            self.path.parent.mkdir(parents=True, exist_ok=True)
            with open(self.path, 'w', encoding='utf-8', newline='') as f:
                writer = csv.DictWriter(f, fieldnames=["fio", "birthdate", "group", "gpa"])
                writer.writeheader()
            print(f"üìÅ –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π —Ñ–∞–π–ª –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: {self.path}")
    
    def _read_all(self) -> List[dict]:
        """
        –ß–∏—Ç–∞–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ CSV-—Ñ–∞–π–ª–∞.
        
        Returns:
            –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π —Å –¥–∞–Ω–Ω—ã–º–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
        """
        with open(self.path, 'r', encoding='utf-8') as f:
            reader = csv.DictReader(f)
            return list(reader)
    
    def _write_all(self, rows: List[dict]) -> None:
        """
        –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –≤ CSV-—Ñ–∞–π–ª.
        
        Args:
            rows: –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π —Å –¥–∞–Ω–Ω—ã–º–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
        """
        with open(self.path, 'w', encoding='utf-8', newline='') as f:
            writer = csv.DictWriter(f, fieldnames=["fio", "birthdate", "group", "gpa"])
            writer.writeheader()
            writer.writerows(rows)
    
    def list(self) -> List[Student]:
        """
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤.
        
        Returns:
            –°–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤ Student
        """
        rows = self._read_all()
        students = []
        
        for row in rows:
            try:
                # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º GPA –∏–∑ —Å—Ç—Ä–æ–∫–∏ –≤ float
                row['gpa'] = float(row['gpa'])
                student = Student.from_dict(row)
                students.append(student)
            except (ValueError, KeyError) as e:
                print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞ {row.get('fio', 'unknown')}: {e}")
        
        return students
    
    def add(self, student: Student) -> None:
        """
        –î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.
        
        Args:
            student: –û–±—ä–µ–∫—Ç Student –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
        """
        # –ß–∏—Ç–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
        rows = self._read_all()
        
        # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞
        rows.append(student.to_dict())
        
        # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω–æ
        self._write_all(rows)
        
        print(f"–°—Ç—É–¥–µ–Ω—Ç {student.fio} —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω")
    
    def find(self, substr: str) -> List[Student]:
        """
        –ò—â–µ—Ç —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–µ –≤ –§–ò–û.
        
        Args:
            substr: –ü–æ–¥—Å—Ç—Ä–æ–∫–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –≤ –§–ò–û
            
        Returns:
            –°–ø–∏—Å–æ–∫ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
        """
        all_students = self.list()
        substr_lower = substr.lower()
        
        found = [s for s in all_students if substr_lower in s.fio.lower()]
        
        if found:
            print(f"–ù–∞–π–¥–µ–Ω–æ {len(found)} —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø–æ –∑–∞–ø—Ä–æ—Å—É '{substr}'")
        else:
            print(f"–°—Ç—É–¥–µ–Ω—Ç—ã –ø–æ –∑–∞–ø—Ä–æ—Å—É '{substr}' –Ω–µ –Ω–∞–π–¥–µ–Ω—ã")
        
        return found
    
    def remove(self, fio: str) -> bool:
        """
        –£–¥–∞–ª—è–µ—Ç —Å—Ç—É–¥–µ–Ω—Ç–∞ –ø–æ –§–ò–û.
        
        Args:
            fio: –§–ò–û —Å—Ç—É–¥–µ–Ω—Ç–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
            
        Returns:
            True –µ—Å–ª–∏ —Å—Ç—É–¥–µ–Ω—Ç –±—ã–ª —É–¥–∞–ª—ë–Ω, False –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω
        """
        rows = self._read_all()
        original_count = len(rows)
        
        # –£–¥–∞–ª—è–µ–º –≤—Å–µ—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º –§–ò–û
        rows = [row for row in rows if row['fio'] != fio]
        
        if len(rows) < original_count:
            self._write_all(rows)
            print(f"–°—Ç—É–¥–µ–Ω—Ç {fio} —É–¥–∞–ª—ë–Ω")
            return True
        else:
            print(f"–°—Ç—É–¥–µ–Ω—Ç {fio} –Ω–µ –Ω–∞–π–¥–µ–Ω")
            return False
    
    def update(self, fio: str, **fields) -> bool:
        """
        –û–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å—Ç—É–¥–µ–Ω—Ç–∞.
        
        Args:
            fio: –§–ò–û —Å—Ç—É–¥–µ–Ω—Ç–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            **fields: –ü–æ–ª—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, gpa=4.5, group="SE-01")
            
        Returns:
            True –µ—Å–ª–∏ —Å—Ç—É–¥–µ–Ω—Ç –±—ã–ª –æ–±–Ω–æ–≤–ª—ë–Ω, False –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω
        """
        rows = self._read_all()
        updated = False
        
        for row in rows:
            if row['fio'] == fio:
                # –û–±–Ω–æ–≤–ª—è–µ–º —É–∫–∞–∑–∞–Ω–Ω—ã–µ –ø–æ–ª—è
                for field, value in fields.items():
                    if field in row:
                        row[field] = value
                    else:
                        print(f"‚ö†Ô∏è –ü–æ–ª–µ '{field}' –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –∑–∞–ø–∏—Å–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞")
                updated = True
                break
        
        if updated:
            self._write_all(rows)
            print(f"–î–∞–Ω–Ω—ã–µ —Å—Ç—É–¥–µ–Ω—Ç–∞ {fio} –æ–±–Ω–æ–≤–ª–µ–Ω—ã")
        else:
            print(f"‚ö†Ô∏è –°—Ç—É–¥–µ–Ω—Ç {fio} –Ω–µ –Ω–∞–π–¥–µ–Ω")
        
        return updated
    
    def stats(self) -> dict:
        """
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –≥—Ä—É–ø–ø–µ.
        
        Returns:
            –°–ª–æ–≤–∞—Ä—å —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
        """
        students = self.list()
        
        if not students:
            return {
                "count": 0,
                "min_gpa": 0,
                "max_gpa": 0,
                "avg_gpa": 0,
                "groups": {},
                "top_5_students": []
            }
        
        # –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        gpa_values = [s.gpa for s in students]
        count = len(students)
        min_gpa = min(gpa_values)
        max_gpa = max(gpa_values)
        avg_gpa = sum(gpa_values) / count
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≥—Ä—É–ø–ø–∞–º
        groups = {}
        for student in students:
            group = student.group
            if group not in groups:
                groups[group] = 0
            groups[group] += 1
        
        # –¢–æ–ø-5 —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø–æ GPA
        top_students = sorted(students, key=lambda s: s.gpa, reverse=True)[:5]
        top_5 = [{"fio": s.fio, "gpa": s.gpa} for s in top_students]
        
        return {
            "count": count,
            "min_gpa": min_gpa,
            "max_gpa": max_gpa,
            "avg_gpa": avg_gpa,
            "groups": groups,
            "top_5_students": top_5
        }
    
    def print_table(self) -> None:
        """
        –í—ã–≤–æ–¥–∏—Ç —Ç–∞–±–ª–∏—Ü—É —Å–æ —Å–ø–∏—Å–∫–æ–º —Å—Ç—É–¥–µ–Ω—Ç–æ–≤.
        """
        students = self.list()
        
        if not students:
            print("üì≠ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–∞")
            return
        
        print("\n" + "="*80)
        print(f"{'‚Ññ':<3} {'–§–ò–û':<30} {'–ì—Ä—É–ø–ø–∞':<12} {'GPA':<6} {'–í–æ–∑—Ä–∞—Å—Ç':<8}")
        print("="*80)
        
        for i, student in enumerate(students, 1):
            print(f"{i:<3} {student.fio:<30} {student.group:<12} {student.gpa:<6.2f} {student.age():<8}")
        
        print("="*80)
        print(f"–í—Å–µ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤: {len(students)}")

```
## test_lab09.py
``` python
import sys
import os
sys.path.insert(0, os.path.abspath('.'))

from src.lab08.models import Student
from src.lab09.group import Group

def main():
    print("=== –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã –∫–ª–∞—Å—Å–∞ Group (CRUD –Ω–∞ CSV) ===")
    
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–æ–≤—ã–π —Ñ–∞–π–ª –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
    db_path = "data/lab09/demo_students.csv"
    
    # –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π —Ñ–∞–π–ª –µ—Å–ª–∏ –µ—Å—Ç—å (—á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞)
    if os.path.exists(db_path):
        os.remove(db_path)
    
    # –°–æ–∑–¥–∞—ë–º –æ–±—ä–µ–∫—Ç Group
    group = Group(db_path)
    
    print("1. –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –ø—É—Å—Ç—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö")
    print(f"   –§–∞–π–ª: {db_path}")
    print(f"   –°—Ç—É–¥–µ–Ω—Ç–æ–≤ –≤ –±–∞–∑–µ: {len(group.list())}")
    
    print("\n2. –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—É–¥–µ–Ω—Ç–æ–≤:")
    students = [
        Student("–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á", "2000-05-15", "SE-01", 4.5),
        Student("–ü–µ—Ç—Ä–æ–≤–∞ –ê–Ω–Ω–∞ –°–µ—Ä–≥–µ–µ–≤–Ω–∞", "2001-02-20", "SE-02", 4.8),
        Student("–°–∏–¥–æ—Ä–æ–≤ –ê–ª–µ–∫—Å–µ–π –ü–µ—Ç—Ä–æ–≤–∏—á", "1999-11-30", "SE-01", 3.9),
        Student("–ö–æ–∑–ª–æ–≤–∞ –ú–∞—Ä–∏—è –î–º–∏—Ç—Ä–∏–µ–≤–Ω–∞", "2002-07-10", "SE-03", 4.2),
        Student("–ù–∏–∫–æ–ª–∞–µ–≤ –î–µ–Ω–∏—Å –û–ª–µ–≥–æ–≤–∏—á", "2000-12-05", "SE-02", 3.5)
    ]
    
    for student in students:
        group.add(student)
        print(f"  –î–æ–±–∞–≤–ª–µ–Ω: {student.fio}")
    
    print("\n3. –í—ã–≤–æ–¥–∏–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤:")
    group.print_table()
    
    print("\n4. –ü–æ–∏—Å–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤:")
    search_queries = ["–ò–≤–∞–Ω", "–ü–µ—Ç—Ä", "–æ–≤"]
    for query in search_queries:
        found = group.find(query)
        print(f"   –ü–æ –∑–∞–ø—Ä–æ—Å—É '{query}': –Ω–∞–π–¥–µ–Ω–æ {len(found)} —Å—Ç—É–¥–µ–Ω—Ç–æ–≤")
    
    print("\n5. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:")
    print("   - –ú–µ–Ω—è–µ–º GPA —É –ò–≤–∞–Ω–æ–≤–∞ —Å 4.5 –Ω–∞ 4.7")
    print("   - –ú–µ–Ω—è–µ–º –≥—Ä—É–ø–ø—É —É –ü–µ—Ç—Ä–æ–≤–æ–π —Å SE-02 –Ω–∞ SE-03")
    group.update("–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á", gpa=4.7)
    group.update("–ü–µ—Ç—Ä–æ–≤–∞ –ê–Ω–Ω–∞ –°–µ—Ä–≥–µ–µ–≤–Ω–∞", group="SE-03")
    
    print("\n6. –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç—É–¥–µ–Ω—Ç–∞:")
    print("   - –£–¥–∞–ª—è–µ–º –°–∏–¥–æ—Ä–æ–≤–∞ –ê–ª–µ–∫—Å–µ—è –ü–µ—Ç—Ä–æ–≤–∏—á–∞")
    group.remove("–°–∏–¥–æ—Ä–æ–≤ –ê–ª–µ–∫—Å–µ–π –ü–µ—Ç—Ä–æ–≤–∏—á")
    
    print("\n7. –§–∏–Ω–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤:")
    group.print_table()
    
    print("\n8. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–¥–æ–ø. –∑–∞–¥–∞–Ω–∏–µ —Å–æ –∑–≤—ë–∑–¥–æ—á–∫–æ–π):")
    stats = group.stats()
    print(f"   –í—Å–µ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤: {stats['count']}")
    print(f"   –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π GPA: {stats['min_gpa']:.2f}")
    print(f"   –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π GPA: {stats['max_gpa']:.2f}")
    print(f"   –°—Ä–µ–¥–Ω–∏–π GPA: {stats['avg_gpa']:.2f}")
    print(f"   –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –≥—Ä—É–ø–ø–∞–º:")
    for group_name, count in stats['groups'].items():
        print(f"     - {group_name}: {count} —Å—Ç—É–¥–µ–Ω—Ç–æ–≤")
    print(f"   –¢–æ–ø-3 —Å—Ç—É–¥–µ–Ω—Ç–æ–≤:")
    for i, student in enumerate(stats['top_5_students'][:3], 1):
        print(f"     {i}. {student['fio']} (GPA: {student['gpa']:.2f})")
    
    print("\n9. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ CSV —Ñ–∞–π–ª–∞:")
    with open(db_path, 'r', encoding='utf-8') as f:
        print(f.read())
    
    print("\n –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!")

if __name__ == "__main__":
    main()

```

## –¢–µ—Å—Ç—ã –∏ –≤—ã–≤–æ–¥—ã:

**–í—ã–≤–æ–¥—ã —Ç–µ—Å—Ç–æ–≤:**

![alt text](<images/lab09/test_part1.png>)
![alt text](<images/lab09/test_part2.png>)


**–í—ã–≤–æ–¥—ã —Ç–∞–±–ª–∏—Ü csv:**

![alt text](<images/lab09/students_csv2.png>)

![alt text](<images/lab09/test students.png>)

# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 10 - –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### 1. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Ç—Ä–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö:
- ‚úÖ **Stack (—Å—Ç–µ–∫)** - –Ω–∞ –æ—Å–Ω–æ–≤–µ list, LIFO (Last In, First Out)
- ‚úÖ **Queue (–æ—á–µ—Ä–µ–¥—å)** - –Ω–∞ –æ—Å–Ω–æ–≤–µ collections.deque, FIFO (First In, First Out)
- ‚úÖ **SinglyLinkedList (–æ–¥–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ø–∏—Å–æ–∫)** - —Å —É–∑–ª–∞–º–∏ Node

### 2. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–±–µ–Ω—á–º–∞—Ä–∫–∏):

#### –î–ª—è 10,000 –æ–ø–µ—Ä–∞—Ü–∏–π:
| –°—Ç—Ä—É–∫—Ç—É—Ä–∞ | –û–ø–µ—Ä–∞—Ü–∏—è | –í—Ä–µ–º—è (—Å–µ–∫) | –°–ª–æ–∂–Ω–æ—Å—Ç—å |
|-----------|----------|-------------|-----------|
| **Stack** | push/pop | ~0.001 | O(1) |
| **Queue** | enqueue/dequeue | ~0.001 | O(1) |
| **LinkedList** | append/prepend | ~0.003 | O(1) |

#### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è 10,000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤:
- **Python list (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π):** 0.001148 —Å–µ–∫
- **–ù–∞—à Stack:** 0.000769 —Å–µ–∫ **‚úÖ**
- **–ù–∞—à Queue:** 0.001291 —Å–µ–∫
- **–ù–∞—à LinkedList:** 0.005227 —Å–µ–∫

### 3. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ —Å–∫–æ–±–æ–∫ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å—Ç–µ–∫–∞:
```python
def is_balanced(expression: str) -> bool:
    stack = Stack()
    brackets = {'(': ')', '[': ']', '{': '}'}
    
    for char in expression:
        if char in brackets.keys():
            stack.push(char)
        elif char in brackets.values():
            if stack.is_empty():
                return False
            opening = stack.pop()
            if brackets[opening] != char:
                return False
    
    return stack.is_empty()
```

#### structures.py
``` python
"""
–ú–æ–¥—É–ª—å —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –±–∞–∑–æ–≤—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö: Stack (—Å—Ç–µ–∫) –∏ Queue (–æ—á–µ—Ä–µ–¥—å).
"""

from collections import deque
from typing import Any, Optional


class Stack:
    """
    –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–µ–∫–∞ (LIFO - Last In, First Out) –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–ø–∏—Å–∫–∞ Python.
    
    –°—Ç–µ–∫ - —ç—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –≤ –∫–æ—Ç–æ—Ä–æ–π —ç–ª–µ–º–µ–Ω—Ç—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∏ —É–¥–∞–ª—è—é—Ç—Å—è 
    —Å –æ–¥–Ω–æ–≥–æ –∫–æ–Ω—Ü–∞ (–≤–µ—Ä—à–∏–Ω—ã —Å—Ç–µ–∫–∞). –ê–Ω–∞–ª–æ–≥–∏—è: —Å—Ç–æ–ø–∫–∞ —Ç–∞—Ä–µ–ª–æ–∫.
    
    –û–ø–µ—Ä–∞—Ü–∏–∏:
    - push(item): –î–æ–±–∞–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –Ω–∞ –≤–µ—Ä—à–∏–Ω—É —Å—Ç–µ–∫–∞ - O(1)
    - pop(): –£–¥–∞–ª–∏—Ç—å –∏ –≤–µ—Ä–Ω—É—Ç—å —ç–ª–µ–º–µ–Ω—Ç —Å –≤–µ—Ä—à–∏–Ω—ã - O(1)
    - peek(): –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —ç–ª–µ–º–µ–Ω—Ç –Ω–∞ –≤–µ—Ä—à–∏–Ω–µ –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è - O(1)
    - is_empty(): –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø—É—Å—Ç –ª–∏ —Å—Ç–µ–∫ - O(1)
    """
    
    def __init__(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—É—Å—Ç–æ–≥–æ —Å—Ç–µ–∫–∞."""
        self._data: list[Any] = []
    
    def push(self, item: Any) -> None:
        """
        –î–æ–±–∞–≤–ª—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –Ω–∞ –≤–µ—Ä—à–∏–Ω—É —Å—Ç–µ–∫–∞.
        
        Args:
            item: –≠–ª–µ–º–µ–Ω—Ç –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
        """
        self._data.append(item)
    
    def pop(self) -> Any:
        """
        –£–¥–∞–ª—è–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç —Å –≤–µ—Ä—à–∏–Ω—ã —Å—Ç–µ–∫–∞.
        
        Returns:
            –≠–ª–µ–º–µ–Ω—Ç —Å –≤–µ—Ä—à–∏–Ω—ã —Å—Ç–µ–∫–∞
            
        Raises:
            IndexError: –ï—Å–ª–∏ —Å—Ç–µ–∫ –ø—É—Å—Ç
        """
        if self.is_empty():
            raise IndexError("–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –∏–∑ –ø—É—Å—Ç–æ–≥–æ —Å—Ç–µ–∫–∞")
        return self._data.pop()
    
    def peek(self) -> Optional[Any]:
        """
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –Ω–∞ –≤–µ—Ä—à–∏–Ω–µ —Å—Ç–µ–∫–∞ –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è.
        
        Returns:
            –≠–ª–µ–º–µ–Ω—Ç –Ω–∞ –≤–µ—Ä—à–∏–Ω–µ —Å—Ç–µ–∫–∞ –∏–ª–∏ None, –µ—Å–ª–∏ —Å—Ç–µ–∫ –ø—É—Å—Ç
        """
        if self.is_empty():
            return None
        return self._data[-1]
    
    def is_empty(self) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –ø—É—Å—Ç –ª–∏ —Å—Ç–µ–∫.
        
        Returns:
            True –µ—Å–ª–∏ —Å—Ç–µ–∫ –ø—É—Å—Ç, –∏–Ω–∞—á–µ False
        """
        return len(self._data) == 0
    
    def __len__(self) -> int:
        """
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ —Å—Ç–µ–∫–µ.
        
        Returns:
            –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        """
        return len(self._data)
    
    def __str__(self) -> str:
        """
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–µ–∫–∞.
        
        Returns:
            –°—Ç—Ä–æ–∫–∞ –≤–∏–¥–∞ "Stack([—ç–ª–µ–º–µ–Ω—Ç—ã])"
        """
        return f"Stack({self._data})"
    
    def __repr__(self) -> str:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–µ–∫–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏."""
        return f"Stack({self._data})"
    
    def clear(self) -> None:
        """–û—á–∏—â–∞–µ—Ç —Å—Ç–µ–∫ (—É–¥–∞–ª—è–µ—Ç –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã)."""
        self._data.clear()


class Queue:
    """
    –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—á–µ—Ä–µ–¥–∏ (FIFO - First In, First Out) –Ω–∞ –æ—Å–Ω–æ–≤–µ deque.
    
    –û—á–µ—Ä–µ–¥—å - —ç—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –≤ –∫–æ—Ç–æ—Ä–æ–π —ç–ª–µ–º–µ–Ω—Ç—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –∫–æ–Ω–µ—Ü,
    –∞ —É–¥–∞–ª—è—é—Ç—Å—è –∏–∑ –Ω–∞—á–∞–ª–∞. –ê–Ω–∞–ª–æ–≥–∏—è: –æ—á–µ—Ä–µ–¥—å –≤ –º–∞–≥–∞–∑–∏–Ω–µ.
    
    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è collections.deque –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (O(1) –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π
    –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è —Å –æ–±–æ–∏—Ö –∫–æ–Ω—Ü–æ–≤).
    
    –û–ø–µ—Ä–∞—Ü–∏–∏:
    - enqueue(item): –î–æ–±–∞–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –≤ –∫–æ–Ω–µ—Ü –æ—á–µ—Ä–µ–¥–∏ - O(1)
    - dequeue(): –£–¥–∞–ª–∏—Ç—å –∏ –≤–µ—Ä–Ω—É—Ç—å —ç–ª–µ–º–µ–Ω—Ç –∏–∑ –Ω–∞—á–∞–ª–∞ - O(1)
    - peek(): –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è - O(1)
    - is_empty(): –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø—É—Å—Ç–∞ –ª–∏ –æ—á–µ—Ä–µ–¥—å - O(1)
    """
    
    def __init__(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—É—Å—Ç–æ–π –æ—á–µ—Ä–µ–¥–∏."""
        self._data: deque[Any] = deque()
    
    def enqueue(self, item: Any) -> None:
        """
        –î–æ–±–∞–≤–ª—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –≤ –∫–æ–Ω–µ—Ü –æ—á–µ—Ä–µ–¥–∏.
        
        Args:
            item: –≠–ª–µ–º–µ–Ω—Ç –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
        """
        self._data.append(item)
    
    def dequeue(self) -> Any:
        """
        –£–¥–∞–ª—è–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –∏–∑ –Ω–∞—á–∞–ª–∞ –æ—á–µ—Ä–µ–¥–∏.
        
        Returns:
            –≠–ª–µ–º–µ–Ω—Ç –∏–∑ –Ω–∞—á–∞–ª–∞ –æ—á–µ—Ä–µ–¥–∏
            
        Raises:
            IndexError: –ï—Å–ª–∏ –æ—á–µ—Ä–µ–¥—å –ø—É—Å—Ç–∞
        """
        if self.is_empty():
            raise IndexError("–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –∏–∑ –ø—É—Å—Ç–æ–π –æ—á–µ—Ä–µ–¥–∏")
        return self._data.popleft()
    
    def peek(self) -> Optional[Any]:
        """
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –æ—á–µ—Ä–µ–¥–∏ –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è.
        
        Returns:
            –ü–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –æ—á–µ—Ä–µ–¥–∏ –∏–ª–∏ None, –µ—Å–ª–∏ –æ—á–µ—Ä–µ–¥—å –ø—É—Å—Ç–∞
        """
        if self.is_empty():
            return None
        return self._data[0]
    
    def is_empty(self) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –ø—É—Å—Ç–∞ –ª–∏ –æ—á–µ—Ä–µ–¥—å.
        
        Returns:
            True –µ—Å–ª–∏ –æ—á–µ—Ä–µ–¥—å –ø—É—Å—Ç–∞, –∏–Ω–∞—á–µ False
        """
        return len(self._data) == 0
    
    def __len__(self) -> int:
        """
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –æ—á–µ—Ä–µ–¥–∏.
        
        Returns:
            –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        """
        return len(self._data)
    
    def __str__(self) -> str:
        """
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥–∏.
        
        Returns:
            –°—Ç—Ä–æ–∫–∞ –≤–∏–¥–∞ "Queue([—ç–ª–µ–º–µ–Ω—Ç—ã])"
        """
        return f"Queue({list(self._data)})"
    
    def __repr__(self) -> str:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏."""
        return f"Queue({list(self._data)})"
    
    def clear(self) -> None:
        """–û—á–∏—â–∞–µ—Ç –æ—á–µ—Ä–µ–¥—å (—É–¥–∞–ª—è–µ—Ç –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã)."""
        self._data.clear()


def stack_example() -> None:
    """–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å—Ç–µ–∫–∞."""
    print("=== –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã —Å—Ç–µ–∫–∞ (LIFO) ===")
    stack = Stack()
    
    # –î–æ–±–∞–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã
    stack.push("–ø–µ—Ä–≤—ã–π")
    stack.push("–≤—Ç–æ—Ä–æ–π")
    stack.push("—Ç—Ä–µ—Ç–∏–π")
    
    print(f"–°—Ç–µ–∫ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–π: {stack}")
    print(f"–í–µ—Ä—à–∏–Ω–∞ —Å—Ç–µ–∫–∞ (peek): {stack.peek()}")
    print(f"–†–∞–∑–º–µ—Ä —Å—Ç–µ–∫–∞: {len(stack)}")
    
    # –£–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã (–≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ)
    print("\n–£–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ —Å—Ç–µ–∫–∞:")
    while not stack.is_empty():
        print(f"  –ò–∑–≤–ª–µ—á–µ–Ω–æ: {stack.pop()}")
    
    print(f"–°—Ç–µ–∫ –ø—É—Å—Ç: {stack.is_empty()}")


def queue_example() -> None:
    """–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ—á–µ—Ä–µ–¥–∏."""
    print("\n=== –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã –æ—á–µ—Ä–µ–¥–∏ (FIFO) ===")
    queue = Queue()
    
    # –î–æ–±–∞–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã
    queue.enqueue("–ø–µ—Ä–≤—ã–π")
    queue.enqueue("–≤—Ç–æ—Ä–æ–π")
    queue.enqueue("—Ç—Ä–µ—Ç–∏–π")
    
    print(f"–û—á–µ—Ä–µ–¥—å –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–π: {queue}")
    print(f"–ü–µ—Ä–≤—ã–π –≤ –æ—á–µ—Ä–µ–¥–∏ (peek): {queue.peek()}")
    print(f"–†–∞–∑–º–µ—Ä –æ—á–µ—Ä–µ–¥–∏: {len(queue)}")
    
    # –£–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã (–≤ –ø–æ—Ä—è–¥–∫–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è)
    print("\n–£–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ –æ—á–µ—Ä–µ–¥–∏:")
    while not queue.is_empty():
        print(f"  –ò–∑–≤–ª–µ—á–µ–Ω–æ: {queue.dequeue()}")
    
    print(f"–û—á–µ—Ä–µ–¥—å –ø—É—Å—Ç–∞: {queue.is_empty()}")


def reverse_string_with_stack(text: str) -> str:
    """
    –ü—Ä–∏–º–µ—Ä –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å—Ç–µ–∫–∞: –ø–µ—Ä–µ–≤–æ—Ä–æ—Ç —Å—Ç—Ä–æ–∫–∏.
    
    Args:
        text: –ò—Å—Ö–æ–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞
        
    Returns:
        –ü–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç–∞—è —Å—Ç—Ä–æ–∫–∞
    """
    stack = Stack()
    
    # –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ —Å–∏–º–≤–æ–ª—ã –≤ —Å—Ç–µ–∫
    for char in text:
        stack.push(char)
    
    # –ò–∑–≤–ª–µ–∫–∞–µ–º —Å–∏–º–≤–æ–ª—ã (–≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ)
    reversed_text = []
    while not stack.is_empty():
        reversed_text.append(stack.pop())
    
    return ''.join(reversed_text)


if __name__ == "__main__":
    # –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã
    stack_example()
    queue_example()
    
    # –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä
    print("\n=== –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: –ø–µ—Ä–µ–≤–æ—Ä–æ—Ç —Å—Ç—Ä–æ–∫–∏ —Å –ø–æ–º–æ—â—å—é —Å—Ç–µ–∫–∞ ===")
    text = "Hello, World!"
    reversed_text = reverse_string_with_stack(text)
    print(f"–ò—Å—Ö–æ–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞: {text}")
    print(f"–ü–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç–∞—è —Å—Ç—Ä–æ–∫–∞: {reversed_text}")

```

#### linked_list.py

``` python
"""
–ú–æ–¥—É–ª—å —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –æ–¥–Ω–æ—Å–≤—è–∑–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ (Singly Linked List).
"""

from typing import Any, Optional, Iterator


class Node:
    """
    –£–∑–µ–ª –æ–¥–Ω–æ—Å–≤—è–∑–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞.
    
    –°–æ–¥–µ—Ä–∂–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∏ —Å—Å—ã–ª–∫—É –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —É–∑–µ–ª.
    """
    
    def __init__(self, value: Any):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —É–∑–ª–∞.
        
        Args:
            value: –ó–Ω–∞—á–µ–Ω–∏–µ, —Ö—Ä–∞–Ω–∏–º–æ–µ –≤ —É–∑–ª–µ
        """
        self.value: Any = value
        self.next: Optional['Node'] = None
    
    def __str__(self) -> str:
        """–°—Ç—Ä–æ–∫–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —É–∑–ª–∞."""
        return f"[{self.value}]"
    
    def __repr__(self) -> str:
        """–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —É–∑–ª–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏."""
        return f"Node({self.value})"


class SinglyLinkedList:
    """
    –û–¥–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ø–∏—Å–æ–∫.
    
    –°–æ—Å—Ç–æ–∏—Ç –∏–∑ —É–∑–ª–æ–≤ Node, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∏ —Å—Å—ã–ª–∫—É 
    –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —É–∑–µ–ª. –ü–æ—Å–ª–µ–¥–Ω–∏–π —É–∑–µ–ª –∏–º–µ–µ—Ç next = None.
    
    –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:
    - append(value): –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–Ω–µ—Ü - O(1) —Å tail, O(n) –±–µ–∑ tail
    - prepend(value): –î–æ–±–∞–≤–∏—Ç—å –≤ –Ω–∞—á–∞–ª–æ - O(1)
    - insert(index, value): –í—Å—Ç–∞–≤–∏—Ç—å –ø–æ –∏–Ω–¥–µ–∫—Å—É - O(n) –≤ —Ö—É–¥—à–µ–º —Å–ª—É—á–∞–µ
    - remove(value): –£–¥–∞–ª–∏—Ç—å –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é - O(n)
    - remove_at(index): –£–¥–∞–ª–∏—Ç—å –ø–æ –∏–Ω–¥–µ–∫—Å—É - O(n)
    """
    
    def __init__(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—É—Å—Ç–æ–≥–æ —Å–ø–∏—Å–∫–∞."""
        self.head: Optional[Node] = None
        self.tail: Optional[Node] = None
        self._size: int = 0
    
    def append(self, value: Any) -> None:
        """
        –î–æ–±–∞–≤–ª—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –≤ –∫–æ–Ω–µ—Ü —Å–ø–∏—Å–∫–∞.
        
        –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(1) –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ tail, O(n) –±–µ–∑ tail.
        
        Args:
            value: –ó–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
        """
        new_node = Node(value)
        
        if self.is_empty():
            # –ï—Å–ª–∏ —Å–ø–∏—Å–æ–∫ –ø—É—Å—Ç, –Ω–æ–≤—ã–π —É–∑–µ–ª —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∏ head, –∏ tail
            self.head = new_node
            self.tail = new_node
        else:
            # –î–æ–±–∞–≤–ª—è–µ–º –≤ –∫–æ–Ω–µ—Ü –∏ –æ–±–Ω–æ–≤–ª—è–µ–º tail
            self.tail.next = new_node
            self.tail = new_node
        
        self._size += 1
    
    def prepend(self, value: Any) -> None:
        """
        –î–æ–±–∞–≤–ª—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –≤ –Ω–∞—á–∞–ª–æ —Å–ø–∏—Å–∫–∞.
        
        –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(1).
        
        Args:
            value: –ó–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
        """
        new_node = Node(value)
        
        if self.is_empty():
            # –ï—Å–ª–∏ —Å–ø–∏—Å–æ–∫ –ø—É—Å—Ç, –Ω–æ–≤—ã–π —É–∑–µ–ª —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∏ head, –∏ tail
            self.head = new_node
            self.tail = new_node
        else:
            # –î–æ–±–∞–≤–ª—è–µ–º –≤ –Ω–∞—á–∞–ª–æ
            new_node.next = self.head
            self.head = new_node
        
        self._size += 1
    
    def insert(self, index: int, value: Any) -> None:
        """
        –í—Å—Ç–∞–≤–ª—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –∏–Ω–¥–µ–∫—Å—É.
        
        –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(n) –≤ —Ö—É–¥—à–µ–º —Å–ª—É—á–∞–µ.
        
        Args:
            index: –ü–æ–∑–∏—Ü–∏—è –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ (0-based)
            value: –ó–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏
            
        Raises:
            IndexError: –ï—Å–ª–∏ –∏–Ω–¥–µ–∫—Å –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã —Å–ø–∏—Å–∫–∞
        """
        if index < 0 or index > self._size:
            raise IndexError(f"–ò–Ω–¥–µ–∫—Å {index} –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã —Å–ø–∏—Å–∫–∞ (—Ä–∞–∑–º–µ—Ä: {self._size})")
        
        if index == 0:
            # –í—Å—Ç–∞–≤–∫–∞ –≤ –Ω–∞—á–∞–ª–æ
            self.prepend(value)
        elif index == self._size:
            # –í—Å—Ç–∞–≤–∫–∞ –≤ –∫–æ–Ω–µ—Ü
            self.append(value)
        else:
            # –í—Å—Ç–∞–≤–∫–∞ –≤ —Å–µ—Ä–µ–¥–∏–Ω—É
            new_node = Node(value)
            current = self.head
            current_index = 0
            
            # –ò—â–µ–º —É–∑–µ–ª –ø–µ—Ä–µ–¥ –ø–æ–∑–∏—Ü–∏–µ–π –≤—Å—Ç–∞–≤–∫–∏
            while current_index < index - 1:
                current = current.next
                current_index += 1
            
            # –í—Å—Ç–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π —É–∑–µ–ª
            new_node.next = current.next
            current.next = new_node
            
            self._size += 1
    
    def remove(self, value: Any) -> bool:
        """
        –£–¥–∞–ª—è–µ—Ç –ø–µ—Ä–≤–æ–µ –≤—Ö–æ–∂–¥–µ–Ω–∏–µ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.
        
        –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(n).
        
        Args:
            value: –ó–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
            
        Returns:
            True –µ—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç –±—ã–ª —É–¥–∞–ª—ë–Ω, False –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω
        """
        if self.is_empty():
            return False
        
        # –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–ª—É—á–∞–π: —É–¥–∞–ª–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
        if self.head.value == value:
            self.head = self.head.next
            self._size -= 1
            
            # –ï—Å–ª–∏ —Å–ø–∏—Å–æ–∫ —Å—Ç–∞–ª –ø—É—Å—Ç—ã–º, –æ–±–Ω–æ–≤–ª—è–µ–º tail
            if self.head is None:
                self.tail = None
            
            return True
        
        # –ò—â–µ–º —É–∑–µ–ª, –ø—Ä–µ–¥—à–µ—Å—Ç–≤—É—é—â–∏–π —É–¥–∞–ª—è–µ–º–æ–º—É
        current = self.head
        while current.next is not None and current.next.value != value:
            current = current.next
        
        # –ï—Å–ª–∏ –Ω–∞—à–ª–∏ —É–∑–µ–ª –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
        if current.next is not None:
            current.next = current.next.next
            self._size -= 1
            
            # –ï—Å–ª–∏ —É–¥–∞–ª–∏–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç, –æ–±–Ω–æ–≤–ª—è–µ–º tail
            if current.next is None:
                self.tail = current
            
            return True
        
        return False
    
    def remove_at(self, index: int) -> Any:
        """
        –£–¥–∞–ª—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –∏–Ω–¥–µ–∫—Å—É –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–µ.
        
        –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(n) –≤ —Ö—É–¥—à–µ–º —Å–ª—É—á–∞–µ.
        
        Args:
            index: –ò–Ω–¥–µ–∫—Å —ç–ª–µ–º–µ–Ω—Ç–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
            
        Returns:
            –ó–Ω–∞—á–µ–Ω–∏–µ —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
            
        Raises:
            IndexError: –ï—Å–ª–∏ –∏–Ω–¥–µ–∫—Å –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã —Å–ø–∏—Å–∫–∞
        """
        if index < 0 or index >= self._size:
            raise IndexError(f"–ò–Ω–¥–µ–∫—Å {index} –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã —Å–ø–∏—Å–∫–∞ (—Ä–∞–∑–º–µ—Ä: {self._size})")
        
        # –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–ª—É—á–∞–π: —É–¥–∞–ª–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
        if index == 0:
            value = self.head.value
            self.head = self.head.next
            self._size -= 1
            
            # –ï—Å–ª–∏ —Å–ø–∏—Å–æ–∫ —Å—Ç–∞–ª –ø—É—Å—Ç—ã–º, –æ–±–Ω–æ–≤–ª—è–µ–º tail
            if self.head is None:
                self.tail = None
            
            return value
        
        # –ò—â–µ–º —É–∑–µ–ª, –ø—Ä–µ–¥—à–µ—Å—Ç–≤—É—é—â–∏–π —É–¥–∞–ª—è–µ–º–æ–º—É
        current = self.head
        current_index = 0
        
        while current_index < index - 1:
            current = current.next
            current_index += 1
        
        # –£–¥–∞–ª—è–µ–º —É–∑–µ–ª
        value = current.next.value
        current.next = current.next.next
        self._size -= 1
        
        # –ï—Å–ª–∏ —É–¥–∞–ª–∏–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç, –æ–±–Ω–æ–≤–ª—è–µ–º tail
        if current.next is None:
            self.tail = current
        
        return value
    
    def get(self, index: int) -> Any:
        """
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –∏–Ω–¥–µ–∫—Å—É.
        
        –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(n).
        
        Args:
            index: –ò–Ω–¥–µ–∫—Å —ç–ª–µ–º–µ–Ω—Ç–∞
            
        Returns:
            –ó–Ω–∞—á–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞
            
        Raises:
            IndexError: –ï—Å–ª–∏ –∏–Ω–¥–µ–∫—Å –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã —Å–ø–∏—Å–∫–∞
        """
        if index < 0 or index >= self._size:
            raise IndexError(f"–ò–Ω–¥–µ–∫—Å {index} –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã —Å–ø–∏—Å–∫–∞ (—Ä–∞–∑–º–µ—Ä: {self._size})")
        
        current = self.head
        current_index = 0
        
        while current_index < index:
            current = current.next
            current_index += 1
        
        return current.value
    
    def index(self, value: Any) -> int:
        """
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω–¥–µ–∫—Å –ø–µ—Ä–≤–æ–≥–æ –≤—Ö–æ–∂–¥–µ–Ω–∏—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.
        
        –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(n).
        
        Args:
            value: –ó–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –ø–æ–∏—Å–∫–∞
            
        Returns:
            –ò–Ω–¥–µ–∫—Å —ç–ª–µ–º–µ–Ω—Ç–∞ –∏–ª–∏ -1, –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω
        """
        current = self.head
        index = 0
        
        while current is not None:
            if current.value == value:
                return index
            current = current.next
            index += 1
        
        return -1
    
    def is_empty(self) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –ø—É—Å—Ç –ª–∏ —Å–ø–∏—Å–æ–∫.
        
        Returns:
            True –µ—Å–ª–∏ —Å–ø–∏—Å–æ–∫ –ø—É—Å—Ç, –∏–Ω–∞—á–µ False
        """
        return self.head is None
    
    def __len__(self) -> int:
        """
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ —Å–ø–∏—Å–∫–µ.
        
        Returns:
            –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        """
        return self._size
    
    def __iter__(self) -> Iterator[Any]:
        """
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏—Ç–µ—Ä–∞—Ç–æ—Ä –ø–æ –∑–Ω–∞—á–µ–Ω–∏—è–º —Å–ø–∏—Å–∫–∞.
        
        Returns:
            –ò—Ç–µ—Ä–∞—Ç–æ—Ä
        """
        current = self.head
        while current is not None:
            yield current.value
            current = current.next
    
    def __str__(self) -> str:
        """
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞.
        
        Returns:
            –°—Ç—Ä–æ–∫–∞ –≤–∏–¥–∞ "A -> B -> C -> None"
        """
        if self.is_empty():
            return "SinglyLinkedList(–ø—É—Å—Ç)"
        
        result = []
        current = self.head
        
        while current is not None:
            result.append(str(current.value))
            current = current.next
        
        return " -> ".join(result) + " -> None"
    
    def __repr__(self) -> str:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏."""
        values = list(self)
        return f"SinglyLinkedList({values})"
    
    def clear(self) -> None:
        """–û—á–∏—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ (—É–¥–∞–ª—è–µ—Ç –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã)."""
        self.head = None
        self.tail = None
        self._size = 0


def linked_list_example() -> None:
    """–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–¥–Ω–æ—Å–≤—è–∑–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞."""
    print("=== –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã –æ–¥–Ω–æ—Å–≤—è–∑–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ ===")
    lst = SinglyLinkedList()
    
    # –î–æ–±–∞–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã
    lst.append("–ø–µ—Ä–≤—ã–π")
    lst.append("–≤—Ç–æ—Ä–æ–π")
    lst.prepend("–Ω—É–ª–µ–≤–æ–π")  # –î–æ–±–∞–≤–ª—è–µ–º –≤ –Ω–∞—á–∞–ª–æ
    
    print(f"–°–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–π: {lst}")
    print(f"–†–∞–∑–º–µ—Ä —Å–ø–∏—Å–∫–∞: {len(lst)}")
    print(f"–ü–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç: {lst.get(0)}")
    print(f"–ü–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç: {lst.get(len(lst)-1)}")
    
    # –í—Å—Ç–∞–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç
    lst.insert(2, "–≤—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π")
    print(f"\n–ü–æ—Å–ª–µ –≤—Å—Ç–∞–≤–∫–∏ –ø–æ –∏–Ω–¥–µ–∫—Å—É 2: {lst}")
    
    # –ò—â–µ–º —ç–ª–µ–º–µ–Ω—Ç
    search_value = "–≤—Ç–æ—Ä–æ–π"
    index = lst.index(search_value)
    print(f"–≠–ª–µ–º–µ–Ω—Ç '{search_value}' –Ω–∞–π–¥–µ–Ω –ø–æ –∏–Ω–¥–µ–∫—Å—É: {index}")
    
    # –£–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç
    removed = lst.remove("–≤—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π")
    print(f"\n–£–¥–∞–ª–µ–Ω–∏–µ '–≤—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–≥–æ': {'—É—Å–ø–µ—à–Ω–æ' if removed else '–Ω–µ –Ω–∞–π–¥–µ–Ω'}")
    print(f"–°–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è: {lst}")
    
    # –ò—Ç–µ—Ä–∏—Ä—É–µ–º—Å—è –ø–æ —Å–ø–∏—Å–∫—É
    print("\n–ò—Ç–µ—Ä–∞—Ü–∏—è –ø–æ —Å–ø–∏—Å–∫—É:")
    for i, value in enumerate(lst):
        print(f"  –≠–ª–µ–º–µ–Ω—Ç {i}: {value}")


if __name__ == "__main__":
    linked_list_example()
```

##### –¢–µ—Å—Ç—ã –∏ –í—ã–≤–æ–¥—ã:

![alt text](images/lab10/test1.png)
![alt text](images/lab10/test2.png)
![alt text](images/lab10/test3.png)
![alt text](images/lab10/test4.png)